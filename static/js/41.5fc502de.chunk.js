/*! For license information please see 41.5fc502de.chunk.js.LICENSE.txt */
(this.webpackJsonpeverything=this.webpackJsonpeverything||[]).push([[41],{1e3:function(t,e,n){var r=n(897),i=n(959),o=n(790),a=n(1415),u=n(1416),s=n(1243),c=n(1244),f=n(1419),l=n(1420),h=n(1421),d=n(1366),p=n(724),m=n(1422),v=n(1423),g=n(1246),y=n(585),b=n(791),E=n(1428),_=n(608),w=n(1430),x=n(723),T=n(686),S="[object Arguments]",A="[object Function]",O="[object Object]",R={};R[S]=R["[object Array]"]=R["[object ArrayBuffer]"]=R["[object DataView]"]=R["[object Boolean]"]=R["[object Date]"]=R["[object Float32Array]"]=R["[object Float64Array]"]=R["[object Int8Array]"]=R["[object Int16Array]"]=R["[object Int32Array]"]=R["[object Map]"]=R["[object Number]"]=R[O]=R["[object RegExp]"]=R["[object Set]"]=R["[object String]"]=R["[object Symbol]"]=R["[object Uint8Array]"]=R["[object Uint8ClampedArray]"]=R["[object Uint16Array]"]=R["[object Uint32Array]"]=!0,R["[object Error]"]=R[A]=R["[object WeakMap]"]=!1,t.exports=function t(e,n,C,M,I,N){var k,P=1&n,j=2&n,D=4&n;if(C&&(k=I?C(e,M,I,N):C(e)),void 0!==k)return k;if(!_(e))return e;var L=y(e);if(L){if(k=m(e),!P)return c(e,k)}else{var B=p(e),F=B==A||"[object GeneratorFunction]"==B;if(b(e))return s(e,P);if(B==O||B==S||F&&!I){if(k=j||F?{}:g(e),!P)return j?l(e,u(k,e)):f(e,a(k,e))}else{if(!R[B])return I?e:{};k=v(e,B,P)}}N||(N=new r);var U=N.get(e);if(U)return U;N.set(e,k),w(e)?e.forEach((function(r){k.add(t(r,n,C,r,e,N))})):E(e)&&e.forEach((function(r,i){k.set(i,t(r,n,C,i,e,N))}));var G=L?void 0:(D?j?d:h:j?T:x)(e);return i(G||e,(function(r,i){G&&(r=e[i=r]),o(k,i,t(r,n,C,i,e,N))})),k}},1004:function(t,e,n){var r=n(1589),i=n(1252);t.exports=function(t,e){return null!=t&&i(t,e,r)}},1006:function(t,e,n){"use strict";n.r(e),n.d(e,"create",(function(){return i})),n.d(e,"clone",(function(){return o})),n.d(e,"fromValues",(function(){return a})),n.d(e,"copy",(function(){return u})),n.d(e,"set",(function(){return s})),n.d(e,"add",(function(){return c})),n.d(e,"subtract",(function(){return f})),n.d(e,"multiply",(function(){return l})),n.d(e,"divide",(function(){return h})),n.d(e,"ceil",(function(){return d})),n.d(e,"floor",(function(){return p})),n.d(e,"min",(function(){return m})),n.d(e,"max",(function(){return v})),n.d(e,"round",(function(){return g})),n.d(e,"scale",(function(){return y})),n.d(e,"scaleAndAdd",(function(){return b})),n.d(e,"distance",(function(){return E})),n.d(e,"squaredDistance",(function(){return _})),n.d(e,"length",(function(){return w})),n.d(e,"squaredLength",(function(){return x})),n.d(e,"negate",(function(){return T})),n.d(e,"inverse",(function(){return S})),n.d(e,"normalize",(function(){return A})),n.d(e,"dot",(function(){return O})),n.d(e,"cross",(function(){return R})),n.d(e,"lerp",(function(){return C})),n.d(e,"random",(function(){return M})),n.d(e,"transformMat2",(function(){return I})),n.d(e,"transformMat2d",(function(){return N})),n.d(e,"transformMat3",(function(){return k})),n.d(e,"transformMat4",(function(){return P})),n.d(e,"rotate",(function(){return j})),n.d(e,"angle",(function(){return D})),n.d(e,"zero",(function(){return L})),n.d(e,"str",(function(){return B})),n.d(e,"exactEquals",(function(){return F})),n.d(e,"equals",(function(){return U})),n.d(e,"len",(function(){return G})),n.d(e,"sub",(function(){return V})),n.d(e,"mul",(function(){return z})),n.d(e,"div",(function(){return H})),n.d(e,"dist",(function(){return W})),n.d(e,"sqrDist",(function(){return q})),n.d(e,"sqrLen",(function(){return X})),n.d(e,"forEach",(function(){return Y}));var r=n(644);function i(){var t=new r.a(2);return r.a!=Float32Array&&(t[0]=0,t[1]=0),t}function o(t){var e=new r.a(2);return e[0]=t[0],e[1]=t[1],e}function a(t,e){var n=new r.a(2);return n[0]=t,n[1]=e,n}function u(t,e){return t[0]=e[0],t[1]=e[1],t}function s(t,e,n){return t[0]=e,t[1]=n,t}function c(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function f(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function l(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function h(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function d(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function p(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function m(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function v(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function g(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function y(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function b(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function E(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.hypot(n,r)}function _(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function w(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function x(t){var e=t[0],n=t[1];return e*e+n*n}function T(t,e){return t[0]=-e[0],t[1]=-e[1],t}function S(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function A(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function O(t,e){return t[0]*e[0]+t[1]*e[1]}function R(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function C(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function M(t,e){e=e||1;var n=2*r.c()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function I(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function N(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function k(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function P(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}function j(t,e,n,r){var i=e[0]-n[0],o=e[1]-n[1],a=Math.sin(r),u=Math.cos(r);return t[0]=i*u-o*a+n[0],t[1]=i*a+o*u+n[1],t}function D(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=Math.sqrt(n*n+r*r)*Math.sqrt(i*i+o*o),u=a&&(n*i+r*o)/a;return Math.acos(Math.min(Math.max(u,-1),1))}function L(t){return t[0]=0,t[1]=0,t}function B(t){return"vec2("+t[0]+", "+t[1]+")"}function F(t,e){return t[0]===e[0]&&t[1]===e[1]}function U(t,e){var n=t[0],i=t[1],o=e[0],a=e[1];return Math.abs(n-o)<=r.b*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-a)<=r.b*Math.max(1,Math.abs(i),Math.abs(a))}var G=w,V=f,z=l,H=h,W=E,q=_,X=x,Y=function(){var t=i();return function(e,n,r,i,o,a){var u,s;for(n||(n=2),r||(r=0),s=i?Math.min(i*n+r,e.length):e.length,u=r;u<s;u+=n)t[0]=e[u],t[1]=e[u+1],o(t,t,a),e[u]=t[0],e[u+1]=t[1];return e}}()},1010:function(t,e,n){"use strict";var r=n(3),i=n(13),o=n(2),a=n(1),u=n(14),s=(n(10),n(290)),c=n(134),f=n(8),l=n(15),h=n(255),d=n(109),p=n(53),m=n(29),v=n(69),g=n(78);function y(t){return Object(v.a)("MuiCollapse",t)}Object(g.a)("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);var b=n(0),E=["addEndListener","children","className","collapsedSize","component","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","orientation","style","timeout","TransitionComponent"],_=Object(f.a)("div",{name:"MuiCollapse",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,e[n.orientation],"entered"===n.state&&e.entered,"exited"===n.state&&!n.in&&"0px"===n.collapsedSize&&e.hidden]}})((function(t){var e=t.theme,n=t.ownerState;return Object(o.a)({height:0,overflow:"hidden",transition:e.transitions.create("height")},"horizontal"===n.orientation&&{height:"auto",width:0,transition:e.transitions.create("width")},"entered"===n.state&&Object(o.a)({height:"auto",overflow:"visible"},"horizontal"===n.orientation&&{width:"auto"}),"exited"===n.state&&!n.in&&"0px"===n.collapsedSize&&{visibility:"hidden"})})),w=Object(f.a)("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:function(t,e){return e.wrapper}})((function(t){var e=t.ownerState;return Object(o.a)({display:"flex",width:"100%"},"horizontal"===e.orientation&&{width:"auto",height:"100%"})})),x=Object(f.a)("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:function(t,e){return e.wrapperInner}})((function(t){var e=t.ownerState;return Object(o.a)({width:"100%"},"horizontal"===e.orientation&&{width:"auto",height:"100%"})})),T=a.forwardRef((function(t,e){var n=Object(l.a)({props:t,name:"MuiCollapse"}),f=n.addEndListener,v=n.children,g=n.className,T=n.collapsedSize,S=void 0===T?"0px":T,A=n.component,O=n.easing,R=n.in,C=n.onEnter,M=n.onEntered,I=n.onEntering,N=n.onExit,k=n.onExited,P=n.onExiting,j=n.orientation,D=void 0===j?"vertical":j,L=n.style,B=n.timeout,F=void 0===B?h.b.standard:B,U=n.TransitionComponent,G=void 0===U?s.a:U,V=Object(i.a)(n,E),z=Object(o.a)({},n,{orientation:D,collapsedSize:S}),H=function(t){var e=t.orientation,n=t.classes,r={root:["root","".concat(e)],entered:["entered"],hidden:["hidden"],wrapper:["wrapper","".concat(e)],wrapperInner:["wrapperInner","".concat(e)]};return Object(c.a)(r,y,n)}(z),W=Object(p.a)(),q=a.useRef(),X=a.useRef(null),Y=a.useRef(),K="number"===typeof S?"".concat(S,"px"):S,Q="horizontal"===D,Z=Q?"width":"height";a.useEffect((function(){return function(){clearTimeout(q.current)}}),[]);var J=a.useRef(null),$=Object(m.a)(e,J),tt=function(t){return function(e){if(t){var n=J.current;void 0===e?t(n):t(n,e)}}},et=function(){return X.current?X.current[Q?"clientWidth":"clientHeight"]:0},nt=tt((function(t,e){X.current&&Q&&(X.current.style.position="absolute"),t.style[Z]=K,C&&C(t,e)})),rt=tt((function(t,e){var n=et();X.current&&Q&&(X.current.style.position="");var r=Object(d.a)({style:L,timeout:F,easing:O},{mode:"enter"}),i=r.duration,o=r.easing;if("auto"===F){var a=W.transitions.getAutoHeightDuration(n);t.style.transitionDuration="".concat(a,"ms"),Y.current=a}else t.style.transitionDuration="string"===typeof i?i:"".concat(i,"ms");t.style[Z]="".concat(n,"px"),t.style.transitionTimingFunction=o,I&&I(t,e)})),it=tt((function(t,e){t.style[Z]="auto",M&&M(t,e)})),ot=tt((function(t){t.style[Z]="".concat(et(),"px"),N&&N(t)})),at=tt(k),ut=tt((function(t){var e=et(),n=Object(d.a)({style:L,timeout:F,easing:O},{mode:"exit"}),r=n.duration,i=n.easing;if("auto"===F){var o=W.transitions.getAutoHeightDuration(e);t.style.transitionDuration="".concat(o,"ms"),Y.current=o}else t.style.transitionDuration="string"===typeof r?r:"".concat(r,"ms");t.style[Z]=K,t.style.transitionTimingFunction=i,P&&P(t)}));return Object(b.jsx)(G,Object(o.a)({in:R,onEnter:nt,onEntered:it,onEntering:rt,onExit:ot,onExited:at,onExiting:ut,addEndListener:function(t){"auto"===F&&(q.current=setTimeout(t,Y.current||0)),f&&f(J.current,t)},nodeRef:J,timeout:"auto"===F?null:F},V,{children:function(t,e){return Object(b.jsx)(_,Object(o.a)({as:A,className:Object(u.default)(H.root,g,{entered:H.entered,exited:!R&&"0px"===K&&H.hidden}[t]),style:Object(o.a)(Object(r.a)({},Q?"minWidth":"minHeight",K),L),ownerState:Object(o.a)({},z,{state:t}),ref:$},e,{children:Object(b.jsx)(w,{ownerState:Object(o.a)({},z,{state:t}),className:H.wrapper,ref:X,children:Object(b.jsx)(x,{ownerState:Object(o.a)({},z,{state:t}),className:H.wrapperInner,children:v})})}))}}))}));T.muiSupportAuto=!0;e.a=T},1243:function(t,e,n){(function(t){var r=n(845),i=e&&!e.nodeType&&e,o=i&&"object"==typeof t&&t&&!t.nodeType&&t,a=o&&o.exports===i?r.Buffer:void 0,u=a?a.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,r=u?u(n):new t.constructor(n);return t.copy(r),r}}).call(this,n(1012)(t))},1244:function(t,e){t.exports=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}},1245:function(t,e,n){var r=n(824);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}},1246:function(t,e,n){var r=n(1247),i=n(823),o=n(898);t.exports=function(t){return"function"!=typeof t.constructor||o(t)?{}:r(i(t))}},1247:function(t,e,n){var r=n(608),i=Object.create,o=function(){function t(){}return function(e){if(!r(e))return{};if(i)return i(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();t.exports=o},1295:function(t,e,n){"use strict";var r=n(79);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(80)),o=n(0),a=(0,i.default)((0,o.jsx)("path",{d:"M5 20h14v-2H5v2zM19 9h-4V3H9v6H5l7 7 7-7z"}),"Download");e.default=a},1296:function(t,e,n){var r=n(964),i=n(2563)(r);t.exports=i},1297:function(t,e,n){var r=n(855),i=n(728),o=n(1332),a=n(608);t.exports=function(t,e,n){if(!a(n))return!1;var u=typeof e;return!!("number"==u?i(n)&&o(e,n.length):"string"==u&&e in n)&&r(n[e],t)}},1298:function(t,e,n){"use strict";var r=n(556);t.exports={longestPath:function(t){var e={};r.forEach(t.sources(),(function n(i){var o=t.node(i);if(r.has(e,i))return o.rank;e[i]=!0;var a=r.min(r.map(t.outEdges(i),(function(e){return n(e.w)-t.edge(e).minlen})));return a!==Number.POSITIVE_INFINITY&&void 0!==a&&null!==a||(a=0),o.rank=a}))},longestPathWithLayer:function(t){var e={},n=0;function i(e,n){var o=t.node(e),a=isNaN(o.layer)?n:o.layer;(void 0===o.rank||o.rank<a)&&(o.rank=a),r.map(t.outEdges(e),(function(e){i(e.w,a+t.edge(e).minlen)}))}r.forEach(t.sources(),(function i(o){var a=t.node(o);if(r.has(e,o))return a.rank;e[o]=!0;var u=r.min(r.map(t.outEdges(o),(function(e){return i(e.w)-t.edge(e).minlen})));return u!==Number.POSITIVE_INFINITY&&void 0!==u&&null!==u||(u=0),a.rank=u,n=Math.min(a.rank,n),a.rank})),n+=1,t.nodes().forEach((function(e){var r=t.node(e);isNaN(r.layer)?r.rank-=n:i(e,r.layer)}))},slack:function(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen}}},1299:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(244),i=n.n(r),o=n(245),a=n.n(o),u=n(558),s=function(){function t(e,n){i()(this,t),this.center=void 0,this.halfExtents=void 0,this.min=u.e.create(),this.max=u.e.create(),this.update(e,n)}return a()(t,[{key:"update",value:function(t,e){this.center=t||u.e.create(),this.halfExtents=e||u.e.fromValues(.5,.5,.5),this.min=u.e.sub(this.min,this.center,this.halfExtents),this.max=u.e.add(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(t,e){u.e.add(this.center,e,t),u.e.scale(this.center,this.center,.5),u.e.sub(this.halfExtents,e,t),u.e.scale(this.halfExtents,this.halfExtents,.5),u.e.copy(this.min,t),u.e.copy(this.max,e)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(t){var e=this.center,n=e[0],r=e[1],i=e[2],o=this.halfExtents,a=o[0],u=o[1],s=o[2],c=n-a,f=n+a,l=r-u,h=r+u,d=i-s,p=i+s,m=t.center,v=m[0],g=m[1],y=m[2],b=t.halfExtents,E=b[0],_=b[1],w=b[2],x=v-E,T=v+E,S=g-_,A=g+_,O=y-w,R=y+w;x<c&&(c=x),T>f&&(f=T),S<l&&(l=S),A>h&&(h=A),O<d&&(d=O),R>p&&(p=R),e[0]=.5*(c+f),e[1]=.5*(l+h),e[2]=.5*(d+p),o[0]=.5*(f-c),o[1]=.5*(h-l),o[2]=.5*(p-d),this.min[0]=c,this.min[1]=l,this.min[2]=d,this.max[0]=f,this.max[1]=h,this.max[2]=p}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),r=t.getMax(),i=t.getMin();return n[0]<=r[0]&&e[0]>=i[0]&&n[1]<=r[1]&&e[1]>=i[1]&&n[2]<=r[2]&&e[2]>=i[2]}},{key:"containsPoint",value:function(t){var e=this.getMin(),n=this.getMax();return!(t[0]<e[0]||t[0]>n[0]||t[1]<e[1]||t[1]>n[1]||t[2]<e[2]||t[2]>n[2])}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?u.e.copy(u.e.create(),this.min):272===t.pnVertexFlag?u.e.fromValues(this.min[0],this.min[1],this.max[2]):257===t.pnVertexFlag?u.e.fromValues(this.min[0],this.max[1],this.min[2]):256===t.pnVertexFlag?u.e.fromValues(this.min[0],this.max[1],this.max[2]):17===t.pnVertexFlag?u.e.fromValues(this.max[0],this.min[1],this.min[2]):16===t.pnVertexFlag?u.e.fromValues(this.max[0],this.min[1],this.max[2]):1===t.pnVertexFlag?u.e.fromValues(this.max[0],this.max[1],this.min[2]):u.e.fromValues(this.max[0],this.max[1],this.max[2])}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?u.e.copy(u.e.create(),this.max):272===t.pnVertexFlag?u.e.fromValues(this.max[0],this.max[1],this.min[2]):257===t.pnVertexFlag?u.e.fromValues(this.max[0],this.min[1],this.max[2]):256===t.pnVertexFlag?u.e.fromValues(this.max[0],this.min[1],this.min[2]):17===t.pnVertexFlag?u.e.fromValues(this.min[0],this.max[1],this.max[2]):16===t.pnVertexFlag?u.e.fromValues(this.min[0],this.max[1],this.min[2]):1===t.pnVertexFlag?u.e.fromValues(this.min[0],this.min[1],this.max[2]):u.e.fromValues(this.min[0],this.min[1],this.min[2])}}]),t}()},1300:function(t,e,n){"use strict";n.d(e,"a",(function(){return D}));var r,i,o,a,u,s,c,f,l,h,d,p,m,v=n(587),g=n.n(v),y=n(588),b=n.n(y),E=n(562),_=n.n(E),w=n(244),x=n.n(w),T=n(245),S=n.n(T),A=n(563),O=n.n(A),R=(n(564),n(530)),C=n(653),M=n(1969),I=n(1301);function N(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return k(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var P=1,j=2,D=(r=Object(R.injectable)(),i=Object(R.inject)(C.a.RenderEngine),o=Object(R.inject)(C.a.ResourcePool),a=Object(R.inject)(C.a.RenderPassFactory),u=Object(R.inject)(C.a.MeshComponentManager),r((m=p=function(){function t(){var e=this;x()(this,t),_()(this,"engine",f,this),_()(this,"resourcePool",l,this),_()(this,"renderPassFactory",h,this),_()(this,"mesh",d,this),this.pickingFBO=void 0,this.views=void 0,this.highlightEnabled=!0,this.highlightColor=[255,0,0,255],this.alreadyInRendering=!1,this.setup=function(t,e,n){var r=t.createRenderTarget(e,"picking fbo",{width:1,height:1});n.data={output:e.write(t,r)},e.hasSideEffect=!0},this.execute=function(){var t=b()(g.a.mark((function t(n,r,i){var o,a,u;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.views=i,!e.alreadyInRendering){t.next=3;break}return t.abrupt("return");case 3:o=N(i);try{for(u=function(){var t=a.value,i=t.getViewport(),o=i.width,u=i.height;e.alreadyInRendering=!0;var s=n.getResourceNode(r.data.output);e.pickingFBO=e.resourcePool.getOrCreateResource(s.resource),e.pickingFBO.resize({width:o,height:u}),e.engine.useFramebuffer(e.pickingFBO,(function(){e.engine.clear({framebuffer:e.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var n,r=e.renderPassFactory(I.a.IDENTIFIER),i=[],o=N(t.getScene().getEntities());try{for(o.s();!(n=o.n()).done;){var a=n.value,u=e.mesh.getComponentByEntity(a);u.material.setUniform("u_PickingStage",P),i.push(u)}}catch(s){o.e(s)}finally{o.f()}r.renderView(t),i.forEach((function(t){t.material.setUniform("u_PickingStage",j)})),e.alreadyInRendering=!1}))},o.s();!(a=o.n()).done;)u()}catch(s){o.e(s)}finally{o.f()}case 5:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),this.pick=function(t,n){var r,i,o=t.x,a=t.y,u=e.engine,s=u.readPixels,c=u.useFramebuffer,f=n.getViewport(),l=f.width,h=f.height,d=o*window.devicePixelRatio,p=a*window.devicePixelRatio;if(!(d>l||d<0||p>h||p<0))return c(e.pickingFBO,(function(){0===(r=s({x:Math.round(d),y:Math.round(h-(a+1)*window.devicePixelRatio),width:1,height:1,data:new Uint8Array(4),framebuffer:e.pickingFBO}))[0]&&0===r[1]&&0===r[2]||(i=Object(M.a)(r),e.highlightEnabled&&e.highlightPickedFeature(r,n))})),i}}return S()(t,[{key:"enableHighlight",value:function(t){this.highlightEnabled=t}},{key:"setHighlightColor",value:function(t){this.highlightColor=t}},{key:"highlightPickedFeature",value:function(t,e){if(t){var n,r=N(e.getScene().getEntities());try{for(r.s();!(n=r.n()).done;){var i=n.value,o=this.mesh.getComponentByEntity(i).material;o.setUniform("u_PickingStage",j),o.setUniform("u_PickingColor",[t[0],t[1],t[2]]),o.setUniform("u_HighlightColor",this.highlightColor)}}catch(a){r.e(a)}finally{r.f()}}}}]),t}(),p.IDENTIFIER="PixelPicking Pass",c=m,f=O()(c.prototype,"engine",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=O()(c.prototype,"resourcePool",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=O()(c.prototype,"renderPassFactory",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=O()(c.prototype,"mesh",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=c))||s)},1301:function(t,e,n){"use strict";n.d(e,"a",(function(){return W}));var r,i,o,a,u,s,c,f,l,h,d,p,m,v,g,y,b,E,_,w,x,T,S,A,O=n(587),R=n.n(O),C=n(588),M=n.n(C),I=n(562),N=n.n(I),k=n(244),P=n.n(k),j=n(245),D=n.n(j),L=n(563),B=n.n(L),F=(n(564),n(558)),U=n(530),G=n(653),V=n(878);function z(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return H(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function H(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var W=(r=Object(U.injectable)(),i=Object(U.inject)(G.a.MeshComponentManager),o=Object(U.inject)(G.a.GeometryComponentManager),a=Object(U.inject)(G.a.MaterialComponentManager),u=Object(U.inject)(G.a.CullableComponentManager),s=Object(U.inject)(G.a.TransformComponentManager),c=Object(U.inject)(G.a.HierarchyComponentManager),f=Object(U.inject)(G.a.Systems),l=Object(U.named)(G.a.FrameGraphSystem),h=Object(U.inject)(G.a.RenderEngine),d=Object(U.inject)(G.a.ResourcePool),r((A=S=function(){function t(){var e=this;P()(this,t),N()(this,"mesh",v,this),N()(this,"geometry",g,this),N()(this,"material",y,this),N()(this,"cullable",b,this),N()(this,"transform",E,this),N()(this,"hierarchy",_,this),N()(this,"frameGraphSystem",w,this),N()(this,"engine",x,this),N()(this,"resourcePool",T,this),this.modelCache={},this.setup=function(t,e,n){var r=t.createRenderTarget(e,"color buffer",{width:1,height:1,usage:V.a.RENDER_ATTACHMENT|V.a.SAMPLED|V.a.COPY_SRC});n.data={output:e.write(t,r)}},this.execute=function(){var t=M()(R.a.mark((function t(n,r,i){var o,a,u,s,c,f;return R.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=n.getResourceNode(r.data.output),a=e.resourcePool.getOrCreateResource(o.resource),u=z(i),t.prev=3,u.s();case 5:if((s=u.n()).done){t.next=11;break}return c=s.value,t.next=9,e.initView(c);case 9:t.next=5;break;case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),u.e(t.t0);case 16:return t.prev=16,u.f(),t.finish(16);case 19:f=e.engine.getCanvas(),a.resize({width:f.width,height:f.height}),e.engine.setScissor({enable:!1}),e.engine.clear({framebuffer:a,color:i[0].getClearColor(),depth:1}),e.engine.useFramebuffer(a,(function(){var t,n=z(i);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.renderView(r)}}catch(o){n.e(o)}finally{n.f()}}));case 24:case"end":return t.stop()}}),t,null,[[3,13,16,19]])})));return function(e,n,r){return t.apply(this,arguments)}}()}return D()(t,[{key:"renderView",value:function(t){var e=t.getScene(),n=t.getCamera(),r=n.getViewTransform(),i=F.b.multiply(F.b.create(),n.getPerspective(),r);n.getFrustum().extractFromVPMatrix(i);var o=t.getViewport(),a=o.x,u=o.y,s=o.width,c=o.height;this.engine.viewport({x:a,y:u,width:s,height:c});var f,l=z(e.getEntities());try{for(l.s();!(f=l.n()).done;){var h=f.value;this.renderMesh(h,{camera:n,view:t,viewMatrix:r})}}catch(d){l.e(d)}finally{l.f()}}},{key:"renderMesh",value:function(t,e){var n=e.camera,r=e.view,i=e.viewMatrix,o=this.mesh.getComponentByEntity(t);if(o&&o.visible){var a=o.material,u=o.geometry;if(u&&!u.dirty&&a){var s=this.transform.getComponentByEntity(t),c=F.b.multiply(F.b.create(),i,s.worldTransform),f=r.getViewport(),l=f.width,h=f.height;a.setUniform({projectionMatrix:n.getPerspective(),modelViewMatrix:c,modelMatrix:s.worldTransform,viewMatrix:i,cameraPosition:n.getPosition(),u_viewport:[l,h]}),o.model&&(o.model.draw({uniforms:a.uniforms.reduce((function(t,e){return t[e.name]=e.data,t}),{})}),a.uniforms.forEach((function(t){t.dirty=!1})),a.dirty=!1)}}}},{key:"initMesh",value:function(){var t=M()(R.a.mark((function t(e,n){var r,i,o,a,u,s,c,f;return R.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.mesh.getComponentByEntity(e)){t.next=3;break}return t.abrupt("return");case 3:if(i=r.material,(o=r.geometry)&&!o.dirty&&i){t.next=7;break}return t.abrupt("return");case 7:if(r.model){t.next=24;break}if(a="m-".concat(i.entity,"-g-").concat(o.entity),!this.modelCache[a]){t.next=12;break}return r.model=this.modelCache[a],t.abrupt("return");case 12:return i.setUniform({projectionMatrix:1,modelViewMatrix:1,modelMatrix:1,viewMatrix:1,cameraPosition:1,u_viewport:1}),u=this.engine,s=u.createModel,c=u.createAttribute,f={vs:i.vertexShaderGLSL,fs:i.fragmentShaderGLSL,defines:i.defines,attributes:o.attributes.reduce((function(t,e){return e.data&&e.buffer&&(t[e.name]=c({buffer:e.buffer,attributes:e.attributes,arrayStride:e.arrayStride,stepMode:e.stepMode,divisor:"vertex"===e.stepMode?0:1})),t}),{}),uniforms:i.uniforms.reduce((function(t,e){return t[e.name]=e.data,t}),{}),scissor:{enable:!0,box:function(){return n.getViewport()}}},i.cull&&(f.cull=i.cull),i.depth&&(f.depth=i.depth),i.blend&&(f.blend=i.blend),o.indicesBuffer&&(f.elements=o.indicesBuffer),o.maxInstancedCount&&(f.instances=o.maxInstancedCount,f.count=o.vertexCount||3),t.next=22,s(f);case 22:r.model=t.sent,this.modelCache[a]=r.model;case 24:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"initView",value:function(){var t=M()(R.a.mark((function t(e){var n,r,i,o;return R.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.getScene(),r=z(n.getEntities()),t.prev=2,r.s();case 4:if((i=r.n()).done){t.next=10;break}return o=i.value,t.next=8,this.initMesh(o,e);case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),r.e(t.t0);case 15:return t.prev=15,r.f(),t.finish(15);case 18:case"end":return t.stop()}}),t,this,[[2,12,15,18]])})));return function(e){return t.apply(this,arguments)}}()}]),t}(),S.IDENTIFIER="Render Pass",m=A,v=B()(m.prototype,"mesh",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=B()(m.prototype,"geometry",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=B()(m.prototype,"material",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=B()(m.prototype,"cullable",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=B()(m.prototype,"transform",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=B()(m.prototype,"hierarchy",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=B()(m.prototype,"frameGraphSystem",[f,l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=B()(m.prototype,"engine",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=B()(m.prototype,"resourcePool",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=m))||p)},1302:function(t,e,n){"use strict";var r=n(878);n.d(e,"gl",(function(){return r.a}));n(1921),n(1922),n(1923),n(1924),n(1925),n(1926),n(1927),n(1928),n(1929),n(1930),n(1931)},1331:function(t,e,n){var r=n(1e3);t.exports=function(t){return r(t,5)}},1366:function(t,e,n){var r=n(2002),i=n(961),o=n(686);t.exports=function(t){return r(t,o,i)}},1383:function(t,e,n){"use strict";var r=n(3),i=n(13),o=n(2),a=n(1),u=(n(10),n(14)),s=n(134),c=n(242),f=n(42),l=n(0),h=Object(f.a)(Object(l.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel"),d=n(29),p=n(17),m=n(450),v=n(15),g=n(8),y=n(69),b=n(78);function E(t){return Object(y.a)("MuiChip",t)}var _=Object(b.a)("MuiChip",["root","sizeSmall","sizeMedium","colorPrimary","colorSecondary","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","focusVisible"]),w=["avatar","className","clickable","color","component","deleteIcon","disabled","icon","label","onClick","onDelete","onKeyDown","onKeyUp","size","variant"],x=Object(g.a)("div",{name:"MuiChip",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState,i=n.color,o=n.clickable,a=n.onDelete,u=n.size,s=n.variant;return[Object(r.a)({},"& .".concat(_.avatar),e.avatar),Object(r.a)({},"& .".concat(_.avatar),e["avatar".concat(Object(p.a)(u))]),Object(r.a)({},"& .".concat(_.avatar),e["avatarColor".concat(Object(p.a)(i))]),Object(r.a)({},"& .".concat(_.icon),e.icon),Object(r.a)({},"& .".concat(_.icon),e["icon".concat(Object(p.a)(u))]),Object(r.a)({},"& .".concat(_.icon),e["iconColor".concat(Object(p.a)(i))]),Object(r.a)({},"& .".concat(_.deleteIcon),e.deleteIcon),Object(r.a)({},"& .".concat(_.deleteIcon),e["deleteIcon".concat(Object(p.a)(u))]),Object(r.a)({},"& .".concat(_.deleteIcon),e["deleteIconColor".concat(Object(p.a)(i))]),Object(r.a)({},"& .".concat(_.deleteIcon),e["deleteIconOutlinedColor".concat(Object(p.a)(i))]),e.root,e["size".concat(Object(p.a)(u))],e["color".concat(Object(p.a)(i))],o&&e.clickable,o&&"default"!==i&&e["clickableColor".concat(Object(p.a)(i),")")],a&&e.deletable,a&&"default"!==i&&e["deletableColor".concat(Object(p.a)(i))],e[s],"outlined"===s&&e["outlined".concat(Object(p.a)(i))]]}})((function(t){var e,n=t.theme,i=t.ownerState,a=Object(c.a)(n.palette.text.primary,.26);return Object(o.a)((e={maxWidth:"100%",fontFamily:n.typography.fontFamily,fontSize:n.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,color:n.palette.text.primary,backgroundColor:n.palette.action.selected,borderRadius:16,whiteSpace:"nowrap",transition:n.transitions.create(["background-color","box-shadow"]),cursor:"default",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box"},Object(r.a)(e,"&.".concat(_.disabled),{opacity:n.palette.action.disabledOpacity,pointerEvents:"none"}),Object(r.a)(e,"& .".concat(_.avatar),{marginLeft:5,marginRight:-6,width:24,height:24,color:"light"===n.palette.mode?n.palette.grey[700]:n.palette.grey[300],fontSize:n.typography.pxToRem(12)}),Object(r.a)(e,"& .".concat(_.avatarColorPrimary),{color:n.palette.primary.contrastText,backgroundColor:n.palette.primary.dark}),Object(r.a)(e,"& .".concat(_.avatarColorSecondary),{color:n.palette.secondary.contrastText,backgroundColor:n.palette.secondary.dark}),Object(r.a)(e,"& .".concat(_.avatarSmall),{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:n.typography.pxToRem(10)}),Object(r.a)(e,"& .".concat(_.icon),Object(o.a)({color:"light"===n.palette.mode?n.palette.grey[700]:n.palette.grey[300],marginLeft:5,marginRight:-6},"small"===i.size&&{fontSize:18,marginLeft:4,marginRight:-4},"default"!==i.color&&{color:"inherit"})),Object(r.a)(e,"& .".concat(_.deleteIcon),Object(o.a)({WebkitTapHighlightColor:"transparent",color:a,fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:Object(c.a)(a,.4)}},"small"===i.size&&{fontSize:16,marginRight:4,marginLeft:-4},"default"!==i.color&&{color:Object(c.a)(n.palette[i.color].contrastText,.7),"&:hover, &:active":{color:n.palette[i.color].contrastText}})),e),"small"===i.size&&{height:24},"default"!==i.color&&{backgroundColor:n.palette[i.color].main,color:n.palette[i.color].contrastText},i.onDelete&&Object(r.a)({},"&.".concat(_.focusVisible),{backgroundColor:Object(c.a)(n.palette.action.selected,n.palette.action.selectedOpacity+n.palette.action.focusOpacity)}),i.onDelete&&"default"!==i.color&&Object(r.a)({},"&.".concat(_.focusVisible),{backgroundColor:n.palette[i.color].dark}))}),(function(t){var e,n=t.theme,i=t.ownerState;return Object(o.a)({},i.clickable&&(e={userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:Object(c.a)(n.palette.action.selected,n.palette.action.selectedOpacity+n.palette.action.hoverOpacity)}},Object(r.a)(e,"&.".concat(_.focusVisible),{backgroundColor:Object(c.a)(n.palette.action.selected,n.palette.action.selectedOpacity+n.palette.action.focusOpacity)}),Object(r.a)(e,"&:active",{boxShadow:n.shadows[1]}),e),i.clickable&&"default"!==i.color&&Object(r.a)({},"&:hover, &.".concat(_.focusVisible),{backgroundColor:n.palette[i.color].dark}))}),(function(t){var e,n,i=t.theme,a=t.ownerState;return Object(o.a)({},"outlined"===a.variant&&(e={backgroundColor:"transparent",border:"1px solid ".concat("light"===i.palette.mode?i.palette.grey[400]:i.palette.grey[700])},Object(r.a)(e,"&.".concat(_.clickable,":hover"),{backgroundColor:i.palette.action.hover}),Object(r.a)(e,"&.".concat(_.focusVisible),{backgroundColor:i.palette.action.focus}),Object(r.a)(e,"& .".concat(_.avatar),{marginLeft:4}),Object(r.a)(e,"& .".concat(_.avatarSmall),{marginLeft:2}),Object(r.a)(e,"& .".concat(_.icon),{marginLeft:4}),Object(r.a)(e,"& .".concat(_.iconSmall),{marginLeft:2}),Object(r.a)(e,"& .".concat(_.deleteIcon),{marginRight:5}),Object(r.a)(e,"& .".concat(_.deleteIconSmall),{marginRight:3}),e),"outlined"===a.variant&&"default"!==a.color&&(n={color:i.palette[a.color].main,border:"1px solid ".concat(Object(c.a)(i.palette[a.color].main,.7))},Object(r.a)(n,"&.".concat(_.clickable,":hover"),{backgroundColor:Object(c.a)(i.palette[a.color].main,i.palette.action.hoverOpacity)}),Object(r.a)(n,"&.".concat(_.focusVisible),{backgroundColor:Object(c.a)(i.palette[a.color].main,i.palette.action.focusOpacity)}),Object(r.a)(n,"& .".concat(_.deleteIcon),{color:Object(c.a)(i.palette[a.color].main,.7),"&:hover, &:active":{color:i.palette[a.color].main}}),n))})),T=Object(g.a)("span",{name:"MuiChip",slot:"Label",overridesResolver:function(t,e){var n=t.ownerState.size;return[e.label,e["label".concat(Object(p.a)(n))]]}})((function(t){var e=t.ownerState;return Object(o.a)({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap"},"small"===e.size&&{paddingLeft:8,paddingRight:8})}));function S(t){return"Backspace"===t.key||"Delete"===t.key}var A=a.forwardRef((function(t,e){var n=Object(v.a)({props:t,name:"MuiChip"}),r=n.avatar,c=n.className,f=n.clickable,g=n.color,y=void 0===g?"default":g,b=n.component,_=n.deleteIcon,A=n.disabled,O=void 0!==A&&A,R=n.icon,C=n.label,M=n.onClick,I=n.onDelete,N=n.onKeyDown,k=n.onKeyUp,P=n.size,j=void 0===P?"medium":P,D=n.variant,L=void 0===D?"filled":D,B=Object(i.a)(n,w),F=a.useRef(null),U=Object(d.a)(F,e),G=function(t){t.stopPropagation(),I&&I(t)},V=!(!1===f||!M)||f,z="small"===j,H=V||I?m.a:b||"div",W=Object(o.a)({},n,{component:H,disabled:O,size:j,color:y,onDelete:!!I,clickable:V,variant:L}),q=function(t){var e=t.classes,n=t.disabled,r=t.size,i=t.color,o=t.onDelete,a=t.clickable,u=t.variant,c={root:["root",u,n&&"disabled","size".concat(Object(p.a)(r)),"color".concat(Object(p.a)(i)),a&&"clickable",a&&"clickableColor".concat(Object(p.a)(i)),o&&"deletable",o&&"deletableColor".concat(Object(p.a)(i)),"".concat(u).concat(Object(p.a)(i))],label:["label","label".concat(Object(p.a)(r))],avatar:["avatar","avatar".concat(Object(p.a)(r)),"avatarColor".concat(Object(p.a)(i))],icon:["icon","icon".concat(Object(p.a)(r)),"iconColor".concat(Object(p.a)(i))],deleteIcon:["deleteIcon","deleteIcon".concat(Object(p.a)(r)),"deleteIconColor".concat(Object(p.a)(i)),"deleteIconOutlinedColor".concat(Object(p.a)(i))]};return Object(s.a)(c,E,e)}(W),X=H===m.a?Object(o.a)({component:b||"div",focusVisibleClassName:q.focusVisible},I&&{disableRipple:!0}):{},Y=null;if(I){var K=Object(u.default)("default"!==y&&("outlined"===L?q["deleteIconOutlinedColor".concat(Object(p.a)(y))]:q["deleteIconColor".concat(Object(p.a)(y))]),z&&q.deleteIconSmall);Y=_&&a.isValidElement(_)?a.cloneElement(_,{className:Object(u.default)(_.props.className,q.deleteIcon,K),onClick:G}):Object(l.jsx)(h,{className:Object(u.default)(q.deleteIcon,K),onClick:G})}var Q=null;r&&a.isValidElement(r)&&(Q=a.cloneElement(r,{className:Object(u.default)(q.avatar,r.props.className)}));var Z=null;return R&&a.isValidElement(R)&&(Z=a.cloneElement(R,{className:Object(u.default)(q.icon,R.props.className)})),Object(l.jsxs)(x,Object(o.a)({as:H,className:Object(u.default)(q.root,c),disabled:!(!V||!O)||void 0,onClick:M,onKeyDown:function(t){t.currentTarget===t.target&&S(t)&&t.preventDefault(),N&&N(t)},onKeyUp:function(t){t.currentTarget===t.target&&(I&&S(t)?I(t):"Escape"===t.key&&F.current&&F.current.blur()),k&&k(t)},ref:U,ownerState:W},X,B,{children:[Q||Z,Object(l.jsx)(T,{className:Object(u.default)(q.label),ownerState:W,children:C}),Y]}))}));e.a=A},1399:function(t,e,n){var r=n(1979);t.exports=function(t){if(Array.isArray(t))return r(t)},t.exports.default=t.exports,t.exports.__esModule=!0},1400:function(t,e){t.exports=function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.default=t.exports,t.exports.__esModule=!0},1402:function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0},1406:function(t,e,n){var r=n(845);t.exports=function(){return r.Date.now()}},1407:function(t,e,n){var r=n(1408),i=n(608),o=n(1013),a=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,s=/^0o[0-7]+$/i,c=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(o(t))return NaN;if(i(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=i(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=r(t);var n=u.test(t);return n||s.test(t)?c(t.slice(2),n?2:8):a.test(t)?NaN:+t}},1408:function(t,e,n){var r=n(1409),i=/^\s+/;t.exports=function(t){return t?t.slice(0,r(t)+1).replace(i,""):t}},1409:function(t,e){var n=/\s/;t.exports=function(t){for(var e=t.length;e--&&n.test(t.charAt(e)););return e}},1415:function(t,e,n){var r=n(715),i=n(723);t.exports=function(t,e){return t&&r(e,i(e),t)}},1416:function(t,e,n){var r=n(715),i=n(686);t.exports=function(t,e){return t&&r(e,i(e),t)}},1417:function(t,e,n){var r=n(608),i=n(898),o=n(1418),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return o(t);var e=i(t),n=[];for(var u in t)("constructor"!=u||!e&&a.call(t,u))&&n.push(u);return n}},1418:function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},1419:function(t,e,n){var r=n(715),i=n(1334);t.exports=function(t,e){return r(t,i(t),e)}},1420:function(t,e,n){var r=n(715),i=n(961);t.exports=function(t,e){return r(t,i(t),e)}},1422:function(t,e){var n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&n.call(t,"index")&&(r.index=t.index,r.input=t.input),r}},1423:function(t,e,n){var r=n(824),i=n(1425),o=n(1426),a=n(1427),u=n(1245);t.exports=function(t,e,n){var s=t.constructor;switch(e){case"[object ArrayBuffer]":return r(t);case"[object Boolean]":case"[object Date]":return new s(+t);case"[object DataView]":return i(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return u(t,n);case"[object Map]":case"[object Set]":return new s;case"[object Number]":case"[object String]":return new s(t);case"[object RegExp]":return o(t);case"[object Symbol]":return a(t)}}},1425:function(t,e,n){var r=n(824);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}},1426:function(t,e){var n=/\w*$/;t.exports=function(t){var e=new t.constructor(t.source,n.exec(t));return e.lastIndex=t.lastIndex,e}},1427:function(t,e,n){var r=n(957),i=r?r.prototype:void 0,o=i?i.valueOf:void 0;t.exports=function(t){return o?Object(o.call(t)):{}}},1428:function(t,e,n){var r=n(1429),i=n(960),o=n(1333),a=o&&o.isMap,u=a?i(a):r;t.exports=u},1429:function(t,e,n){var r=n(724),i=n(730);t.exports=function(t){return i(t)&&"[object Map]"==r(t)}},1430:function(t,e,n){var r=n(1431),i=n(960),o=n(1333),a=o&&o.isSet,u=a?i(a):r;t.exports=u},1431:function(t,e,n){var r=n(724),i=n(730);t.exports=function(t){return i(t)&&"[object Set]"==r(t)}},1433:function(t,e,n){var r=n(1536),i=n(724),o=n(943),a=n(585),u=n(728),s=n(791),c=n(898),f=n(944),l=Object.prototype.hasOwnProperty;t.exports=function(t){if(null==t)return!0;if(u(t)&&(a(t)||"string"==typeof t||"function"==typeof t.splice||s(t)||f(t)||o(t)))return!t.length;var e=i(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(c(t))return!r(t).length;for(var n in t)if(l.call(t,n))return!1;return!0}},1439:function(t,e,n){"use strict";var r=n(3),i=n(13),o=n(2),a=n(1),u=(n(10),n(14)),s=n(134),c=n(242),f=n(17),l=n(253),h=n(15),d=n(8),p=n(826),m=n(0),v=["className","color","edge","size","sx"],g=Object(d.a)("span",{name:"MuiSwitch",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[e.root,n.edge&&e["edge".concat(Object(f.a)(n.edge))],e["size".concat(Object(f.a)(n.size))]]}})((function(t){var e,n=t.ownerState;return Object(o.a)({display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},"start"===n.edge&&{marginLeft:-8},"end"===n.edge&&{marginRight:-8},"small"===n.size&&(e={width:40,height:24,padding:7},Object(r.a)(e,"& .".concat(p.a.thumb),{width:16,height:16}),Object(r.a)(e,"& .".concat(p.a.switchBase),Object(r.a)({padding:4},"&.".concat(p.a.checked),{transform:"translateX(16px)"})),e))})),y=Object(d.a)(l.a,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:function(t,e){var n=t.ownerState;return[e.switchBase,Object(r.a)({},"& .".concat(p.a.input),e.input),"default"!==n.color&&e["color".concat(Object(f.a)(n.color))]]}})((function(t){var e,n=t.theme;return e={position:"absolute",top:0,left:0,zIndex:1,color:"light"===n.palette.mode?n.palette.common.white:n.palette.grey[300],transition:n.transitions.create(["left","transform"],{duration:n.transitions.duration.shortest})},Object(r.a)(e,"&.".concat(p.a.checked),{transform:"translateX(20px)"}),Object(r.a)(e,"&.".concat(p.a.disabled),{color:"light"===n.palette.mode?n.palette.grey[100]:n.palette.grey[600]}),Object(r.a)(e,"&.".concat(p.a.checked," + .").concat(p.a.track),{opacity:.5}),Object(r.a)(e,"&.".concat(p.a.disabled," + .").concat(p.a.track),{opacity:"light"===n.palette.mode?.12:.2}),Object(r.a)(e,"& .".concat(p.a.input),{left:"-100%",width:"300%"}),e}),(function(t){var e,n=t.theme,i=t.ownerState;return Object(o.a)({"&:hover":{backgroundColor:Object(c.a)(n.palette.action.active,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==i.color&&(e={},Object(r.a)(e,"&.".concat(p.a.checked),Object(r.a)({color:n.palette[i.color].main,"&:hover":{backgroundColor:Object(c.a)(n.palette[i.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&.".concat(p.a.disabled),{color:"light"===n.palette.mode?Object(c.e)(n.palette[i.color].main,.62):Object(c.b)(n.palette[i.color].main,.55)})),Object(r.a)(e,"&.".concat(p.a.checked," + .").concat(p.a.track),{backgroundColor:n.palette[i.color].main}),e))})),b=Object(d.a)("span",{name:"MuiSwitch",slot:"Track",overridesResolver:function(t,e){return e.track}})((function(t){var e=t.theme;return{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:"light"===e.palette.mode?e.palette.common.black:e.palette.common.white,opacity:"light"===e.palette.mode?.38:.3}})),E=Object(d.a)("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:function(t,e){return e.thumb}})((function(t){return{boxShadow:t.theme.shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}})),_=a.forwardRef((function(t,e){var n=Object(h.a)({props:t,name:"MuiSwitch"}),r=n.className,a=n.color,c=void 0===a?"primary":a,l=n.edge,d=void 0!==l&&l,_=n.size,w=void 0===_?"medium":_,x=n.sx,T=Object(i.a)(n,v),S=Object(o.a)({},n,{color:c,edge:d,size:w}),A=function(t){var e=t.classes,n=t.edge,r=t.size,i=t.color,a=t.checked,u=t.disabled,c={root:["root",n&&"edge".concat(Object(f.a)(n)),"size".concat(Object(f.a)(r))],switchBase:["switchBase","color".concat(Object(f.a)(i)),a&&"checked",u&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},l=Object(s.a)(c,p.b,e);return Object(o.a)({},e,l)}(S),O=Object(m.jsx)(E,{className:A.thumb,ownerState:S});return Object(m.jsxs)(g,{className:Object(u.default)(A.root,r),sx:x,ownerState:S,children:[Object(m.jsx)(y,Object(o.a)({type:"checkbox",icon:O,checkedIcon:O,ref:e,ownerState:S},T,{classes:Object(o.a)({},A,{root:A.switchBase})})),Object(m.jsx)(b,{className:A.track,ownerState:S})]})}));e.a=_},1443:function(t,e,n){"use strict";var r=n(679);t.exports=o;var i="\0";function o(t){this._isDirected=!r.has(t,"directed")||t.directed,this._isMultigraph=!!r.has(t,"multigraph")&&t.multigraph,this._isCompound=!!r.has(t,"compound")&&t.compound,this._label=void 0,this._defaultNodeLabelFn=r.constant(void 0),this._defaultEdgeLabelFn=r.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function a(t,e){t[e]?t[e]++:t[e]=1}function u(t,e){--t[e]||delete t[e]}function s(t,e,n,i){var o=""+e,a=""+n;if(!t&&o>a){var u=o;o=a,a=u}return o+"\x01"+a+"\x01"+(r.isUndefined(i)?"\0":i)}function c(t,e,n,r){var i=""+e,o=""+n;if(!t&&i>o){var a=i;i=o,o=a}var u={v:i,w:o};return r&&(u.name=r),u}function f(t,e){return s(t,e.v,e.w,e.name)}o.prototype._nodeCount=0,o.prototype._edgeCount=0,o.prototype.isDirected=function(){return this._isDirected},o.prototype.isMultigraph=function(){return this._isMultigraph},o.prototype.isCompound=function(){return this._isCompound},o.prototype.setGraph=function(t){return this._label=t,this},o.prototype.graph=function(){return this._label},o.prototype.setDefaultNodeLabel=function(t){return r.isFunction(t)||(t=r.constant(t)),this._defaultNodeLabelFn=t,this},o.prototype.nodeCount=function(){return this._nodeCount},o.prototype.nodes=function(){return r.keys(this._nodes)},o.prototype.sources=function(){var t=this;return r.filter(this.nodes(),(function(e){return r.isEmpty(t._in[e])}))},o.prototype.sinks=function(){var t=this;return r.filter(this.nodes(),(function(e){return r.isEmpty(t._out[e])}))},o.prototype.setNodes=function(t,e){var n=arguments,i=this;return r.each(t,(function(t){n.length>1?i.setNode(t,e):i.setNode(t)})),this},o.prototype.setNode=function(t,e){return r.has(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=e),this):(this._nodes[t]=arguments.length>1?e:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=i,this._children[t]={},this._children["\0"][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)},o.prototype.node=function(t){return this._nodes[t]},o.prototype.hasNode=function(t){return r.has(this._nodes,t)},o.prototype.removeNode=function(t){var e=this;if(r.has(this._nodes,t)){var n=function(t){e.removeEdge(e._edgeObjs[t])};delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],r.each(this.children(t),(function(t){e.setParent(t)})),delete this._children[t]),r.each(r.keys(this._in[t]),n),delete this._in[t],delete this._preds[t],r.each(r.keys(this._out[t]),n),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this},o.prototype.setParent=function(t,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(r.isUndefined(e))e=i;else{for(var n=e+="";!r.isUndefined(n);n=this.parent(n))if(n===t)throw new Error("Setting "+e+" as parent of "+t+" would create a cycle");this.setNode(e)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=e,this._children[e][t]=!0,this},o.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},o.prototype.parent=function(t){if(this._isCompound){var e=this._parent[t];if(e!==i)return e}},o.prototype.children=function(t){if(r.isUndefined(t)&&(t=i),this._isCompound){var e=this._children[t];if(e)return r.keys(e)}else{if(t===i)return this.nodes();if(this.hasNode(t))return[]}},o.prototype.predecessors=function(t){var e=this._preds[t];if(e)return r.keys(e)},o.prototype.successors=function(t){var e=this._sucs[t];if(e)return r.keys(e)},o.prototype.neighbors=function(t){var e=this.predecessors(t);if(e)return r.union(e,this.successors(t))},o.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},o.prototype.filterNodes=function(t){var e=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});e.setGraph(this.graph());var n=this;r.each(this._nodes,(function(n,r){t(r)&&e.setNode(r,n)})),r.each(this._edgeObjs,(function(t){e.hasNode(t.v)&&e.hasNode(t.w)&&e.setEdge(t,n.edge(t))}));var i={};function o(t){var r=n.parent(t);return void 0===r||e.hasNode(r)?(i[t]=r,r):r in i?i[r]:o(r)}return this._isCompound&&r.each(e.nodes(),(function(t){e.setParent(t,o(t))})),e},o.prototype.setDefaultEdgeLabel=function(t){return r.isFunction(t)||(t=r.constant(t)),this._defaultEdgeLabelFn=t,this},o.prototype.edgeCount=function(){return this._edgeCount},o.prototype.edges=function(){return r.values(this._edgeObjs)},o.prototype.setPath=function(t,e){var n=this,i=arguments;return r.reduce(t,(function(t,r){return i.length>1?n.setEdge(t,r,e):n.setEdge(t,r),r})),this},o.prototype.setEdge=function(){var t,e,n,i,o=!1,u=arguments[0];"object"===typeof u&&null!==u&&"v"in u?(t=u.v,e=u.w,n=u.name,2===arguments.length&&(i=arguments[1],o=!0)):(t=u,e=arguments[1],n=arguments[3],arguments.length>2&&(i=arguments[2],o=!0)),t=""+t,e=""+e,r.isUndefined(n)||(n=""+n);var f=s(this._isDirected,t,e,n);if(r.has(this._edgeLabels,f))return o&&(this._edgeLabels[f]=i),this;if(!r.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(e),this._edgeLabels[f]=o?i:this._defaultEdgeLabelFn(t,e,n);var l=c(this._isDirected,t,e,n);return t=l.v,e=l.w,Object.freeze(l),this._edgeObjs[f]=l,a(this._preds[e],t),a(this._sucs[t],e),this._in[e][f]=l,this._out[t][f]=l,this._edgeCount++,this},o.prototype.edge=function(t,e,n){var r=1===arguments.length?f(this._isDirected,arguments[0]):s(this._isDirected,t,e,n);return this._edgeLabels[r]},o.prototype.hasEdge=function(t,e,n){var i=1===arguments.length?f(this._isDirected,arguments[0]):s(this._isDirected,t,e,n);return r.has(this._edgeLabels,i)},o.prototype.removeEdge=function(t,e,n){var r=1===arguments.length?f(this._isDirected,arguments[0]):s(this._isDirected,t,e,n),i=this._edgeObjs[r];return i&&(t=i.v,e=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],u(this._preds[e],t),u(this._sucs[t],e),delete this._in[e][r],delete this._out[t][r],this._edgeCount--),this},o.prototype.inEdges=function(t,e){var n=this._in[t];if(n){var i=r.values(n);return e?r.filter(i,(function(t){return t.v===e})):i}},o.prototype.outEdges=function(t,e){var n=this._out[t];if(n){var i=r.values(n);return e?r.filter(i,(function(t){return t.w===e})):i}},o.prototype.nodeEdges=function(t,e){var n=this.inEdges(t,e);if(n)return n.concat(this.outEdges(t,e))}},1445:function(t,e,n){var r=n(1013);t.exports=function(t,e,n){for(var i=-1,o=t.length;++i<o;){var a=t[i],u=e(a);if(null!=u&&(void 0===s?u===u&&!r(u):n(u,s)))var s=u,c=a}return c}},1446:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));var r=-1,i=1;function o(){return i++}},1447:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BindingOnSyntax=void 0;var r=n(1448),i=function(){function t(t){this._binding=t}return t.prototype.onActivation=function(t){return this._binding.onActivation=t,new r.BindingWhenSyntax(this._binding)},t}();e.BindingOnSyntax=i},1448:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BindingWhenSyntax=void 0;var r=n(1447),i=n(1917),o=function(){function t(t){this._binding=t}return t.prototype.when=function(t){return this._binding.constraint=t,new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetNamed=function(t){return this._binding.constraint=i.namedConstraint(t),new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(t){return null!==t.target&&!t.target.isNamed()&&!t.target.isTagged()},new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetTagged=function(t,e){return this._binding.constraint=i.taggedConstraint(t)(e),new r.BindingOnSyntax(this._binding)},t.prototype.whenInjectedInto=function(t){return this._binding.constraint=function(e){return i.typeConstraint(t)(e.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenParentNamed=function(t){return this._binding.constraint=function(e){return i.namedConstraint(t)(e.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenParentTagged=function(t,e){return this._binding.constraint=function(n){return i.taggedConstraint(t)(e)(n.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorIs=function(t){return this._binding.constraint=function(e){return i.traverseAncerstors(e,i.typeConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorIs=function(t){return this._binding.constraint=function(e){return!i.traverseAncerstors(e,i.typeConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorNamed=function(t){return this._binding.constraint=function(e){return i.traverseAncerstors(e,i.namedConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorNamed=function(t){return this._binding.constraint=function(e){return!i.traverseAncerstors(e,i.namedConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._binding.constraint=function(n){return i.traverseAncerstors(n,i.taggedConstraint(t)(e))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorTagged=function(t,e){return this._binding.constraint=function(n){return!i.traverseAncerstors(n,i.taggedConstraint(t)(e))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorMatches=function(t){return this._binding.constraint=function(e){return i.traverseAncerstors(e,t)},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorMatches=function(t){return this._binding.constraint=function(e){return!i.traverseAncerstors(e,t)},new r.BindingOnSyntax(this._binding)},t}();e.BindingWhenSyntax=o},1449:function(t,e,n){"use strict";n.d(e,"a",(function(){return O}));var r,i,o,a,u,s,c,f,l=n(587),h=n.n(l),d=n(588),p=n.n(d),m=n(562),v=n.n(m),g=n(244),y=n.n(g),b=n(245),E=n.n(b),_=n(563),w=n.n(_),x=(n(564),n(530)),T=n(534),S=n(653),A=n(878),O=(r=Object(x.injectable)(),i=Object(x.inject)(S.a.GeometryComponentManager),o=Object(x.inject)(S.a.RenderEngine),r((f=function(){function t(){y()(this,t),v()(this,"geometry",s,this),v()(this,"engine",c,this)}return E()(t,[{key:"execute",value:function(){var t=p()(h.a.mark((function t(){var e=this;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.geometry.forEach((function(t,n){n.dirty&&(n.attributes.forEach((function(t){if(t.dirty&&t.data){var n;if(t.buffer)null===(n=t.buffer)||void 0===n||n.subData({data:t.data,offset:0});else t.buffer=e.engine.createBuffer({data:t.data,type:A.a.FLOAT});t.dirty=!1}})),n.indices&&(n.indicesBuffer?n.indicesBuffer.subData({data:n.indices,offset:0}):n.indicesBuffer=e.engine.createElements({data:n.indices,count:n.indices.length,type:A.a.UNSIGNED_INT,usage:A.a.STATIC_DRAW})),n.dirty=!1)}));case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"tearDown",value:function(){this.geometry.forEach((function(t,e){e.indicesBuffer&&e.indicesBuffer.destroy(),e.attributes.forEach((function(t){t.buffer&&t.buffer.destroy()}))})),this.geometry.clear()}},{key:"createBufferGeometry",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{vertexCount:3},e=t.vertexCount,n=Object(T.createEntity)();return this.geometry.create(n,{vertexCount:e})}},{key:"createInstancedBufferGeometry",value:function(t){var e=t.maxInstancedCount,n=t.vertexCount,r=Object(T.createEntity)();return this.geometry.create(r,{maxInstancedCount:e,vertexCount:n})}}]),t}(),u=f,s=w()(u.prototype,"geometry",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=w()(u.prototype,"engine",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=u))||a)},1450:function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));var r=n(250),i=n.n(r),o=n(244),a=n.n(o),u=n(245),s=n.n(u),c=n(691),f=n.n(c),l=n(616),h=n.n(l),d=n(617),p=n.n(d),m=n(618),v=n.n(m),g=n(534);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function E(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v()(t);if(e){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var _=function(t){h()(n,t);var e=E(n);function n(t){var r;return a()(this,n),(r=e.call(this,t)).vertexShaderGLSL=void 0,r.fragmentShaderGLSL=void 0,r.defines={},r.dirty=!0,r.uniforms=[],r.cull={enable:!0,face:g.gl.BACK},r.depth={enable:!0},r.blend=void 0,r.entity=void 0,r.type=void 0,Object.assign(f()(r),t),r}return s()(n,[{key:"setDefines",value:function(t){return this.defines=b(b({},this.defines),t),this}},{key:"setCull",value:function(t){return this.cull=t,this}},{key:"setDepth",value:function(t){return this.depth=t,this}},{key:"setBlend",value:function(t){return this.blend=t,this}},{key:"setUniform",value:function(t,e){var n=this;if("string"!==typeof t)return Object.keys(t).forEach((function(e){return n.setUniform(e,t[e])})),this;var r=this.uniforms.find((function(e){return e.name===t}));return r?(r.dirty=!0,r.data=e):this.uniforms.push({name:t,dirty:!0,data:e}),this.dirty=!0,this}}]),n}(n(651).a)},1451:function(t,e,n){"use strict";n.d(e,"a",(function(){return N}));var r,i,o,a,u,s,c,f,l,h,d=n(250),p=n.n(d),m=n(587),v=n.n(m),g=n(588),y=n.n(g),b=n(562),E=n.n(b),_=n(244),w=n.n(_),x=n(245),T=n.n(x),S=n(563),A=n.n(S),O=(n(564),n(530)),R=n(534),C=n(653);function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function I(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(Object(n),!0).forEach((function(e){p()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var N=(r=Object(O.injectable)(),i=Object(O.inject)(C.a.MaterialComponentManager),o=Object(O.inject)(C.a.RenderEngine),a=Object(O.inject)(C.a.ShaderModuleService),r((h=function(){function t(){w()(this,t),E()(this,"material",c,this),E()(this,"engine",f,this),E()(this,"shaderModule",l,this)}return T()(t,[{key:"execute",value:function(){var t=y()(v.a.mark((function t(){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"tearDown",value:function(){this.material.clear()}},{key:"createShaderMaterial",value:function(t){var e=Object(R.createEntity)(),n=t.vertexShader,r=t.fragmentShader,i=[];if(!this.engine.supportWebGPU){var o="material-".concat(e);this.shaderModule.registerModule(o,{vs:t.vertexShader,fs:t.fragmentShader});var a=this.shaderModule.getModule(o);n=a.vs,r=a.fs,a.uniforms&&(i=Object.keys(a.uniforms).map((function(t){return{dirty:!0,name:t,data:a.uniforms[t]}})))}return this.material.create(e,I(I({vertexShaderGLSL:n,fragmentShaderGLSL:r},t),{},{uniforms:i}))}}]),t}(),s=h,c=A()(s.prototype,"material",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=A()(s.prototype,"engine",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=A()(s.prototype,"shaderModule",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=s))||u)},1452:function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r,i=n(244),o=n.n(i),a=n(691),u=n.n(a),s=n(616),c=n.n(s),f=n(617),l=n.n(f),h=n(618),d=n.n(h),p=n(651);function m(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}!function(t){t[t.Standard=0]="Standard"}(r||(r={}));var v=function(t){c()(n,t);var e=m(n);function n(t){var i;return o()(this,n),(i=e.call(this,t)).strategy=r.Standard,i.visibilityPlaneMask=0,i.visible=!1,Object.assign(u()(i),t),i}return n}(p.a)},1453:function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r=n(244),i=n.n(r),o=n(691),a=n.n(o),u=n(616),s=n.n(u),c=n(617),f=n.n(c),l=n(618),h=n.n(l),d=n(651),p=n(1299);function m(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var v=function(t){s()(n,t);var e=m(n);function n(t){var r;return i()(this,n),(r=e.call(this,t)).material=void 0,r.geometry=void 0,r.aabb=new p.a,r.aabbDirty=!0,r.model=void 0,r.visible=!0,r.children=[],Object.assign(a()(r),t),r}return n}(d.a)},1454:function(t,e,n){"use strict";n.d(e,"a",(function(){return D}));var r,i,o,a,u,s,c,f,l,h,d,p,m,v,g=n(587),y=n.n(g),b=n(588),E=n.n(b),_=n(562),w=n.n(_),x=n(244),T=n.n(x),S=n(245),A=n.n(S),O=n(563),R=n.n(O),C=(n(564),n(558)),M=n(530),I=n(653),N=n(1455),k=n(1969);function P(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return j(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function j(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var D=(r=Object(M.injectable)(),i=Object(M.inject)(I.a.MeshComponentManager),o=Object(M.inject)(I.a.CullableComponentManager),a=Object(M.inject)(I.a.GeometryComponentManager),u=Object(M.inject)(I.a.HierarchyComponentManager),s=Object(M.inject)(I.a.TransformComponentManager),r((v=function(){function t(){T()(this,t),w()(this,"mesh",l,this),w()(this,"cullable",h,this),w()(this,"geometry",d,this),w()(this,"hierarchy",p,this),w()(this,"transform",m,this),this.planes=void 0}return A()(t,[{key:"setFrustumPlanes",value:function(t){this.planes=t}},{key:"execute",value:function(){var t=E()(y.a.mark((function t(e){var n,r,i,o,a,u,s,c,f,l,h,d,p,m,v,g,b,E,_,w,x;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=P(e);try{for(n.s();!(r=n.n()).done;){i=r.value,o=i.getScene(),a=i.getCamera(),u=P(o.getEntities());try{for(u.s();!(s=u.n()).done;)c=s.value,(f=this.mesh.getComponentByEntity(c))&&(l=this.hierarchy.getComponentByEntity(c),h=this.cullable.getComponentByEntity(c),d=f.geometry,p=this.transform.getComponentByEntity(c),d&&d.aabb&&p&&f.aabbDirty&&(m=p.worldTransform,v=d.aabb,g=v.center,b=v.halfExtents,E=C.e.transformMat4(C.e.create(),g,m),_=Object(k.b)(m,C.a.create()),w=C.e.transformMat3(C.e.create(),b,_),f.aabb.update(E,w),f.aabbDirty=!1),h&&d&&(x=this.cullable.getComponentByEntity((null===l||void 0===l?void 0:l.parentID)||-1),h.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(f.aabb,(null===x||void 0===x?void 0:x.visibilityPlaneMask)||N.b.INDETERMINATE,this.planes||a.getFrustum().planes),h.visible=h.visibilityPlaneMask!==N.b.OUTSIDE))}catch(y){u.e(y)}finally{u.f()}}}catch(y){n.e(y)}finally{n.f()}case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"tearDown",value:function(){this.cullable.clear(),this.mesh.clear()}},{key:"computeVisibilityWithPlaneMask",value:function(t,e,n){if(e===N.b.OUTSIDE||e===N.b.INSIDE)return e;for(var r=N.b.INSIDE,i=0,o=n.length;i<o;++i){var a=i<31?1<<i:0;if(!(i<31&&0===(e&a))){var u=n[i],s=u.normal,c=u.distance;if(C.e.dot(s,t.getNegativeFarPoint(n[i]))+c>0)return N.b.OUTSIDE;C.e.dot(s,t.getPositiveFarPoint(n[i]))+c>0&&(r|=a)}}return r}}]),t}(),f=v,l=R()(f.prototype,"mesh",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=R()(f.prototype,"cullable",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=R()(f.prototype,"geometry",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=R()(f.prototype,"hierarchy",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=R()(f.prototype,"transform",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=f))||c)},1455:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return h}));var r,i=n(948),o=n.n(i),a=n(244),u=n.n(a),s=n(245),c=n.n(s),f=n(558),l=n(1456);!function(t){t[t.OUTSIDE=4294967295]="OUTSIDE",t[t.INSIDE=0]="INSIDE",t[t.INDETERMINATE=2147483647]="INDETERMINATE"}(r||(r={}));var h=function(){function t(e){if(u()(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new l.a)}return c()(t,[{key:"extractFromVPMatrix",value:function(t){var e=o()(t,16),n=e[0],r=e[1],i=e[2],a=e[3],u=e[4],s=e[5],c=e[6],l=e[7],h=e[8],d=e[9],p=e[10],m=e[11],v=e[12],g=e[13],y=e[14],b=e[15];f.e.set(this.planes[0].normal,a-n,l-u,m-h),this.planes[0].distance=-(b-v),f.e.set(this.planes[1].normal,a+n,l+u,m+h),this.planes[1].distance=-(b+v),f.e.set(this.planes[2].normal,a+r,l+s,m+d),this.planes[2].distance=-(b+g),f.e.set(this.planes[3].normal,a-r,l-s,m-d),this.planes[3].distance=-(b-g),f.e.set(this.planes[4].normal,a-i,l-c,m-p),this.planes[4].distance=-(b-y),f.e.set(this.planes[5].normal,a+i,l+c,m+p),this.planes[5].distance=-(b+y),this.planes.forEach((function(t){t.normalize(),t.updatePNVertexFlag()}))}}]),t}()},1456:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(244),i=n.n(r),o=n(245),a=n.n(o),u=n(558),s=function(){function t(e,n){i()(this,t),this.distance=void 0,this.normal=void 0,this.pnVertexFlag=void 0,this.distance=e||0,this.normal=n||u.e.fromValues(0,1,0),this.updatePNVertexFlag()}return a()(t,[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(t){return u.e.dot(t,this.normal)-this.distance}},{key:"normalize",value:function(){var t=1/u.e.len(this.normal);u.e.scale(this.normal,this.normal,t),this.distance*=t}},{key:"intersectsLine",value:function(t,e,n){var r=this.distanceToPoint(t),i=r/(r-this.distanceToPoint(e)),o=i>=0&&i<=1;return o&&n&&u.e.lerp(n,t,e,i),o}}]),t}()},1457:function(t,e,n){"use strict";n.d(e,"a",(function(){return k}));var r,i,o,a,u,s,c,f,l,h,d,p,m,v=n(587),g=n.n(v),y=n(588),b=n.n(y),E=n(562),_=n.n(E),w=n(244),x=n.n(w),T=n(245),S=n.n(T),A=n(563),O=n.n(A),R=(n(564),n(530)),C=n(653),M=n(1918),I=n(1300),N=n(1301),k=(r=Object(R.injectable)(),i=Object(R.inject)(C.a.Systems),o=Object(R.named)(C.a.FrameGraphSystem),a=Object(R.inject)(C.a.RenderPassFactory),u=Object(R.inject)(C.a.ConfigService),s=Object(R.inject)(C.a.ResourcePool),r((m=function(){function t(){x()(this,t),_()(this,"frameGraphSystem",l,this),_()(this,"renderPassFactory",h,this),_()(this,"configService",d,this),_()(this,"resourcePool",p,this)}return S()(t,[{key:"execute",value:function(){var t=b()(g.a.mark((function t(e){var n,r,i,o,a,u,s,c;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=this.renderPassFactory(N.a.IDENTIFIER),r=n.setup,i=n.execute,this.frameGraphSystem.addPass(N.a.IDENTIFIER,r,i),o=this.renderPassFactory(M.a.IDENTIFIER),a=o.setup,u=o.execute,s=o.tearDown,c=this.frameGraphSystem.addPass(M.a.IDENTIFIER,a,u,s),this.frameGraphSystem.present(c.data.output);case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"tearDown",value:function(){this.resourcePool.clean()}},{key:"pick",value:function(t,e){return this.renderPassFactory(I.a.IDENTIFIER).pick(t,e)}}]),t}(),f=m,l=O()(f.prototype,"frameGraphSystem",[i,o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=O()(f.prototype,"renderPassFactory",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=O()(f.prototype,"configService",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=O()(f.prototype,"resourcePool",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=f))||c)},1458:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n(244),i=n.n(r),o=n(691),a=n.n(o),u=n(616),s=n.n(u),c=n(617),f=n.n(c),l=n(618),h=n.n(l);function d(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var p=function(t){s()(n,t);var e=d(n);function n(t){var r;return i()(this,n),(r=e.call(this,t)).parentID=void 0,Object.assign(a()(r),t),r}return n}(n(651).a)},1459:function(t,e,n){"use strict";n.d(e,"a",(function(){return R}));var r,i,o,a,u,s,c,f,l,h,d=n(587),p=n.n(d),m=n(588),v=n.n(m),g=n(562),y=n.n(g),b=n(244),E=n.n(b),_=n(245),w=n.n(_),x=n(563),T=n.n(x),S=(n(564),n(558)),A=n(530),O=n(653),R=(r=Object(A.injectable)(),i=Object(A.inject)(O.a.HierarchyComponentManager),o=Object(A.inject)(O.a.TransformComponentManager),a=Object(A.inject)(O.a.MeshComponentManager),r((h=function(){function t(){E()(this,t),y()(this,"hierarchy",c,this),y()(this,"transform",f,this),y()(this,"mesh",l,this)}return w()(t,[{key:"execute",value:function(){var t=v()(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.runTransformUpdateSystem(),this.runHierarchyUpdateSystem();case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"tearDown",value:function(){this.hierarchy.clear(),this.transform.clear()}},{key:"getHierarchyComponentManager",value:function(){return this.hierarchy}},{key:"getTransformComponentManager",value:function(){return this.transform}},{key:"runTransformUpdateSystem",value:function(){var t=this;this.transform.forEach((function(e,n){(n.isDirty()||n.isLocalDirty())&&(t.setMeshAABBDirty(t.mesh.getComponentByEntity(e)),n.updateTransform())}))}},{key:"runHierarchyUpdateSystem",value:function(){var t=this;this.hierarchy.forEach((function(e,n){var r=t.transform.getComponentByEntity(e),i=t.transform.getComponentByEntity(n.parentID);null!==r&&null!==i&&r.updateTransformWithParent(i)}))}},{key:"attach",value:function(t,e,n){this.hierarchy.contains(t)&&this.detach(t),this.hierarchy.create(t,{parentID:e});var r=this.mesh.getComponentByEntity(e);if(this.setMeshAABBDirty(r),r&&-1===r.children.indexOf(t)&&r.children.push(t),this.hierarchy.getCount()>1)for(var i=this.hierarchy.getCount()-1;i>0;--i)for(var o=this.hierarchy.getEntity(i),a=0;a<i;++a){if(this.hierarchy.getComponent(a).parentID===o){this.hierarchy.moveItem(i,a),++i;break}}this.hierarchy.getComponentByEntity(t);var u=this.transform.getComponentByEntity(e);null===u&&(u=this.transform.create(e));var s=this.transform.getComponentByEntity(t);null===s&&(s=this.transform.create(t),u=this.transform.getComponentByEntity(e)),s.parent=u,!n&&u&&(s.matrixTransform(S.b.invert(S.b.create(),u.worldTransform)),s.updateTransform()),u&&s.updateTransformWithParent(u)}},{key:"detach",value:function(t){var e=this.hierarchy.getComponentByEntity(t);if(null!==e){var n=this.transform.getComponentByEntity(t);null!==n&&(n.parent=null,n.applyTransform()),this.hierarchy.removeKeepSorted(t);var r=this.mesh.getComponentByEntity(e.parentID);if(r){var i=r.children.indexOf(t);r.children.splice(i,1)}this.setMeshAABBDirty(r)}}},{key:"detachChildren",value:function(t){var e=this.mesh.getComponentByEntity(t);e&&(e.children=[]);for(var n=0;n<this.hierarchy.getCount();){var r;if((null===(r=this.hierarchy.getComponent(n))||void 0===r?void 0:r.parentID)===t){var i=this.hierarchy.getEntity(n);this.detach(i)}else++n}}},{key:"setMeshAABBDirty",value:function(t){t&&(t.aabbDirty=!0)}}]),t}(),s=h,c=T()(s.prototype,"hierarchy",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=T()(s.prototype,"transform",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=T()(s.prototype,"mesh",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=s))||u)},1460:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var r=n(244),i=n.n(r),o=n(245),a=n.n(o),u=n(691),s=n.n(u),c=n(616),f=n.n(c),l=n(617),h=n.n(l),d=n(618),p=n.n(d),m=n(558);function v(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var g=function(t){f()(n,t);var e=v(n);function n(t){var r;return i()(this,n),(r=e.call(this,t)).dirtyFlag=void 0,r.localDirtyFlag=void 0,r.parent=null,r.localPosition=m.e.fromValues(0,0,0),r.localRotation=m.c.fromValues(0,0,0,1),r.localScale=m.e.fromValues(1,1,1),r.localTransform=m.b.create(),r.position=m.e.fromValues(0,0,0),r.rotation=m.c.fromValues(0,0,0,1),r.scaling=m.e.fromValues(1,1,1),r.worldTransform=m.b.create(),r.matrixTransform=function(){var t=m.b.create();return function(e){m.b.multiply(t,r.getLocalTransform(),e),m.b.getScaling(r.localScale,t),m.b.getTranslation(r.localPosition,t),m.b.getRotation(r.localRotation,t)}}(),r.rotateRollPitchYaw=function(){var t=m.c.create(),e=m.c.create(),n=m.c.create();return function(i,o,a){r.setDirty(),m.c.fromEuler(t,i,0,0),m.c.fromEuler(e,0,o,0),m.c.fromEuler(n,0,0,a),m.c.multiply(r.localRotation,t,r.localRotation),m.c.multiply(r.localRotation,r.localRotation,e),m.c.multiply(r.localRotation,n,r.localRotation),m.c.normalize(r.localRotation,r.localRotation)}}(),r.lerp=function(){var t=m.e.create(),e=m.c.create(),n=m.e.create(),i=m.e.create(),o=m.c.create(),a=m.e.create();return function(u,s,c){r.setDirty(),m.b.getScaling(t,u.worldTransform),m.b.getTranslation(n,u.worldTransform),m.b.getRotation(e,u.worldTransform),m.b.getScaling(i,s.worldTransform),m.b.getTranslation(a,s.worldTransform),m.b.getRotation(o,s.worldTransform),m.e.lerp(r.localScale,t,i,c),m.c.slerp(r.localRotation,e,o,c),m.e.lerp(r.localPosition,n,a,c)}}(),r.translate=function(){var t=m.e.create();return function(e){return m.e.add(t,r.getPosition(),e),r.setPosition(t),r.setDirty(!0),s()(r)}}(),r.translateLocal=function(t){return m.e.transformQuat(t,t,r.localRotation),m.e.add(r.localPosition,r.localPosition,t),r.setLocalDirty(!0),s()(r)},r.setPosition=function(){var t=m.b.create();return function(e){return r.position=e,r.setLocalDirty(!0),null===r.parent?m.e.copy(r.localPosition,e):(m.b.copy(t,r.parent.worldTransform),m.b.invert(t,t),m.e.transformMat4(r.localPosition,e,t)),s()(r)}}(),r.rotate=function(){var t=m.c.create();return function(e){if(null===r.parent)m.c.multiply(r.localRotation,r.localRotation,e),m.c.normalize(r.localRotation,r.localRotation);else{var n=r.getRotation(),i=r.parent.getRotation();m.c.copy(t,i),m.c.invert(t,t),m.c.multiply(t,t,e),m.c.multiply(r.localRotation,e,n),m.c.normalize(r.localRotation,r.localRotation)}return r.setLocalDirty(),s()(r)}}(),r.rotateLocal=function(t){return m.c.multiply(r.localRotation,r.localRotation,t),m.c.normalize(r.localRotation,r.localRotation),r.setLocalDirty(!0),s()(r)},r.setRotation=function(){var t=m.c.create();return function(e){return null===r.parent?m.c.copy(r.localRotation,e):(m.c.copy(t,r.parent.getRotation()),m.c.invert(t,t),m.c.copy(r.localRotation,t),m.c.mul(r.localRotation,r.localRotation,e)),r.setLocalDirty(!0),s()(r)}}(),r}return a()(n,[{key:"setLocalPosition",value:function(t){m.e.copy(this.localPosition,t),this.setLocalDirty(!0)}},{key:"setLocalScale",value:function(t){m.e.copy(this.localScale,t),this.setLocalDirty(!0)}},{key:"setLocalRotation",value:function(t){return m.c.copy(this.localRotation,t),this.setLocalDirty(!0),this}},{key:"isDirty",value:function(){return this.dirtyFlag}},{key:"setDirty",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t?this.dirtyFlag|=n.DIRTY:this.dirtyFlag&=~n.DIRTY}},{key:"isLocalDirty",value:function(){return this.localDirtyFlag}},{key:"setLocalDirty",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t?(this.localDirtyFlag|=n.DIRTY,this.setDirty(!0)):this.localDirtyFlag&=~n.DIRTY}},{key:"updateTransform",value:function(){this.isLocalDirty()&&this.getLocalTransform(),this.isDirty()&&null===this.parent&&(m.b.copy(this.worldTransform,this.getLocalTransform()),this.setDirty(!1))}},{key:"updateTransformWithParent",value:function(t){m.b.multiply(this.worldTransform,t.worldTransform,this.getLocalTransform())}},{key:"applyTransform",value:function(){this.setDirty(),m.b.getScaling(this.localScale,this.worldTransform),m.b.getTranslation(this.localPosition,this.worldTransform),m.b.getRotation(this.localRotation,this.worldTransform)}},{key:"clearTransform",value:function(){this.setDirty(),this.localPosition=m.e.fromValues(0,0,0),this.localRotation=m.c.fromValues(0,0,0,1),this.localScale=m.e.fromValues(1,1,1)}},{key:"scaleLocal",value:function(t){return this.setLocalDirty(),m.e.multiply(this.localScale,this.localScale,t),this}},{key:"getLocalPosition",value:function(){return this.localPosition}},{key:"getLocalRotation",value:function(){return this.localRotation}},{key:"getLocalScale",value:function(){return this.localScale}},{key:"getLocalTransform",value:function(){return this.localDirtyFlag&&(m.b.fromRotationTranslationScale(this.localTransform,this.localRotation,this.localPosition,this.localScale),this.setLocalDirty(!1)),this.localTransform}},{key:"getWorldTransform",value:function(){return this.isLocalDirty()||this.isDirty()?(this.parent&&this.parent.getWorldTransform(),this.updateTransform(),this.worldTransform):this.worldTransform}},{key:"getPosition",value:function(){return m.b.getTranslation(this.position,this.worldTransform),this.position}},{key:"getRotation",value:function(){return m.b.getRotation(this.rotation,this.worldTransform),this.rotation}},{key:"getScale",value:function(){return m.b.getScaling(this.scaling,this.worldTransform),this.scaling}}]),n}(n(651).a);g.DIRTY=1},1461:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r,i,o=n(244),a=n.n(o),u=n(245),s=n.n(u),c=n(530),f=Object(c.injectable)()((i=function(){function t(){a()(this,t),this.config=void 0}return s()(t,[{key:"get",value:function(){return this.config}},{key:"set",value:function(t){this.config=t}}]),t}(),r=i))||r},1462:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r,i,o=n(244),a=n.n(o),u=n(245),s=n.n(u),c=n(530);!function(t){t.PANSTART="PANSTART",t.PANEND="PANEND",t.PANMOVE="PANMOVE",t.PINCH="PINCH",t.KEYDOWN="KEYDOWN",t.KEYUP="KEYUP",t.HOVER="HOVER"}(i||(i={}));var f=Object(c.injectable)()(r=function(){function t(){a()(this,t)}return s()(t,[{key:"listen",value:function(t){}},{key:"on",value:function(t,e){}},{key:"connect",value:function(){}},{key:"disconnect",value:function(){}},{key:"destroy",value:function(){}}]),t}())||r},1463:function(t,e){t.exports=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}},1523:function(t,e,n){"use strict";n.d(e,"a",(function(){return F}));var r=n(948),i=n.n(r),o=n(587),a=n.n(o),u=n(588),s=n.n(u),c=n(562),f=n.n(c),l=n(244),h=n.n(l),d=n(245),p=n.n(d),m=n(563),v=n.n(m),g=(n(564),n(530)),y=n(653),b=function t(){h()(this,t),this.index=void 0},E=function t(){h()(this,t),this.name=void 0,this.data=void 0,this.execute=void 0,this.tearDown=void 0},_=function(){function t(){h()(this,t),this.name=void 0,this.refCount=0,this.hasSideEffect=!1,this.devirtualize=[],this.destroy=[],this.reads=[],this.writes=[]}return p()(t,[{key:"read",value:function(t){return this.reads.find((function(e){return e.index===t.index}))||this.reads.push(t),t}},{key:"sample",value:function(t){return this.read(t),t}},{key:"write",value:function(t,e){if(this.writes.find((function(t){return t.index===e.index})))return e;var n=t.getResourceNode(e);n.resource.version++,n.resource.imported&&(this.hasSideEffect=!0);var r=t.createResourceNode(n.resource);return t.getResourceNode(r).writer=this,this.writes.push(r),r}}]),t}(),w=n(616),x=n.n(w),T=n(617),S=n.n(T),A=n(618),O=n.n(A);function R(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=O()(t);if(e){var i=O()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var C,M,I,N,k,P,j=function(t){x()(n,t);var e=R(n);function n(){var t;h()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).version=0,t.refs=0,t.name=void 0,t.imported=void 0,t.priority=void 0,t.discardStart=!0,t.discardEnd=!1,t.descriptor=void 0,t.resource=void 0,t}return p()(n,[{key:"preExecuteDestroy",value:function(){this.discardEnd=!0}},{key:"postExecuteDestroy",value:function(){this.imported}},{key:"postExecuteDevirtualize",value:function(){this.discardStart=!1}},{key:"preExecuteDevirtualize",value:function(){this.imported}}]),n}((function t(){h()(this,t),this.first=void 0,this.last=void 0})),D=function t(){h()(this,t),this.resource=void 0,this.writer=void 0,this.readerCount=0,this.version=void 0};function L(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return B(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var F=(C=Object(g.injectable)(),M=Object(g.inject)(y.a.RenderEngine),C((P=function(){function t(){h()(this,t),this.passNodes=[],this.resourceNodes=[],this.frameGraphPasses=[],f()(this,"engine",k,this)}return p()(t,[{key:"execute",value:function(){var t=s()(a.a.mark((function t(e){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.compile(),t.next=3,this.executePassNodes(e);case 3:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"tearDown",value:function(){this.frameGraphPasses.forEach((function(t){t.tearDown&&t.tearDown()})),this.reset()}},{key:"addPass",value:function(t,e,n,r){var i=new E;i.execute=n,r&&(i.tearDown=r),i.name=t;var o=new _;return o.name=t,this.passNodes.push(o),this.frameGraphPasses.push(i),e(this,o,i),i}},{key:"getPass",value:function(t){return this.frameGraphPasses.find((function(e){return e.name===t}))}},{key:"compile",value:function(){var t,e=this,n=L(this.passNodes);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.refCount=r.writes.length+(r.hasSideEffect?1:0),r.reads.forEach((function(t){e.resourceNodes[t.index].readerCount++}))}}catch(I){n.e(I)}finally{n.f()}var i,o=[],a=L(this.resourceNodes);try{for(a.s();!(i=a.n()).done;){var u=i.value;0===u.readerCount&&o.push(u)}}catch(I){a.e(I)}finally{a.f()}for(;o.length;){var s=o.pop(),c=s&&s.writer;if(c&&0===--c.refCount){var f,l=L(c.reads);try{for(l.s();!(f=l.n()).done;){var h=f.value,d=this.resourceNodes[h.index];0===--d.readerCount&&o.push(d)}}catch(I){l.e(I)}finally{l.f()}}}this.resourceNodes.forEach((function(t){t.resource.refs+=t.readerCount}));var p,m=L(this.passNodes);try{for(m.s();!(p=m.n()).done;){var v=p.value;if(v.refCount){var g,y=L(v.reads);try{for(y.s();!(g=y.n()).done;){var b=g.value,E=this.resourceNodes[b.index].resource;E.first=E.first?E.first:v,E.last=v}}catch(I){y.e(I)}finally{y.f()}var _,w=L(v.writes);try{for(w.s();!(_=w.n()).done;){var x=_.value,T=this.resourceNodes[x.index].resource;T.first=T.first?T.first:v,T.last=v}}catch(I){w.e(I)}finally{w.f()}}}}catch(I){m.e(I)}finally{m.f()}for(var S=0;S<2;S++){var A,O=L(this.resourceNodes);try{for(O.s();!(A=O.n()).done;){var R=A.value.resource;if(R.priority===S&&R.refs){var C=R.first,M=R.last;C&&M&&(C.devirtualize.push(R),M.destroy.push(R))}}}catch(I){O.e(I)}finally{O.f()}}}},{key:"executePassNodes",value:function(){var t=s()(a.a.mark((function t(e){var n,r,o,u,s,c,f,l,h,d,p,m,v;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=L(this.passNodes.entries()),t.prev=1,n.s();case 3:if((r=n.n()).done){t.next=18;break}if(o=i()(r.value,2),u=o[0],!(s=o[1]).refCount){t.next=16;break}c=L(s.devirtualize);try{for(c.s();!(f=c.n()).done;)f.value.preExecuteDevirtualize(this.engine)}catch(a){c.e(a)}finally{c.f()}l=L(s.destroy);try{for(l.s();!(h=l.n()).done;)h.value.preExecuteDestroy(this.engine)}catch(a){l.e(a)}finally{l.f()}return t.next=12,this.frameGraphPasses[u].execute(this,this.frameGraphPasses[u],e);case 12:d=L(s.devirtualize);try{for(d.s();!(p=d.n()).done;)p.value.postExecuteDevirtualize(this.engine)}catch(a){d.e(a)}finally{d.f()}m=L(s.destroy);try{for(m.s();!(v=m.n()).done;)v.value.postExecuteDestroy(this.engine)}catch(a){m.e(a)}finally{m.f()}case 16:t.next=3;break;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(1),n.e(t.t0);case 23:return t.prev=23,n.f(),t.finish(23);case 26:this.reset();case 27:case"end":return t.stop()}}),t,this,[[1,20,23,26]])})));return function(e){return t.apply(this,arguments)}}()},{key:"reset",value:function(){this.passNodes=[],this.resourceNodes=[],this.frameGraphPasses=[]}},{key:"getResourceNode",value:function(t){return this.resourceNodes[t.index]}},{key:"createResourceNode",value:function(t){var e=new D;e.resource=t,e.version=t.version,this.resourceNodes.push(e);var n=new b;return n.index=this.resourceNodes.length-1,n}},{key:"createTexture",value:function(t,e,n){var r=new j;return r.name=e,r.descriptor=n,this.createResourceNode(r)}},{key:"createRenderTarget",value:function(t,e,n){var r=new j;return r.name=e,r.descriptor=n,this.createResourceNode(r)}},{key:"present",value:function(t){this.addPass("Present",(function(e,n){n.read(t),n.hasSideEffect=!0}),s()(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))))}}]),t}(),N=P,k=v()(N.prototype,"engine",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=N))||I)},1529:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var r=n(250),i=n.n(r),o=n(244),a=n.n(o),u=n(245),s=n.n(u),c=n(530);var f,l=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function h(t){var e={};return{content:t=t.replace(l,(function(t,n,r){var i=r.split(":"),o=i[0].trim(),a="";switch(i.length>1&&(a=i[1].trim()),n){case"bool":a="true"===a;break;case"float":case"int":a=Number(a);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":a=a?a.replace("[","").replace("]","").split(",").reduce((function(t,e){return t.push(Number(e.trim())),t}),[]):new Array(function(t){var e=0;switch(t){case"vec2":case"ivec2":e=2;break;case"vec3":case"ivec3":e=3;break;case"vec4":case"ivec4":case"mat2":e=4;break;case"mat3":e=9;break;case"mat4":e=16}return e}(n)).fill(0)}return e[o]=a,"uniform ".concat(n," ").concat(o,";\n")})),uniforms:e}}function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m=/precision\s+(high|low|medium)p\s+float/,v=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,g=Object(c.injectable)()(f=function(){function t(){a()(this,t),this.moduleCache={},this.rawContentCache={}}return s()(t,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("picking",{vs:"attribute vec3 a_PickingColor;\nvarying vec4 v_PickingResult;\n\nuniform vec3 u_PickingColor : [0, 0, 0];\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\nuniform float u_PickingThreshold : 1.0;\nuniform float u_PickingBuffer: 0.0;\n\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&\n    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&\n    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;\n}\n\nvoid setPickingColor(vec3 pickingColor) {\n  // compares only in highlight stage\n  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));\n\n  // Stores the picking color so that the fragment shader can render it during picking\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\n\nfloat setPickingSize(float x) {\n   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;\n}",fs:"varying vec4 v_PickingResult;\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\n\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 filterHighlightColor(vec4 color) {\n  bool selected = bool(v_PickingResult.a);\n\n  if (selected) {\n    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;\n\n    float highLightAlpha = highLightColor.a;\n    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));\n\n    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);\n    return vec4(resultRGB, color.a);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 filterPickingColor(vec4 color) {\n  vec3 pickingColor = v_PickingResult.rgb;\n  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {\n    discard;\n  }\n  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 filterColor(vec4 color) {\n  return filterPickingColor(filterHighlightColor(color));\n}\n"}),this.registerModule("sdf2d",{vs:"",fs:"/**\n * 2D signed distance field functions\n * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\n */\n\nfloat ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }\n\nfloat sdCircle(vec2 p, float r) {\n  return length(p) - r;\n}\n\nfloat sdEquilateralTriangle(vec2 p) {\n  float k = sqrt(3.0);\n  p.x = abs(p.x) - 1.0;\n  p.y = p.y + 1.0/k;\n  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;\n  p.x -= clamp( p.x, -2.0, 0.0 );\n  return -length(p)*sign(p.y);\n}\n\nfloat sdBox(vec2 p, vec2 b) {\n  vec2 d = abs(p)-b;\n  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);\n}\n\nfloat sdPentagon(vec2 p, float r) {\n  vec3 k = vec3(0.809016994,0.587785252,0.726542528);\n  p.x = abs(p.x);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagon(vec2 p, float r) {\n  vec3 k = vec3(-0.866025404,0.5,0.577350269);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdOctogon(vec2 p, float r) {\n  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );\n  p = abs(p);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagram(vec2 p, float r) {\n  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;\n  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdRhombus(vec2 p, vec2 b) {\n  vec2 q = abs(p);\n  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);\n  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );\n  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );\n}\n\nfloat sdVesica(vec2 p, float r, float d) {\n  p = abs(p);\n  float b = sqrt(r*r-d*d); // can delay this sqrt\n  return ((p.y-b)*d>p.x*b)\n          ? length(p-vec2(0.0,b))\n          : length(p-vec2(-d,0.0))-r;\n}"})}},{key:"registerModule",value:function(t,e){if(!this.rawContentCache[t]){var n=e.vs,r=void 0===n?"":n,i=e.fs,o=void 0===i?"":i,a=e.uniforms,u=h(r),s=u.content,c=u.uniforms,f=h(o),l=f.content,d=f.uniforms;this.rawContentCache[t]={fs:l,uniforms:p(p(p({},c),d),a),vs:s}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(t){var e=this;if(this.moduleCache[t])return this.moduleCache[t];var n,r=this.rawContentCache[t].vs||"",i=this.rawContentCache[t].fs||"",o=this.processModule(r,[],"vs"),a=o.content,u=o.includeList,s=this.processModule(i,[],"fs"),c=s.content,f=s.includeList,l=c,h=(n=u.concat(f).concat(t),n.filter((function(t,e,n){return n.indexOf(t)===e}))).reduce((function(t,n){return p(p({},t),e.rawContentCache[n].uniforms)}),{});return m.test(c)||(l="#ifdef GL_FRAGMENT_PRECISION_HIGH\n precision highp float;\n #else\n precision mediump float;\n#endif\n"+c),this.moduleCache[t]={fs:l.trim(),uniforms:h,vs:a.trim()},this.moduleCache[t]}},{key:"processModule",value:function(t,e,n){var r=this;return{content:t.replace(v,(function(t,i){var o=i.split(" ")[0].replace(/"/g,"");if(e.indexOf(o)>-1)return"";var a=r.rawContentCache[o][n];return e.push(o),r.processModule(a||"",e,n).content})),includeList:e}}}]),t}())||f},1532:function(t,e,n){"use strict";n.d(e,"a",(function(){return R}));var r=n(250),i=n.n(r),o=n(244),a=n.n(o),u=n(245),s=n.n(u),c=n(691),f=n.n(c),l=n(616),h=n.n(l),d=n(617),p=n.n(d),m=n(618),v=n.n(m),g=n(558),y=n(651),b=n(252),E=n.n(b),_=9007199254740991,w={};w["[object Float32Array]"]=w["[object Float64Array]"]=w["[object Int8Array]"]=w["[object Int16Array]"]=w["[object Int32Array]"]=w["[object Uint8Array]"]=w["[object Uint8ClampedArray]"]=w["[object Uint16Array]"]=w["[object Uint32Array]"]=!0,w["[object Arguments]"]=w["[object Array]"]=w["[object ArrayBuffer]"]=w["[object Boolean]"]=w["[object DataView]"]=w["[object Date]"]=w["[object Error]"]=w["[object Function]"]=w["[object Map]"]=w["[object Number]"]=w["[object Object]"]=w["[object RegExp]"]=w["[object Set]"]=w["[object String]"]=w["[object WeakMap]"]=!1;var x=Object.prototype.toString;var T=function(t){return function(t){return!!t&&"object"===E()(t)}(t)&&function(t){return"number"===typeof t&&t>-1&&t%1===0&&t<=_}(t.length)&&!!w[x.call(t)]};function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function O(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v()(t);if(e){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var R=function(t){h()(n,t);var e=O(n);function n(t){var r;return a()(this,n),(r=e.call(this,t)).dirty=!0,r.attributes=[],r.indices=void 0,r.indicesBuffer=void 0,r.vertexCount=0,r.maxInstancedCount=void 0,r.aabb=void 0,r.entity=void 0,Object.assign(f()(r),t),r}return s()(n,[{key:"setAttribute",value:function(t,e,n,r){var i=this.attributes.find((function(e){return e.name===t}));return i?(i.data=e,i.dirty=!0):this.attributes.push(A(A({dirty:!0,name:t,data:e},n),{},{bufferGetter:r})),this.dirty=!0,this}},{key:"setIndex",value:function(t){return this.indices=new Uint32Array(t.buffer?t.buffer:t),this.dirty=!0,this}},{key:"applyMatrix",value:function(t){var e=this.attributes.find((function(t){return"position"===t.name})),n=this.attributes.find((function(t){return"normal"===t.name}));if(e&&(e.dirty=!0,e.data&&e.data.length))for(var r=0;r<e.data.length;r+=3){var i=g.f.fromValues(e.data[r],e.data[r+1],e.data[r+2],1);g.f.transformMat4(i,i,t),T(e.data)?e.data.set([i[0],i[1],i[2]],r):(e.data[r]=i[0],e.data[r+1]=i[1],e.data[r+2]=i[2])}if(n){var o=g.a.normalFromMat4(g.a.create(),t);if(n.data&&n.data.length)for(var a=0;a<n.data.length;a+=3){var u=g.e.fromValues(n.data[a],n.data[a+1],n.data[a+2]);g.e.transformMat3(u,u,o),g.e.normalize(u,u),T(n.data)?n.data.set([u[0],u[1],u[2]],a):(n.data[a]=u[0],n.data[a+1]=u[1],n.data[a+2]=u[2])}}}}]),n}(y.a)},1586:function(t,e){t.exports=function(t){if(Array.isArray(t))return t},t.exports.default=t.exports,t.exports.__esModule=!0},1587:function(t,e){t.exports=function(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,u=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(s){u=!0,i=s}finally{try{a||null==n.return||n.return()}finally{if(u)throw i}}return o}},t.exports.default=t.exports,t.exports.__esModule=!0},1588:function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0},1589:function(t,e){var n=Object.prototype.hasOwnProperty;t.exports=function(t,e){return null!=t&&n.call(t,e)}},1775:function(t,e,n){var r=n(1e3);t.exports=function(t){return r(t,4)}},1888:function(t,e,n){t.exports=n(1889)},1889:function(t,e,n){var r=n(959),i=n(1296),o=n(1890),a=n(585);t.exports=function(t,e){return(a(t)?r:i)(t,o(e))}},1890:function(t,e,n){var r=n(772);t.exports=function(t){return"function"==typeof t?t:r}},1891:function(t,e,n){var r=n(2539),i=n(2564),o=n(687),a=n(585);t.exports=function(t,e){return(a(t)?r:i)(t,o(e,3))}},1892:function(t,e){t.exports=function(t){return void 0===t}},1893:function(t,e,n){var r=n(1367),i=n(687),o=n(1894),a=n(585);t.exports=function(t,e){return(a(t)?r:o)(t,i(e,3))}},1894:function(t,e,n){var r=n(1296),i=n(728);t.exports=function(t,e){var n=-1,o=i(t)?Array(t.length):[];return r(t,(function(t,r,i){o[++n]=e(t,r,i)})),o}},1895:function(t,e,n){var r=n(1880),i=n(1296),o=n(687),a=n(2565),u=n(585);t.exports=function(t,e,n){var s=u(t)?r:a,c=arguments.length<3;return s(t,o(e,4),n,c,i)}},1899:function(t,e,n){var r=n(2581),i=n(723);t.exports=function(t){return null==t?[]:r(t,i(t))}},1900:function(t,e,n){var r=n(679),i=n(1901);t.exports=function(t,e,n,r){return function(t,e,n,r){var o,a,u={},s=new i,c=function(t){var e=t.v!==o?t.v:t.w,r=u[e],i=n(t),c=a.distance+i;if(i<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+i);c<r.distance&&(r.distance=c,r.predecessor=o,s.decrease(e,c))};t.nodes().forEach((function(t){var n=t===e?0:Number.POSITIVE_INFINITY;u[t]={distance:n},s.add(t,n)}));for(;s.size()>0&&(o=s.removeMin(),(a=u[o]).distance!==Number.POSITIVE_INFINITY);)r(o).forEach(c);return u}(t,String(e),n||o,r||function(e){return t.outEdges(e)})};var o=r.constant(1)},1901:function(t,e,n){var r=n(679);function i(){this._arr=[],this._keyIndices={}}t.exports=i,i.prototype.size=function(){return this._arr.length},i.prototype.keys=function(){return this._arr.map((function(t){return t.key}))},i.prototype.has=function(t){return r.has(this._keyIndices,t)},i.prototype.priority=function(t){var e=this._keyIndices[t];if(void 0!==e)return this._arr[e].priority},i.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},i.prototype.add=function(t,e){var n=this._keyIndices;if(t=String(t),!r.has(n,t)){var i=this._arr,o=i.length;return n[t]=o,i.push({key:t,priority:e}),this._decrease(o),!0}return!1},i.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},i.prototype.decrease=function(t,e){var n=this._keyIndices[t];if(e>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[n].priority+" New: "+e);this._arr[n].priority=e,this._decrease(n)},i.prototype._heapify=function(t){var e=this._arr,n=2*t,r=n+1,i=t;n<e.length&&(i=e[n].priority<e[i].priority?n:i,r<e.length&&(i=e[r].priority<e[i].priority?r:i),i!==t&&(this._swap(t,i),this._heapify(i)))},i.prototype._decrease=function(t){for(var e,n=this._arr,r=n[t].priority;0!==t&&!(n[e=t>>1].priority<r);)this._swap(t,e),t=e},i.prototype._swap=function(t,e){var n=this._arr,r=this._keyIndices,i=n[t],o=n[e];n[t]=o,n[e]=i,r[o.key]=t,r[i.key]=e}},1902:function(t,e,n){var r=n(679);t.exports=function(t){var e=0,n=[],i={},o=[];function a(u){var s=i[u]={onStack:!0,lowlink:e,index:e++};if(n.push(u),t.successors(u).forEach((function(t){r.has(i,t)?i[t].onStack&&(s.lowlink=Math.min(s.lowlink,i[t].index)):(a(t),s.lowlink=Math.min(s.lowlink,i[t].lowlink))})),s.lowlink===s.index){var c,f=[];do{c=n.pop(),i[c].onStack=!1,f.push(c)}while(u!==c);o.push(f)}}return t.nodes().forEach((function(t){r.has(i,t)||a(t)})),o}},1903:function(t,e,n){var r=n(679);function i(t){var e={},n={},i=[];if(r.each(t.sinks(),(function a(u){if(r.has(n,u))throw new o;r.has(e,u)||(n[u]=!0,e[u]=!0,r.each(t.predecessors(u),a),delete n[u],i.push(u))})),r.size(e)!==t.nodeCount())throw new o;return i}function o(){}t.exports=i,i.CycleException=o,o.prototype=new Error},1904:function(t,e,n){var r=n(679);function i(t,e,n,o,a,u){r.has(o,e)||(o[e]=!0,n||u.push(e),r.each(a(e),(function(e){i(t,e,n,o,a,u)})),n&&u.push(e))}t.exports=function(t,e,n){r.isArray(e)||(e=[e]);var o=(t.isDirected()?t.successors:t.neighbors).bind(t),a=[],u={};return r.each(e,(function(e){if(!t.hasNode(e))throw new Error("Graph does not have node: "+e);i(t,e,"post"===n,u,o,a)})),a}},1905:function(t,e,n){var r=n(1407),i=1/0;t.exports=function(t){return t?(t=r(t))===i||t===-1/0?17976931348623157e292*(t<0?-1:1):t===t?t:0:0===t?t:0}},1907:function(t,e,n){var r=n(838),i=n(855);t.exports=function(t,e,n){(void 0!==n&&!i(t[e],n)||void 0===n&&!(e in t))&&r(t,e,n)}},1908:function(t,e){t.exports=function(t,e){if(("constructor"!==e||"function"!==typeof t[e])&&"__proto__"!=e)return t[e]}},1909:function(t,e){t.exports=function(t,e){return t<e}},1910:function(t,e,n){"use strict";var r=n(556),i=n(689).Graph,o=n(1298).slack;function a(t,e){return r.forEach(t.nodes(),(function n(i){r.forEach(e.nodeEdges(i),(function(r){var a=r.v,u=i===a?r.w:a;t.hasNode(u)||o(e,r)||(t.setNode(u,{}),t.setEdge(i,u,{}),n(u))}))})),t.nodeCount()}function u(t,e){return r.forEach(t.nodes(),(function n(i){r.forEach(e.nodeEdges(i),(function(r){var a=r.v,u=i===a?r.w:a;t.hasNode(u)||void 0===e.node(u).layer&&o(e,r)||(t.setNode(u,{}),t.setEdge(i,u,{}),n(u))}))})),t.nodeCount()}function s(t,e){return r.minBy(e.edges(),(function(n){if(t.hasNode(n.v)!==t.hasNode(n.w))return o(e,n)}))}function c(t,e,n){r.forEach(t.nodes(),(function(t){e.node(t).rank+=n}))}t.exports={feasibleTree:function(t){var e,n,r=new i({directed:!1}),u=t.nodes()[0],f=t.nodeCount();r.setNode(u,{});for(;a(r,t)<f;)e=s(r,t),n=r.hasNode(e.v)?o(t,e):-o(t,e),c(r,t,n);return r},feasibleTreeWithLayer:function(t){var e,n,r=new i({directed:!1}),a=t.nodes()[0],f=t.nodeCount();r.setNode(a,{});for(;u(r,t)<f;)e=s(r,t),n=r.hasNode(e.v)?o(t,e):-o(t,e),c(r,t,n);return r}}},1911:function(t,e,n){(function(t,e){var n;!function(n){!function(r){var i="object"===typeof e?e:"object"===typeof self?self:"object"===typeof this?this:Function("return this;")(),o=a(n);function a(t,e){return function(n,r){"function"!==typeof t[n]&&Object.defineProperty(t,n,{configurable:!0,writable:!0,value:r}),e&&e(n,r)}}"undefined"===typeof i.Reflect?i.Reflect=n:o=a(i.Reflect,o),function(e){var n=Object.prototype.hasOwnProperty,r="function"===typeof Symbol,i=r&&"undefined"!==typeof Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=r&&"undefined"!==typeof Symbol.iterator?Symbol.iterator:"@@iterator",a="function"===typeof Object.create,u={__proto__:[]}instanceof Array,s=!a&&!u,c={create:a?function(){return it(Object.create(null))}:u?function(){return it({__proto__:null})}:function(){return it({})},has:s?function(t,e){return n.call(t,e)}:function(t,e){return e in t},get:s?function(t,e){return n.call(t,e)?t[e]:void 0}:function(t,e){return t[e]}},f=Object.getPrototypeOf(Function),l="object"===typeof t&&Object({mock:void 0,NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})&&"true"===Object({mock:void 0,NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REFLECT_METADATA_USE_MAP_POLYFILL,h=l||"function"!==typeof Map||"function"!==typeof Map.prototype.entries?et():Map,d=l||"function"!==typeof Set||"function"!==typeof Set.prototype.entries?nt():Set,p=new(l||"function"!==typeof WeakMap?rt():WeakMap);function m(t,e,n,r){if(D(n)){if(!W(t))throw new TypeError;if(!X(e))throw new TypeError;return S(t,e)}if(!W(t))throw new TypeError;if(!F(e))throw new TypeError;if(!F(r)&&!D(r)&&!L(r))throw new TypeError;return L(r)&&(r=void 0),A(t,e,n=H(n),r)}function v(t,e){function n(n,r){if(!F(n))throw new TypeError;if(!D(r)&&!Y(r))throw new TypeError;N(t,e,n,r)}return n}function g(t,e,n,r){if(!F(n))throw new TypeError;return D(r)||(r=H(r)),N(t,e,n,r)}function y(t,e,n){if(!F(e))throw new TypeError;return D(n)||(n=H(n)),R(t,e,n)}function b(t,e,n){if(!F(e))throw new TypeError;return D(n)||(n=H(n)),C(t,e,n)}function E(t,e,n){if(!F(e))throw new TypeError;return D(n)||(n=H(n)),M(t,e,n)}function _(t,e,n){if(!F(e))throw new TypeError;return D(n)||(n=H(n)),I(t,e,n)}function w(t,e){if(!F(t))throw new TypeError;return D(e)||(e=H(e)),k(t,e)}function x(t,e){if(!F(t))throw new TypeError;return D(e)||(e=H(e)),P(t,e)}function T(t,e,n){if(!F(e))throw new TypeError;D(n)||(n=H(n));var r=O(e,n,!1);if(D(r))return!1;if(!r.delete(t))return!1;if(r.size>0)return!0;var i=p.get(e);return i.delete(n),i.size>0||p.delete(e),!0}function S(t,e){for(var n=t.length-1;n>=0;--n){var r=(0,t[n])(e);if(!D(r)&&!L(r)){if(!X(r))throw new TypeError;e=r}}return e}function A(t,e,n,r){for(var i=t.length-1;i>=0;--i){var o=(0,t[i])(e,n,r);if(!D(o)&&!L(o)){if(!F(o))throw new TypeError;r=o}}return r}function O(t,e,n){var r=p.get(t);if(D(r)){if(!n)return;r=new h,p.set(t,r)}var i=r.get(e);if(D(i)){if(!n)return;i=new h,r.set(e,i)}return i}function R(t,e,n){if(C(t,e,n))return!0;var r=tt(e);return!L(r)&&R(t,r,n)}function C(t,e,n){var r=O(e,n,!1);return!D(r)&&V(r.has(t))}function M(t,e,n){if(C(t,e,n))return I(t,e,n);var r=tt(e);return L(r)?void 0:M(t,r,n)}function I(t,e,n){var r=O(e,n,!1);if(!D(r))return r.get(t)}function N(t,e,n,r){O(n,r,!0).set(t,e)}function k(t,e){var n=P(t,e),r=tt(t);if(null===r)return n;var i=k(r,e);if(i.length<=0)return n;if(n.length<=0)return i;for(var o=new d,a=[],u=0,s=n;u<s.length;u++){var c=s[u];o.has(c)||(o.add(c),a.push(c))}for(var f=0,l=i;f<l.length;f++){c=l[f];o.has(c)||(o.add(c),a.push(c))}return a}function P(t,e){var n=[],r=O(t,e,!1);if(D(r))return n;for(var i=Q(r.keys()),o=0;;){var a=J(i);if(!a)return n.length=o,n;var u=Z(a);try{n[o]=u}catch(s){try{$(i)}finally{throw s}}o++}}function j(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function D(t){return void 0===t}function L(t){return null===t}function B(t){return"symbol"===typeof t}function F(t){return"object"===typeof t?null!==t:"function"===typeof t}function U(t,e){switch(j(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===e?"string":5===e?"number":"default",r=K(t,i);if(void 0!==r){var o=r.call(t,n);if(F(o))throw new TypeError;return o}return G(t,"default"===n?"number":n)}function G(t,e){if("string"===e){var n=t.toString;if(q(n))if(!F(i=n.call(t)))return i;if(q(r=t.valueOf))if(!F(i=r.call(t)))return i}else{var r;if(q(r=t.valueOf))if(!F(i=r.call(t)))return i;var i,o=t.toString;if(q(o))if(!F(i=o.call(t)))return i}throw new TypeError}function V(t){return!!t}function z(t){return""+t}function H(t){var e=U(t,3);return B(e)?e:z(e)}function W(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function q(t){return"function"===typeof t}function X(t){return"function"===typeof t}function Y(t){switch(j(t)){case 3:case 4:return!0;default:return!1}}function K(t,e){var n=t[e];if(void 0!==n&&null!==n){if(!q(n))throw new TypeError;return n}}function Q(t){var e=K(t,o);if(!q(e))throw new TypeError;var n=e.call(t);if(!F(n))throw new TypeError;return n}function Z(t){return t.value}function J(t){var e=t.next();return!e.done&&e}function $(t){var e=t.return;e&&e.call(t)}function tt(t){var e=Object.getPrototypeOf(t);if("function"!==typeof t||t===f)return e;if(e!==f)return e;var n=t.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return e;var i=r.constructor;return"function"!==typeof i||i===t?e:i}function et(){var t={},e=[],n=function(){function t(t,e,n){this._index=0,this._keys=t,this._values=e,this._selector=n}return t.prototype["@@iterator"]=function(){return this},t.prototype[o]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var n=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var n=this._find(t,!0);return this._values[n]=e,this},e.prototype.delete=function(e){var n=this._find(e,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new n(this._keys,this._values,r)},e.prototype.values=function(){return new n(this._keys,this._values,i)},e.prototype.entries=function(){return new n(this._keys,this._values,a)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[o]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function r(t,e){return t}function i(t,e){return e}function a(t,e){return[t,e]}}function nt(){return function(){function t(){this._map=new h}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[o]=function(){return this.keys()},t}()}function rt(){var t=16,e=c.create(),r=i();return function(){function t(){this._key=i()}return t.prototype.has=function(t){var e=o(t,!1);return void 0!==e&&c.has(e,this._key)},t.prototype.get=function(t){var e=o(t,!1);return void 0!==e?c.get(e,this._key):void 0},t.prototype.set=function(t,e){return o(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=o(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=i()},t}();function i(){var t;do{t="@@WeakMap@@"+s()}while(c.has(e,t));return e[t]=!0,t}function o(t,e){if(!n.call(t,r)){if(!e)return;Object.defineProperty(t,r,{value:c.create()})}return t[r]}function a(t,e){for(var n=0;n<e;++n)t[n]=255*Math.random()|0;return t}function u(t){return"function"===typeof Uint8Array?"undefined"!==typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!==typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):a(new Uint8Array(t),t):a(new Array(t),t)}function s(){var e=u(t);e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var n="",r=0;r<t;++r){var i=e[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}function it(t){return t.__=void 0,delete t.__,t}e("decorate",m),e("metadata",v),e("defineMetadata",g),e("hasMetadata",y),e("hasOwnMetadata",b),e("getMetadata",E),e("getOwnMetadata",_),e("getMetadataKeys",w),e("getOwnMetadataKeys",x),e("deleteMetadata",T)}(o)}()}(n||(n={}))}).call(this,n(322),n(248))},1912:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MetadataReader=void 0;var r=n(601),i=function(){function t(){}return t.prototype.getConstructorMetadata=function(t){return{compilerGeneratedMetadata:Reflect.getMetadata(r.PARAM_TYPES,t),userGeneratedMetadata:Reflect.getMetadata(r.TAGGED,t)||{}}},t.prototype.getPropertiesMetadata=function(t){return Reflect.getMetadata(r.TAGGED_PROP,t)||[]},t}();e.MetadataReader=i},1913:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isStackOverflowExeption=void 0;var r=n(652);e.isStackOverflowExeption=function(t){return t instanceof RangeError||t.message===r.STACK_OVERFLOW}},1914:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.inject=e.LazyServiceIdentifer=void 0;var r=n(652),i=n(601),o=n(690),a=n(781),u=function(){function t(t){this._cb=t}return t.prototype.unwrap=function(){return this._cb()},t}();e.LazyServiceIdentifer=u,e.inject=function(t){return function(e,n,u){if(void 0===t)throw new Error(r.UNDEFINED_INJECT_ANNOTATION(e.name));var s=new o.Metadata(i.INJECT_TAG,t);"number"===typeof u?a.tagParameter(e,n,u,s):a.tagProperty(e,n,s)}}},1915:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Target=void 0;var r=n(601),i=n(829),o=n(690),a=n(2654),u=function(){function t(t,e,n,u){this.id=i.id(),this.type=t,this.serviceIdentifier=n,this.name=new a.QueryableString(e||""),this.metadata=new Array;var s=null;"string"===typeof u?s=new o.Metadata(r.NAMED_TAG,u):u instanceof o.Metadata&&(s=u),null!==s&&this.metadata.push(s)}return t.prototype.hasTag=function(t){for(var e=0,n=this.metadata;e<n.length;e++){if(n[e].key===t)return!0}return!1},t.prototype.isArray=function(){return this.hasTag(r.MULTI_INJECT_TAG)},t.prototype.matchesArray=function(t){return this.matchesTag(r.MULTI_INJECT_TAG)(t)},t.prototype.isNamed=function(){return this.hasTag(r.NAMED_TAG)},t.prototype.isTagged=function(){return this.metadata.some((function(t){return r.NON_CUSTOM_TAG_KEYS.every((function(e){return t.key!==e}))}))},t.prototype.isOptional=function(){return this.matchesTag(r.OPTIONAL_TAG)(!0)},t.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(t){return t.key===r.NAMED_TAG}))[0]:null},t.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(t){return r.NON_CUSTOM_TAG_KEYS.every((function(e){return t.key!==e}))})):null},t.prototype.matchesNamedTag=function(t){return this.matchesTag(r.NAMED_TAG)(t)},t.prototype.matchesTag=function(t){var e=this;return function(n){for(var r=0,i=e.metadata;r<i.length;r++){var o=i[r];if(o.key===t&&o.value===n)return!0}return!1}},t}();e.Target=u},1916:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BindingWhenOnSyntax=void 0;var r=n(1447),i=n(1448),o=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new i.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new r.BindingOnSyntax(this._binding)}return t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}();e.BindingWhenOnSyntax=o},1917:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.typeConstraint=e.namedConstraint=e.taggedConstraint=e.traverseAncerstors=void 0;var r=n(601),i=n(690);e.traverseAncerstors=function t(e,n){var r=e.parentRequest;return null!==r&&(!!n(r)||t(r,n))};var o=function(t){return function(e){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(t)(e)};return n.metaData=new i.Metadata(t,e),n}};e.taggedConstraint=o;var a=o(r.NAMED_TAG);e.namedConstraint=a;e.typeConstraint=function(t){return function(e){var n=null;if(null!==e){if(n=e.bindings[0],"string"===typeof t)return n.serviceIdentifier===t;var r=e.bindings[0].implementationType;return t===r}return!1}}},1918:function(t,e,n){"use strict";n.d(e,"a",(function(){return A}));var r,i,o,a,u,s,c,f,l,h=n(587),d=n.n(h),p=n(588),m=n.n(p),v=n(562),g=n.n(v),y=n(244),b=n.n(y),E=n(563),_=n.n(E),w=(n(564),n(530)),x=n(653),T=n(878),S=n(1301),A=(r=Object(w.injectable)(),i=Object(w.inject)(x.a.RenderEngine),o=Object(w.inject)(x.a.ResourcePool),r((l=f=function t(){var e=this;b()(this,t),g()(this,"engine",s,this),g()(this,"resourcePool",c,this),this.model=void 0,this.setup=function(t,e,n){var r=t.getPass(S.a.IDENTIFIER);if(r){var i=t.createRenderTarget(e,"render to screen",{width:1,height:1});n.data={input:e.read(r.data.output),output:e.write(t,i)}}},this.execute=function(){var t=m()(d.a.mark((function t(n,r){var i,o,a,u,s,c,f;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.engine,o=i.createModel,a=i.createAttribute,u=i.createBuffer,e.model){t.next=6;break}return t.next=4,o({vs:e.engine.supportWebGPU?"layout(location = 0) in vec2 a_Position;\nlayout(location = 0) out vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}":"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:e.engine.supportWebGPU?"layout(set = 0, binding = 0) uniform sampler u_TextureSampler;\nlayout(set = 0, binding = 1) uniform texture2D u_Texture;\n\nlayout(location = 0) in vec2 v_UV;\nlayout(location = 0) out vec4 outColor;\n\nvoid main() {\n  outColor = texture(sampler2D(u_Texture, u_TextureSampler), v_UV);\n}":"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}",attributes:{a_Position:a({buffer:u({data:[-4,-4,4,-4,0,4],type:T.a.FLOAT}),size:2,arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]})},uniforms:{u_Texture:null},depth:{enable:!1},count:3,blend:{enable:!0}});case 4:s=t.sent,e.model=s;case 6:c=n.getResourceNode(r.data.input),f=e.resourcePool.getOrCreateResource(c.resource),e.engine.useFramebuffer(null,(function(){e.engine.clear({framebuffer:null,color:[0,0,0,0],depth:1,stencil:0}),e.model.draw({uniforms:{u_Texture:f}})}));case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),this.tearDown=function(){e.model=void 0}},f.IDENTIFIER="Copy Pass",u=l,s=_()(u.prototype,"engine",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=_()(u.prototype,"resourcePool",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=u))||a)},1919:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(558),i=n(1299);function o(t){for(var e=new i.a,n=r.e.fromValues(t[0],t[1],t[2]),o=r.e.fromValues(t[0],t[1],t[2]),a=3;a<t.length;){var u=t[a++],s=t[a++],c=t[a++];u<n[0]&&(n[0]=u),s<n[1]&&(n[1]=s),c<n[2]&&(n[2]=c),u>o[0]&&(o[0]=u),s>o[1]&&(o[1]=s),c>o[2]&&(o[2]=c)}return e.setMinMax(n,o),e}},1920:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r="undefined"!==typeof navigator&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent)},1921:function(t,e){},1922:function(t,e){},1923:function(t,e){},1924:function(t,e){},1925:function(t,e){},1926:function(t,e){},1927:function(t,e,n){"use strict";var r;!function(t){t.Normal="normal",t.PostProcessing="post-processing"}(r||(r={}))},1928:function(t,e){},1929:function(t,e){},1930:function(t,e){},1931:function(t,e){},1932:function(t,e){},1933:function(t,e){},1934:function(t,e){t.exports=1e-6},1935:function(t,e){t.exports=function(){var t=new Float32Array(2);return t[0]=0,t[1]=0,t}},1936:function(t,e){t.exports=function(t,e,n){return t[0]=e,t[1]=n,t}},1937:function(t,e){t.exports=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}},1938:function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}},1939:function(t,e){t.exports=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}},1940:function(t,e){t.exports=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}},1941:function(t,e){t.exports=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}},1942:function(t,e){t.exports=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}},1943:function(t,e){t.exports=function(t){var e=t[0],n=t[1];return e*e+n*n}},1944:function(t,e){t.exports=function(t,e){var n=e[0],r=e[1],i=n*n+r*r;i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i);return t}},1945:function(t,e){t.exports=function(t,e){return t[0]*e[0]+t[1]*e[1]}},1949:function(t,e,n){"use strict";var r=n(79);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(80)),o=n(0),a=(0,i.default)((0,o.jsx)("path",{d:"M9.4 16.6 4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0 4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"}),"Code");e.default=a},1961:function(t,e,n){"use strict";n(1461),n(1462),n(1529)},1965:function(t,e,n){"use strict";n.d(e,"a",(function(){return r.a})),n.d(e,"b",(function(){return o.a}));var r=n(1299),i=(n(244),n(245),n(558)),o=(i.e.create(),n(1455));n(1456),i.e.create(),i.e.create(),i.e.create(),i.e.create(),i.e.create()},1969:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return a}));var r=n(948),i=n.n(r);n(558);function o(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function a(t){var e=i()(t,3);return e[0]+256*e[1]+65536*e[2]-1}},2008:function(t,e,n){var r=n(790),i=n(1014),o=n(1332),a=n(608),u=n(857);t.exports=function(t,e,n,s){if(!a(t))return t;for(var c=-1,f=(e=i(e,t)).length,l=f-1,h=t;null!=h&&++c<f;){var d=u(e[c]),p=n;if("__proto__"===d||"constructor"===d||"prototype"===d)return t;if(c!=l){var m=h[d];void 0===(p=s?s(m,d,h):void 0)&&(p=a(m)?m:o(e[c+1])?[]:{})}r(h,d,p),h=h[d]}return t}},2009:function(t,e,n){"use strict";var r=n(79);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(80)),o=n(0),a=(0,i.default)((0,o.jsx)("path",{fillRule:"evenodd",d:"M4 11h16v2H4z"}),"HorizontalRule");e.default=a},2560:function(t,e,n){t.exports={graphlib:n(689),layout:n(2593),debug:n(2645),util:{time:n(643).time,notime:n(643).notime},version:n(2646)}},2561:function(t,e,n){var r=n(2562);t.exports={Graph:r.Graph,json:n(2583),alg:n(2584),version:r.version}},2562:function(t,e,n){t.exports={Graph:n(1443),version:n(2582)}},2563:function(t,e,n){var r=n(728);t.exports=function(t,e){return function(n,i){if(null==n)return n;if(!r(n))return t(n,i);for(var o=n.length,a=e?o:-1,u=Object(n);(e?a--:++a<o)&&!1!==i(u[a],a,u););return n}}},2564:function(t,e,n){var r=n(1296);t.exports=function(t,e){var n=[];return r(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n}},2565:function(t,e){t.exports=function(t,e,n,r,i){return i(t,(function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)})),n}},2566:function(t,e,n){var r=n(1536),i=n(724),o=n(728),a=n(2567),u=n(2568);t.exports=function(t){if(null==t)return 0;if(o(t))return a(t)?u(t):t.length;var e=i(t);return"[object Map]"==e||"[object Set]"==e?t.size:r(t).length}},2567:function(t,e,n){var r=n(1410),i=n(585),o=n(730);t.exports=function(t){return"string"==typeof t||!i(t)&&o(t)&&"[object String]"==r(t)}},2568:function(t,e,n){var r=n(2569),i=n(1336),o=n(2570);t.exports=function(t){return i(t)?o(t):r(t)}},2569:function(t,e,n){var r=n(1370)("length");t.exports=r},2570:function(t,e){var n="[\\ud800-\\udfff]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",o="[^\\ud800-\\udfff]",a="(?:\\ud83c[\\udde6-\\uddff]){2}",u="[\\ud800-\\udbff][\\udc00-\\udfff]",s="(?:"+r+"|"+i+")"+"?",c="[\\ufe0e\\ufe0f]?",f=c+s+("(?:\\u200d(?:"+[o,a,u].join("|")+")"+c+s+")*"),l="(?:"+[o+r+"?",r,a,u,n].join("|")+")",h=RegExp(i+"(?="+i+")|"+l+f,"g");t.exports=function(t){for(var e=h.lastIndex=0;h.test(t);)++e;return e}},2571:function(t,e,n){var r=n(959),i=n(1247),o=n(964),a=n(687),u=n(823),s=n(585),c=n(791),f=n(1414),l=n(608),h=n(944);t.exports=function(t,e,n){var d=s(t),p=d||c(t)||h(t);if(e=a(e,4),null==n){var m=t&&t.constructor;n=p?d?new m:[]:l(t)&&f(m)?i(u(t)):{}}return(p?r:o)(t,(function(t,r,i){return e(n,t,r,i)})),n}},2572:function(t,e,n){var r=n(1375),i=n(1021),o=n(2116),a=n(1776),u=i((function(t){return o(r(t,1,a,!0))}));t.exports=u},2581:function(t,e,n){var r=n(1367);t.exports=function(t,e){return r(e,(function(e){return t[e]}))}},2582:function(t,e){t.exports="2.1.8"},2583:function(t,e,n){var r=n(679),i=n(1443);function o(t){return r.map(t.nodes(),(function(e){var n=t.node(e),i=t.parent(e),o={v:e};return r.isUndefined(n)||(o.value=n),r.isUndefined(i)||(o.parent=i),o}))}function a(t){return r.map(t.edges(),(function(e){var n=t.edge(e),i={v:e.v,w:e.w};return r.isUndefined(e.name)||(i.name=e.name),r.isUndefined(n)||(i.value=n),i}))}t.exports={write:function(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:o(t),edges:a(t)};r.isUndefined(t.graph())||(e.value=r.clone(t.graph()));return e},read:function(t){var e=new i(t.options).setGraph(t.value);return r.each(t.nodes,(function(t){e.setNode(t.v,t.value),t.parent&&e.setParent(t.v,t.parent)})),r.each(t.edges,(function(t){e.setEdge({v:t.v,w:t.w,name:t.name},t.value)})),e}}},2584:function(t,e,n){t.exports={components:n(2585),dijkstra:n(1900),dijkstraAll:n(2586),findCycles:n(2587),floydWarshall:n(2588),isAcyclic:n(2589),postorder:n(2590),preorder:n(2591),prim:n(2592),tarjan:n(1902),topsort:n(1903)}},2585:function(t,e,n){var r=n(679);t.exports=function(t){var e,n={},i=[];function o(i){r.has(n,i)||(n[i]=!0,e.push(i),r.each(t.successors(i),o),r.each(t.predecessors(i),o))}return r.each(t.nodes(),(function(t){e=[],o(t),e.length&&i.push(e)})),i}},2586:function(t,e,n){var r=n(1900),i=n(679);t.exports=function(t,e,n){return i.transform(t.nodes(),(function(i,o){i[o]=r(t,o,e,n)}),{})}},2587:function(t,e,n){var r=n(679),i=n(1902);t.exports=function(t){return r.filter(i(t),(function(e){return e.length>1||1===e.length&&t.hasEdge(e[0],e[0])}))}},2588:function(t,e,n){var r=n(679);t.exports=function(t,e,n){return function(t,e,n){var r={},i=t.nodes();return i.forEach((function(t){r[t]={},r[t][t]={distance:0},i.forEach((function(e){t!==e&&(r[t][e]={distance:Number.POSITIVE_INFINITY})})),n(t).forEach((function(n){var i=n.v===t?n.w:n.v,o=e(n);r[t][i]={distance:o,predecessor:t}}))})),i.forEach((function(t){var e=r[t];i.forEach((function(n){var o=r[n];i.forEach((function(n){var r=o[t],i=e[n],a=o[n],u=r.distance+i.distance;u<a.distance&&(a.distance=u,a.predecessor=i.predecessor)}))}))})),r}(t,e||i,n||function(e){return t.outEdges(e)})};var i=r.constant(1)},2589:function(t,e,n){var r=n(1903);t.exports=function(t){try{r(t)}catch(e){if(e instanceof r.CycleException)return!1;throw e}return!0}},2590:function(t,e,n){var r=n(1904);t.exports=function(t,e){return r(t,e,"post")}},2591:function(t,e,n){var r=n(1904);t.exports=function(t,e){return r(t,e,"pre")}},2592:function(t,e,n){var r=n(679),i=n(1443),o=n(1901);t.exports=function(t,e){var n,a=new i,u={},s=new o;function c(t){var r=t.v===n?t.w:t.v,i=s.priority(r);if(void 0!==i){var o=e(t);o<i&&(u[r]=n,s.decrease(r,o))}}if(0===t.nodeCount())return a;r.each(t.nodes(),(function(t){s.add(t,Number.POSITIVE_INFINITY),a.setNode(t)})),s.decrease(t.nodes()[0],0);var f=!1;for(;s.size()>0;){if(n=s.removeMin(),r.has(u,n))a.setEdge(n,u[n]);else{if(f)throw new Error("Input graph is not connected: "+t);f=!0}t.nodeEdges(n).forEach(c)}return a}},2593:function(t,e,n){"use strict";var r=n(556),i=n(2623),o=n(2626),a=n(2627),u=n(643).normalizeRanks,s=n(2629),c=n(643).removeEmptyRanks,f=n(2630),l=n(2631),h=n(2632),d=n(2633),p=n(2642),m=n(643),v=n(689).Graph,g=n(2644);t.exports=function(t,e){var n=e&&e.debugTiming?m.time:m.notime;n("layout",(function(){e&&!e.keepNodeOrder&&e.prevGraph&&n("  inheritOrder",(function(){!function(t,e){var n=e._nodes;r.forEach(t.nodes(),(function(e){var r=t.node(e);void 0!==n[e]?(r.fixorder=n[e]._order,delete n[e]._order):delete r.fixorder}))}(t,e.prevGraph)}));var R=n("  buildLayoutGraph",(function(){return function(t){var e=new v({multigraph:!0,compound:!0}),n=O(t.graph());return e.setGraph(r.merge({},b,A(n,y),r.pick(n,E))),r.forEach(t.nodes(),(function(n){var i=O(t.node(n));e.setNode(n,r.defaults(A(i,_),w)),e.setParent(n,t.parent(n))})),r.forEach(t.edges(),(function(n){var i=O(t.edge(n));e.setEdge(n,r.merge({},T,A(i,x),r.pick(i,S)))})),e}(t)}));e&&!1===e.edgeLabelSpace||n("  makeSpaceForEdgeLabels",(function(){!function(t){var e=t.graph();e.ranksep/=2,r.forEach(t.nodes(),(function(e){var n=t.node(e);isNaN(n.layer)||(n.layer*=2)})),r.forEach(t.edges(),(function(n){var r=t.edge(n);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===e.rankdir||"BT"===e.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)}))}(R)}));try{n("  runLayout",(function(){!function(t,e,n){e("    removeSelfEdges",(function(){!function(t){r.forEach(t.edges(),(function(e){if(e.v===e.w){var n=t.node(e.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:e,label:t.edge(e)}),t.removeEdge(e)}}))}(t)})),e("    acyclic",(function(){i.run(t)})),e("    nestingGraph.run",(function(){f.run(t)})),e("    rank",(function(){a(m.asNonCompoundGraph(t))})),e("    injectEdgeLabelProxies",(function(){!function(t){r.forEach(t.edges(),(function(e){var n=t.edge(e);if(n.width&&n.height){var r=t.node(e.v),i={rank:(t.node(e.w).rank-r.rank)/2+r.rank,e:e};m.addDummyNode(t,"edge-proxy",i,"_ep")}}))}(t)})),e("    removeEmptyRanks",(function(){c(t)})),e("    nestingGraph.cleanup",(function(){f.cleanup(t)})),e("    normalizeRanks",(function(){u(t)})),e("    assignRankMinMax",(function(){!function(t){var e=0;r.forEach(t.nodes(),(function(n){var i=t.node(n);i.borderTop&&(i.minRank=t.node(i.borderTop).rank,i.maxRank=t.node(i.borderBottom).rank,e=r.max(e,i.maxRank))})),t.graph().maxRank=e}(t)})),e("    removeEdgeLabelProxies",(function(){!function(t){r.forEach(t.nodes(),(function(e){var n=t.node(e);"edge-proxy"===n.dummy&&(t.edge(n.e).labelRank=n.rank,t.removeNode(e))}))}(t)})),e("    normalize.run",(function(){o.run(t)})),e("    parentDummyChains",(function(){s(t)})),e("    addBorderSegments",(function(){l(t)})),n&&n.keepNodeOrder&&e("    initDataOrder",(function(){g(t,n.nodeOrder)}));e("    order",(function(){d(t)})),e("    insertSelfEdges",(function(){!function(t){var e=m.buildLayerMatrix(t);r.forEach(e,(function(e){var n=0;r.forEach(e,(function(e,i){var o=t.node(e);o.order=i+n,r.forEach(o.selfEdges,(function(e){m.addDummyNode(t,"selfedge",{width:e.label.width,height:e.label.height,rank:o.rank,order:i+ ++n,e:e.e,label:e.label},"_se")})),delete o.selfEdges}))}))}(t)})),e("    adjustCoordinateSystem",(function(){h.adjust(t)})),e("    position",(function(){p(t)})),e("    positionSelfEdges",(function(){!function(t){r.forEach(t.nodes(),(function(e){var n=t.node(e);if("selfedge"===n.dummy){var r=t.node(n.e.v),i=r.x+r.width/2,o=r.y,a=n.x-i,u=r.height/2;t.setEdge(n.e,n.label),t.removeNode(e),n.label.points=[{x:i+2*a/3,y:o-u},{x:i+5*a/6,y:o-u},{x:i+a,y:o},{x:i+5*a/6,y:o+u},{x:i+2*a/3,y:o+u}],n.label.x=n.x,n.label.y=n.y}}))}(t)})),e("    removeBorderNodes",(function(){!function(t){r.forEach(t.nodes(),(function(e){if(t.children(e).length){var n=t.node(e),i=t.node(n.borderTop),o=t.node(n.borderBottom),a=t.node(r.last(n.borderLeft)),u=t.node(r.last(n.borderRight));n.width=Math.abs(u.x-a.x),n.height=Math.abs(o.y-i.y),n.x=a.x+n.width/2,n.y=i.y+n.height/2}})),r.forEach(t.nodes(),(function(e){"border"===t.node(e).dummy&&t.removeNode(e)}))}(t)})),e("    normalize.undo",(function(){o.undo(t)})),e("    fixupEdgeLabelCoords",(function(){!function(t){r.forEach(t.edges(),(function(e){var n=t.edge(e);if(r.has(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}))}(t)})),e("    undoCoordinateSystem",(function(){h.undo(t)})),e("    translateGraph",(function(){!function(t){var e=Number.POSITIVE_INFINITY,n=0,i=Number.POSITIVE_INFINITY,o=0,a=t.graph(),u=a.marginx||0,s=a.marginy||0;function c(t){var r=t.x,a=t.y,u=t.width,s=t.height;e=Math.min(e,r-u/2),n=Math.max(n,r+u/2),i=Math.min(i,a-s/2),o=Math.max(o,a+s/2)}r.forEach(t.nodes(),(function(e){c(t.node(e))})),r.forEach(t.edges(),(function(e){var n=t.edge(e);r.has(n,"x")&&c(n)})),e-=u,i-=s,r.forEach(t.nodes(),(function(n){var r=t.node(n);r.x-=e,r.y-=i})),r.forEach(t.edges(),(function(n){var o=t.edge(n);r.forEach(o.points,(function(t){t.x-=e,t.y-=i})),r.has(o,"x")&&(o.x-=e),r.has(o,"y")&&(o.y-=i)})),a.width=n-e+u,a.height=o-i+s}(t)})),e("    assignNodeIntersects",(function(){!function(t){r.forEach(t.edges(),(function(e){var n,r,i=t.edge(e),o=t.node(e.v),a=t.node(e.w);i.points?(n=i.points[0],r=i.points[i.points.length-1]):(i.points=[],n=a,r=o),i.points.unshift(m.intersectRect(o,n)),i.points.push(m.intersectRect(a,r))}))}(t)})),e("    reversePoints",(function(){!function(t){r.forEach(t.edges(),(function(e){var n=t.edge(e);n.reversed&&n.points.reverse()}))}(t)})),e("    acyclic.undo",(function(){i.undo(t)}))}(R,n,e)}))}catch(C){if("Not possible to find intersection inside of the rectangle"===C.message)return;throw C}n("  updateInputGraph",(function(){!function(t,e){r.forEach(t.nodes(),(function(n){var r=t.node(n),i=e.node(n);r&&(r.x=i.x,r.y=i.y,r._order=i.order,r._rank=i.rank,e.children(n).length&&(r.width=i.width,r.height=i.height))})),r.forEach(t.edges(),(function(n){var i=t.edge(n),o=e.edge(n);i.points=o.points,r.has(o,"x")&&(i.x=o.x,i.y=o.y)})),t.graph().width=e.graph().width,t.graph().height=e.graph().height}(t,R)}))}))};var y=["nodesep","edgesep","ranksep","marginx","marginy"],b={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},E=["acyclicer","ranker","rankdir","align"],_=["width","height","layer","fixorder"],w={width:0,height:0},x=["minlen","weight","width","height","labeloffset"],T={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},S=["labelpos"];function A(t,e){return r.mapValues(r.pick(t,e),Number)}function O(t){var e={};return r.forEach(t,(function(t,n){e[n.toLowerCase()]=t})),e}},2594:function(t,e,n){var r=n(1021),i=n(855),o=n(1297),a=n(686),u=Object.prototype,s=u.hasOwnProperty,c=r((function(t,e){t=Object(t);var n=-1,r=e.length,c=r>2?e[2]:void 0;for(c&&o(e[0],e[1],c)&&(r=1);++n<r;)for(var f=e[n],l=a(f),h=-1,d=l.length;++h<d;){var p=l[h],m=t[p];(void 0===m||i(m,u[p])&&!s.call(t,p))&&(t[p]=f[p])}return t}));t.exports=c},2595:function(t,e,n){var r=n(2596)(n(2597));t.exports=r},2596:function(t,e,n){var r=n(687),i=n(728),o=n(723);t.exports=function(t){return function(e,n,a){var u=Object(e);if(!i(e)){var s=r(n,3);e=o(e),n=function(t){return s(u[t],t,u)}}var c=t(e,n,a);return c>-1?u[s?e[c]:c]:void 0}}},2597:function(t,e,n){var r=n(1898),i=n(687),o=n(2598),a=Math.max;t.exports=function(t,e,n){var u=null==t?0:t.length;if(!u)return-1;var s=null==n?0:o(n);return s<0&&(s=a(u+s,0)),r(t,i(e,3),s)}},2598:function(t,e,n){var r=n(1905);t.exports=function(t){var e=r(t),n=e%1;return e===e?n?e-n:e:0}},2599:function(t,e,n){var r=n(1017),i=n(1890),o=n(686);t.exports=function(t,e){return null==t?t:r(t,i(e),o)}},2600:function(t,e,n){var r=n(1445),i=n(2601),o=n(772);t.exports=function(t){return t&&t.length?r(t,o,i):void 0}},2601:function(t,e){t.exports=function(t,e){return t>e}},2602:function(t,e,n){var r=n(2603),i=n(2606)((function(t,e,n){r(t,e,n)}));t.exports=i},2603:function(t,e,n){var r=n(897),i=n(1907),o=n(1017),a=n(2604),u=n(608),s=n(686),c=n(1908);t.exports=function t(e,n,f,l,h){e!==n&&o(n,(function(o,s){if(h||(h=new r),u(o))a(e,n,s,f,t,l,h);else{var d=l?l(c(e,s),o,s+"",e,n,h):void 0;void 0===d&&(d=o),i(e,s,d)}}),s)}},2604:function(t,e,n){var r=n(1907),i=n(1243),o=n(1245),a=n(1244),u=n(1246),s=n(943),c=n(585),f=n(1776),l=n(791),h=n(1414),d=n(608),p=n(2121),m=n(944),v=n(1908),g=n(2605);t.exports=function(t,e,n,y,b,E,_){var w=v(t,n),x=v(e,n),T=_.get(x);if(T)r(t,n,T);else{var S=E?E(w,x,n+"",t,e,_):void 0,A=void 0===S;if(A){var O=c(x),R=!O&&l(x),C=!O&&!R&&m(x);S=x,O||R||C?c(w)?S=w:f(w)?S=a(w):R?(A=!1,S=i(x,!0)):C?(A=!1,S=o(x,!0)):S=[]:p(x)||s(x)?(S=w,s(w)?S=g(w):d(w)&&!h(w)||(S=u(x))):A=!1}A&&(_.set(x,S),b(S,x,y,E,_),_.delete(x)),r(t,n,S)}}},2605:function(t,e,n){var r=n(715),i=n(686);t.exports=function(t){return r(t,i(t))}},2606:function(t,e,n){var r=n(1021),i=n(1297);t.exports=function(t){return r((function(e,n){var r=-1,o=n.length,a=o>1?n[o-1]:void 0,u=o>2?n[2]:void 0;for(a=t.length>3&&"function"==typeof a?(o--,a):void 0,u&&i(n[0],n[1],u)&&(a=o<3?void 0:a,o=1),e=Object(e);++r<o;){var s=n[r];s&&t(e,s,r,a)}return e}))}},2607:function(t,e,n){var r=n(1445),i=n(1909),o=n(772);t.exports=function(t){return t&&t.length?r(t,o,i):void 0}},2608:function(t,e,n){var r=n(1445),i=n(687),o=n(1909);t.exports=function(t,e){return t&&t.length?r(t,i(e,2),o):void 0}},2609:function(t,e,n){var r=n(2610),i=n(2122)((function(t,e){return null==t?{}:r(t,e)}));t.exports=i},2610:function(t,e,n){var r=n(2611),i=n(1369);t.exports=function(t,e){return r(t,e,(function(e,n){return i(t,n)}))}},2611:function(t,e,n){var r=n(1335),i=n(2008),o=n(1014);t.exports=function(t,e,n){for(var a=-1,u=e.length,s={};++a<u;){var c=e[a],f=r(t,c);n(f,c)&&i(s,o(c,t),f)}return s}},2612:function(t,e,n){var r=n(2613)();t.exports=r},2613:function(t,e,n){var r=n(2614),i=n(1297),o=n(1905);t.exports=function(t){return function(e,n,a){return a&&"number"!=typeof a&&i(e,n,a)&&(n=a=void 0),e=o(e),void 0===n?(n=e,e=0):n=o(n),a=void 0===a?e<n?1:-1:o(a),r(e,n,a,t)}}},2614:function(t,e){var n=Math.ceil,r=Math.max;t.exports=function(t,e,i,o){for(var a=-1,u=r(n((e-t)/(i||1)),0),s=Array(u);u--;)s[o?u:++a]=t,t+=i;return s}},2615:function(t,e,n){var r=n(1375),i=n(2616),o=n(1021),a=n(1297),u=o((function(t,e){if(null==t)return[];var n=e.length;return n>1&&a(t,e[0],e[1])?e=[]:n>2&&a(e[0],e[1],e[2])&&(e=[e[0]]),i(t,r(e,1),[])}));t.exports=u},2616:function(t,e,n){var r=n(1367),i=n(1335),o=n(687),a=n(1894),u=n(2617),s=n(960),c=n(2618),f=n(772),l=n(585);t.exports=function(t,e,n){e=e.length?r(e,(function(t){return l(t)?function(e){return i(e,1===t.length?t[0]:t)}:t})):[f];var h=-1;e=r(e,s(o));var d=a(t,(function(t,n,i){return{criteria:r(e,(function(e){return e(t)})),index:++h,value:t}}));return u(d,(function(t,e){return c(t,e,n)}))}},2617:function(t,e){t.exports=function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}},2618:function(t,e,n){var r=n(2619);t.exports=function(t,e,n){for(var i=-1,o=t.criteria,a=e.criteria,u=o.length,s=n.length;++i<u;){var c=r(o[i],a[i]);if(c)return i>=s?c:c*("desc"==n[i]?-1:1)}return t.index-e.index}},2619:function(t,e,n){var r=n(1013);t.exports=function(t,e){if(t!==e){var n=void 0!==t,i=null===t,o=t===t,a=r(t),u=void 0!==e,s=null===e,c=e===e,f=r(e);if(!s&&!f&&!a&&t>e||a&&u&&c&&!s&&!f||i&&u&&c||!n&&c||!o)return 1;if(!i&&!a&&!f&&t<e||f&&n&&o&&!i&&!a||s&&n&&o||!u&&o||!c)return-1}return 0}},2620:function(t,e,n){var r=n(856),i=0;t.exports=function(t){var e=++i;return r(t)+e}},2621:function(t,e,n){var r=n(790),i=n(2622);t.exports=function(t,e){return i(t||[],e||[],r)}},2622:function(t,e){t.exports=function(t,e,n){for(var r=-1,i=t.length,o=e.length,a={};++r<i;){var u=r<o?e[r]:void 0;n(a,t[r],u)}return a}},2623:function(t,e,n){"use strict";var r=n(556),i=n(2624);t.exports={run:function(t){var e="greedy"===t.graph().acyclicer?i(t,function(t){return function(e){return t.edge(e).weight}}(t)):function(t){var e=[],n={},i={};function o(a){r.has(i,a)||(i[a]=!0,n[a]=!0,r.forEach(t.outEdges(a),(function(t){r.has(n,t.w)?e.push(t):o(t.w)})),delete n[a])}return r.forEach(t.nodes(),o),e}(t);r.forEach(e,(function(e){var n=t.edge(e);t.removeEdge(e),n.forwardName=e.name,n.reversed=!0,t.setEdge(e.w,e.v,n,r.uniqueId("rev"))}))},undo:function(t){r.forEach(t.edges(),(function(e){var n=t.edge(e);if(n.reversed){t.removeEdge(e);var r=n.forwardName;delete n.reversed,delete n.forwardName,t.setEdge(e.w,e.v,n,r)}}))}}},2624:function(t,e,n){var r=n(556),i=n(689).Graph,o=n(2625);t.exports=function(t,e){if(t.nodeCount()<=1)return[];var n=function(t,e){var n=new i,a=0,u=0;r.forEach(t.nodes(),(function(t){n.setNode(t,{v:t,in:0,out:0})})),r.forEach(t.edges(),(function(t){var r=n.edge(t.v,t.w)||0,i=e(t),o=r+i;n.setEdge(t.v,t.w,o),u=Math.max(u,n.node(t.v).out+=i),a=Math.max(a,n.node(t.w).in+=i)}));var c=r.range(u+a+3).map((function(){return new o})),f=a+1;return r.forEach(n.nodes(),(function(t){s(c,f,n.node(t))})),{graph:n,buckets:c,zeroIdx:f}}(t,e||a),c=function(t,e,n){var r,i=[],o=e[e.length-1],a=e[0];for(;t.nodeCount();){for(;r=a.dequeue();)u(t,e,n,r);for(;r=o.dequeue();)u(t,e,n,r);if(t.nodeCount())for(var s=e.length-2;s>0;--s)if(r=e[s].dequeue()){i=i.concat(u(t,e,n,r,!0));break}}return i}(n.graph,n.buckets,n.zeroIdx);return r.flatten(r.map(c,(function(e){return t.outEdges(e.v,e.w)})),!0)};var a=r.constant(1);function u(t,e,n,i,o){var a=o?[]:void 0;return r.forEach(t.inEdges(i.v),(function(r){var i=t.edge(r),u=t.node(r.v);o&&a.push({v:r.v,w:r.w}),u.out-=i,s(e,n,u)})),r.forEach(t.outEdges(i.v),(function(r){var i=t.edge(r),o=r.w,a=t.node(o);a.in-=i,s(e,n,a)})),t.removeNode(i.v),a}function s(t,e,n){n.out?n.in?t[n.out-n.in+e].enqueue(n):t[t.length-1].enqueue(n):t[0].enqueue(n)}},2625:function(t,e){function n(){var t={};t._next=t._prev=t,this._sentinel=t}function r(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function i(t,e){if("_next"!==t&&"_prev"!==t)return e}t.exports=n,n.prototype.dequeue=function(){var t=this._sentinel,e=t._prev;if(e!==t)return r(e),e},n.prototype.enqueue=function(t){var e=this._sentinel;t._prev&&t._next&&r(t),t._next=e._next,e._next._prev=t,e._next=t,t._prev=e},n.prototype.toString=function(){for(var t=[],e=this._sentinel,n=e._prev;n!==e;)t.push(JSON.stringify(n,i)),n=n._prev;return"["+t.join(", ")+"]"}},2626:function(t,e,n){"use strict";var r=n(556),i=n(643);t.exports={run:function(t){t.graph().dummyChains=[],r.forEach(t.edges(),(function(e){!function(t,e){var n,r,o,a=e.v,u=t.node(a).rank,s=e.w,c=t.node(s).rank,f=e.name,l=t.edge(e),h=l.labelRank;if(c===u+1)return;for(t.removeEdge(e),o=0,++u;u<c;++o,++u)l.points=[],r={width:0,height:0,edgeLabel:l,edgeObj:e,rank:u},n=i.addDummyNode(t,"edge",r,"_d"),u===h&&(r.width=l.width,r.height=l.height,r.dummy="edge-label",r.labelpos=l.labelpos),t.setEdge(a,n,{weight:l.weight},f),0===o&&t.graph().dummyChains.push(n),a=n;t.setEdge(a,s,{weight:l.weight},f)}(t,e)}))},undo:function(t){r.forEach(t.graph().dummyChains,(function(e){var n,r=t.node(e),i=r.edgeLabel;for(t.setEdge(r.edgeObj,i);r.dummy;)n=t.successors(e)[0],t.removeNode(e),i.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),e=n,r=t.node(e)}))}}},2627:function(t,e,n){"use strict";var r=n(1298).longestPathWithLayer,i=n(1910).feasibleTreeWithLayer,o=n(2628);t.exports=function(t){switch(t.graph().ranker){case"network-simplex":!function(t){o(t)}(t);break;default:u(t);break;case"longest-path":a(t)}};var a=r;function u(t){r(t),i(t)}},2628:function(t,e,n){"use strict";var r=n(556),i=n(1910).feasibleTree,o=n(1298).slack,a=n(1298).longestPath,u=n(689).alg.preorder,s=n(689).alg.postorder,c=n(643).simplify;function f(t){t=c(t),a(t);var e,n=i(t);for(d(n),l(n,t);e=m(n);)g(n,t,e,v(n,t,e))}function l(t,e){var n=s(t,t.nodes());n=n.slice(0,n.length-1),r.forEach(n,(function(n){!function(t,e,n){var r=t.node(n).parent;t.edge(n,r).cutvalue=h(t,e,n)}(t,e,n)}))}function h(t,e,n){var i=t.node(n).parent,o=!0,a=e.edge(n,i),u=0;return a||(o=!1,a=e.edge(i,n)),u=a.weight,r.forEach(e.nodeEdges(n),(function(r){var a,s,c=r.v===n,f=c?r.w:r.v;if(f!==i){var l=c===o,h=e.edge(r).weight;if(u+=l?h:-h,a=n,s=f,t.hasEdge(a,s)){var d=t.edge(n,f).cutvalue;u+=l?-d:d}}})),u}function d(t,e){arguments.length<2&&(e=t.nodes()[0]),p(t,{},1,e)}function p(t,e,n,i,o){var a=n,u=t.node(i);return e[i]=!0,r.forEach(t.neighbors(i),(function(o){r.has(e,o)||(n=p(t,e,n,o,i))})),u.low=a,u.lim=n++,o?u.parent=o:delete u.parent,n}function m(t){return r.find(t.edges(),(function(e){return t.edge(e).cutvalue<0}))}function v(t,e,n){var i=n.v,a=n.w;e.hasEdge(i,a)||(i=n.w,a=n.v);var u=t.node(i),s=t.node(a),c=u,f=!1;u.lim>s.lim&&(c=s,f=!0);var l=r.filter(e.edges(),(function(e){return f===y(t,t.node(e.v),c)&&f!==y(t,t.node(e.w),c)}));return r.minBy(l,(function(t){return o(e,t)}))}function g(t,e,n,i){var o=n.v,a=n.w;t.removeEdge(o,a),t.setEdge(i.v,i.w,{}),d(t),l(t,e),function(t,e){var n=r.find(t.nodes(),(function(t){return!e.node(t).parent})),i=u(t,n);i=i.slice(1),r.forEach(i,(function(n){var r=t.node(n).parent,i=e.edge(n,r),o=!1;i||(i=e.edge(r,n),o=!0),e.node(n).rank=e.node(r).rank+(o?i.minlen:-i.minlen)}))}(t,e)}function y(t,e,n){return n.low<=e.lim&&e.lim<=n.lim}t.exports=f,f.initLowLimValues=d,f.initCutValues=l,f.calcCutValue=h,f.leaveEdge=m,f.enterEdge=v,f.exchangeEdges=g},2629:function(t,e,n){var r=n(556);t.exports=function(t){var e=function(t){var e={},n=0;function i(o){var a=n;r.forEach(t.children(o),i),e[o]={low:a,lim:n++}}return r.forEach(t.children(),i),e}(t);r.forEach(t.graph().dummyChains,(function(n){for(var r=t.node(n),i=r.edgeObj,o=function(t,e,n,r){var i,o,a=[],u=[],s=Math.min(e[n].low,e[r].low),c=Math.max(e[n].lim,e[r].lim);i=n;do{i=t.parent(i),a.push(i)}while(i&&(e[i].low>s||c>e[i].lim));o=i,i=r;for(;(i=t.parent(i))!==o;)u.push(i);return{path:a.concat(u.reverse()),lca:o}}(t,e,i.v,i.w),a=o.path,u=o.lca,s=0,c=a[s],f=!0;n!==i.w;){if(r=t.node(n),f){for(;(c=a[s])!==u&&t.node(c).maxRank<r.rank;)s++;c===u&&(f=!1)}if(!f){for(;s<a.length-1&&t.node(c=a[s+1]).minRank<=r.rank;)s++;c=a[s]}t.setParent(n,c),n=t.successors(n)[0]}}))}},2630:function(t,e,n){var r=n(556),i=n(643);function o(t,e,n,a,u,s,c){var f=t.children(c);if(f.length){var l=i.addBorderNode(t,"_bt"),h=i.addBorderNode(t,"_bb"),d=t.node(c);t.setParent(l,c),d.borderTop=l,t.setParent(h,c),d.borderBottom=h,r.forEach(f,(function(r){o(t,e,n,a,u,s,r);var i=t.node(r),f=i.borderTop?i.borderTop:r,d=i.borderBottom?i.borderBottom:r,p=i.borderTop?a:2*a,m=f!==d?1:u-s[c]+1;t.setEdge(l,f,{weight:p,minlen:m,nestingEdge:!0}),t.setEdge(d,h,{weight:p,minlen:m,nestingEdge:!0})})),t.parent(c)||t.setEdge(e,l,{weight:0,minlen:u+s[c]})}else c!==e&&t.setEdge(e,c,{weight:0,minlen:n})}t.exports={run:function(t){var e=i.addDummyNode(t,"root",{},"_root"),n=function(t){var e={};function n(i,o){var a=t.children(i);a&&a.length&&r.forEach(a,(function(t){n(t,o+1)})),e[i]=o}return r.forEach(t.children(),(function(t){n(t,1)})),e}(t),a=r.max(r.values(n))-1,u=2*a+1;t.graph().nestingRoot=e,r.forEach(t.edges(),(function(e){t.edge(e).minlen*=u}));var s=function(t){return r.reduce(t.edges(),(function(e,n){return e+t.edge(n).weight}),0)}(t)+1;r.forEach(t.children(),(function(r){o(t,e,u,s,a,n,r)})),t.graph().nodeRankFactor=u},cleanup:function(t){var e=t.graph();t.removeNode(e.nestingRoot),delete e.nestingRoot,r.forEach(t.edges(),(function(e){t.edge(e).nestingEdge&&t.removeEdge(e)}))}}},2631:function(t,e,n){var r=n(556),i=n(643);function o(t,e,n,r,o,a){var u={width:0,height:0,rank:a,borderType:e},s=o[e][a-1],c=i.addDummyNode(t,"border",u,n);o[e][a]=c,t.setParent(c,r),s&&t.setEdge(s,c,{weight:1})}t.exports=function(t){r.forEach(t.children(),(function e(n){var i=t.children(n),a=t.node(n);if(i.length&&r.forEach(i,e),r.has(a,"minRank")){a.borderLeft=[],a.borderRight=[];for(var u=a.minRank,s=a.maxRank+1;u<s;++u)o(t,"borderLeft","_bl",n,a,u),o(t,"borderRight","_br",n,a,u)}}))}},2632:function(t,e,n){"use strict";var r=n(556);function i(t){r.forEach(t.nodes(),(function(e){o(t.node(e))})),r.forEach(t.edges(),(function(e){o(t.edge(e))}))}function o(t){var e=t.width;t.width=t.height,t.height=e}function a(t){t.y=-t.y}function u(t){var e=t.x;t.x=t.y,t.y=e}t.exports={adjust:function(t){var e=t.graph().rankdir.toLowerCase();"lr"!==e&&"rl"!==e||i(t)},undo:function(t){var e=t.graph().rankdir.toLowerCase();"bt"!==e&&"rl"!==e||function(t){r.forEach(t.nodes(),(function(e){a(t.node(e))})),r.forEach(t.edges(),(function(e){var n=t.edge(e);r.forEach(n.points,a),r.has(n,"y")&&a(n)}))}(t);"lr"!==e&&"rl"!==e||(!function(t){r.forEach(t.nodes(),(function(e){u(t.node(e))})),r.forEach(t.edges(),(function(e){var n=t.edge(e);r.forEach(n.points,u),r.has(n,"x")&&u(n)}))}(t),i(t))}}},2633:function(t,e,n){"use strict";var r=n(556),i=n(2634),o=n(2635),a=n(2636),u=n(2640),s=n(2641),c=n(689).Graph,f=n(643);function l(t,e,n){return r.map(e,(function(e){return u(t,e,n)}))}function h(t,e,n){var i=new c;r.forEach(t,(function(t){var o=t.graph().root,u=a(t,o,i,e,n);r.forEach(u.vs,(function(e,n){t.node(e).order=n})),s(t,i,u.vs)}))}function d(t,e){r.forEach(e,(function(e){r.forEach(e,(function(e,n){t.node(e).order=n}))}))}t.exports=function(t){var e=f.maxRank(t),n=l(t,r.range(1,e+1),"inEdges"),a=l(t,r.range(e-1,-1,-1),"outEdges"),u=i(t);d(t,u);for(var s,c=Number.POSITIVE_INFINITY,p=0,m=0;m<4;++p,++m){h(p%2?n:a,p%4>=2),u=f.buildLayerMatrix(t);var v=o(t,u);v<c&&(m=0,s=r.cloneDeep(u),c=v)}for(u=i(t),d(t,u),p=0,m=0;m<4;++p,++m)h(p%2?n:a,p%4>=2,!0),u=f.buildLayerMatrix(t),(v=o(t,u))<c&&(m=0,s=r.cloneDeep(u),c=v);d(t,s)}},2634:function(t,e,n){"use strict";var r=n(556);t.exports=function(t){var e={},n=r.filter(t.nodes(),(function(e){return!t.children(e).length})),i=r.max(r.map(n,(function(e){return t.node(e).rank}))),o=r.map(r.range(i+1),(function(){return[]}));var a=r.sortBy(n,(function(e){return t.node(e).rank})),u=r.sortBy(r.filter(a,(function(e){return void 0!==t.node(e).fixorder})),(function(e){return t.node(e).fixorder}));return r.forEach(u,(function(n){o[t.node(n).rank].push(n),e[n]=!0})),r.forEach(a,(function n(i){if(r.has(e,i))return;e[i]=!0;var a=t.node(i);o[a.rank].push(i),r.forEach(t.successors(i),n)})),o}},2635:function(t,e,n){"use strict";var r=n(556);function i(t,e,n){for(var i=r.zipObject(n,r.map(n,(function(t,e){return e}))),o=r.flatten(r.map(e,(function(e){return r.sortBy(r.map(t.outEdges(e),(function(e){return{pos:i[e.w],weight:t.edge(e).weight}})),"pos")})),!0),a=1;a<n.length;)a<<=1;var u=2*a-1;a-=1;var s=r.map(new Array(u),(function(){return 0})),c=0;return r.forEach(o.forEach((function(t){var e=t.pos+a;s[e]+=t.weight;for(var n=0;e>0;)e%2&&(n+=s[e+1]),s[e=e-1>>1]+=t.weight;c+=t.weight*n}))),c}t.exports=function(t,e){for(var n=0,r=1;r<e.length;++r)n+=i(t,e[r-1],e[r]);return n}},2636:function(t,e,n){var r=n(556),i=n(2637),o=n(2638),a=n(2639);t.exports=function t(e,n,u,s,c){var f=e.children(n),l=e.node(n),h=l?l.borderLeft:void 0,d=l?l.borderRight:void 0,p={};h&&(f=r.filter(f,(function(t){return t!==h&&t!==d})));var m=i(e,f);r.forEach(m,(function(n){if(e.children(n.v).length){var i=t(e,n.v,u,s);p[n.v]=i,r.has(i,"barycenter")&&(o=n,a=i,r.isUndefined(o.barycenter)?(o.barycenter=a.barycenter,o.weight=a.weight):(o.barycenter=(o.barycenter*o.weight+a.barycenter*a.weight)/(o.weight+a.weight),o.weight+=a.weight))}var o,a}));var v=o(m,u);(function(t,e){r.forEach(t,(function(t){t.vs=r.flatten(t.vs.map((function(t){return e[t]?e[t].vs:t})),!0)}))})(v,p),r.forEach(v,(function(t){var n=e.node(t.vs[0]);t.fixorder=n.fixorder,t.order=n.order}));var g=a(v,s,c);if(h&&(g.vs=r.flatten([h,g.vs,d],!0),e.predecessors(h).length)){var y=e.node(e.predecessors(h)[0]),b=e.node(e.predecessors(d)[0]);r.has(g,"barycenter")||(g.barycenter=0,g.weight=0),g.barycenter=(g.barycenter*g.weight+y.order+b.order)/(g.weight+2),g.weight+=2}return g}},2637:function(t,e,n){var r=n(556);t.exports=function(t,e){return r.map(e,(function(e){var n=t.inEdges(e);if(n.length){var i=r.reduce(n,(function(e,n){var r=t.edge(n),i=t.node(n.v);return{sum:e.sum+r.weight*i.order,weight:e.weight+r.weight}}),{sum:0,weight:0});return{v:e,barycenter:i.sum/i.weight,weight:i.weight}}return{v:e}}))}},2638:function(t,e,n){"use strict";var r=n(556);t.exports=function(t,e){var n={};return r.forEach(t,(function(t,e){var i=n[t.v]={indegree:0,in:[],out:[],vs:[t.v],i:e};r.isUndefined(t.barycenter)||(i.barycenter=t.barycenter,i.weight=t.weight)})),r.forEach(e.edges(),(function(t){var e=n[t.v],i=n[t.w];r.isUndefined(e)||r.isUndefined(i)||(i.indegree++,e.out.push(n[t.w]))})),function(t){var e=[];function n(t){return function(e){e.merged||(r.isUndefined(e.barycenter)||r.isUndefined(t.barycenter)||e.barycenter>=t.barycenter)&&function(t,e){var n=0,r=0;t.weight&&(n+=t.barycenter*t.weight,r+=t.weight);e.weight&&(n+=e.barycenter*e.weight,r+=e.weight);t.vs=e.vs.concat(t.vs),t.barycenter=n/r,t.weight=r,t.i=Math.min(e.i,t.i),e.merged=!0}(t,e)}}function i(e){return function(n){n.in.push(e),0===--n.indegree&&t.push(n)}}for(;t.length;){var o=t.pop();e.push(o),r.forEach(o.in.reverse(),n(o)),r.forEach(o.out,i(o))}return r.map(r.filter(e,(function(t){return!t.merged})),(function(t){return r.pick(t,["vs","i","barycenter","weight"])}))}(r.filter(n,(function(t){return!t.indegree})))}},2639:function(t,e,n){var r=n(556),i=n(643);function o(t,e,n){for(var i;e.length&&(i=r.last(e)).i<=n;)e.pop(),t.push(i.vs),n++;return n}t.exports=function(t,e,n){var a=i.partition(t,(function(t){return r.has(t,"fixorder")&&!isNaN(t.fixorder)||r.has(t,"barycenter")})),u=a.lhs,s=r.sortBy(a.rhs,(function(t){return-t.i})),c=[],f=0,l=0,h=0;u.sort(function(t,e){return function(n,r){if(void 0!==n.fixorder&&void 0!==r.fixorder)return n.fixorder-r.fixorder;if(n.barycenter<r.barycenter)return-1;if(n.barycenter>r.barycenter)return 1;if(e&&void 0!==n.order&&void 0!==r.order){if(n.order<r.order)return-1;if(n.order>r.order)return 1}return t?r.i-n.i:n.i-r.i}}(!!e,!!n)),h=o(c,s,h),r.forEach(u,(function(t){h+=t.vs.length,c.push(t.vs),f+=t.barycenter*t.weight,l+=t.weight,h=o(c,s,h)}));var d={vs:r.flatten(c,!0)};l&&(d.barycenter=f/l,d.weight=l);return d}},2640:function(t,e,n){var r=n(556),i=n(689).Graph;t.exports=function(t,e,n){var o=function(t){var e;for(;t.hasNode(e=r.uniqueId("_root")););return e}(t),a=new i({compound:!0}).setGraph({root:o}).setDefaultNodeLabel((function(e){return t.node(e)}));return r.forEach(t.nodes(),(function(i){var u=t.node(i),s=t.parent(i);(u.rank===e||u.minRank<=e&&e<=u.maxRank)&&(a.setNode(i),a.setParent(i,s||o),r.forEach(t[n](i),(function(e){var n=e.v===i?e.w:e.v,o=a.edge(n,i),u=r.isUndefined(o)?0:o.weight;a.setEdge(n,i,{weight:t.edge(e).weight+u})})),r.has(u,"minRank")&&a.setNode(i,{borderLeft:u.borderLeft[e],borderRight:u.borderRight[e]}))})),a}},2641:function(t,e,n){var r=n(556);t.exports=function(t,e,n){var i,o={};r.forEach(n,(function(n){for(var r,a,u=t.parent(n);u;){if((r=t.parent(u))?(a=o[r],o[r]=u):(a=i,i=u),a&&a!==u)return void e.setEdge(a,u);u=r}}))}},2642:function(t,e,n){"use strict";var r=n(556),i=n(643),o=n(2643).positionX;t.exports=function(t){(function(t){var e=i.buildLayerMatrix(t),n=t.graph().ranksep,o=0;r.forEach(e,(function(e){var i=r.max(r.map(e,(function(e){return t.node(e).height})));r.forEach(e,(function(e){t.node(e).y=o+i/2})),o+=i+n}))})(t=i.asNonCompoundGraph(t)),r.forEach(o(t),(function(e,n){t.node(n).x=e}))}},2643:function(t,e,n){"use strict";var r=n(556),i=n(689).Graph,o=n(643);function a(t,e){var n={};return r.reduce(e,(function(e,i){var o=0,a=0,u=e.length,c=r.last(i);return r.forEach(i,(function(e,f){var l=function(t,e){if(t.node(e).dummy)return r.find(t.predecessors(e),(function(e){return t.node(e).dummy}))}(t,e),h=l?t.node(l).order:u;(l||e===c)&&(r.forEach(i.slice(a,f+1),(function(e){r.forEach(t.predecessors(e),(function(r){var i=t.node(r),a=i.order;!(a<o||h<a)||i.dummy&&t.node(e).dummy||s(n,r,e)}))})),a=f+1,o=h)})),i})),n}function u(t,e){var n={};function i(e,i,o,a,u){var c;r.forEach(r.range(i,o),(function(i){c=e[i],t.node(c).dummy&&r.forEach(t.predecessors(c),(function(e){var r=t.node(e);r.dummy&&(r.order<a||r.order>u)&&s(n,e,c)}))}))}return r.reduce(e,(function(e,n){var o,a=-1,u=0;return r.forEach(n,(function(r,s){if("border"===t.node(r).dummy){var c=t.predecessors(r);c.length&&(o=t.node(c[0]).order,i(n,u,s,a,o),u=s,a=o)}i(n,u,n.length,o,e.length)})),n})),n}function s(t,e,n){if(e>n){var r=e;e=n,n=r}var i=t[e];i||(t[e]=i={}),i[n]=!0}function c(t,e,n){if(e>n){var i=e;e=n,n=i}return r.has(t[e],n)}function f(t,e,n,i){var o={},a={},u={};return r.forEach(e,(function(t){r.forEach(t,(function(t,e){o[t]=t,a[t]=t,u[t]=e}))})),r.forEach(e,(function(t){var e=-1;r.forEach(t,(function(t){var s=i(t);if(s.length){s=r.sortBy(s,(function(t){return u[t]}));for(var f=(s.length-1)/2,l=Math.floor(f),h=Math.ceil(f);l<=h;++l){var d=s[l];a[t]===t&&e<u[d]&&!c(n,t,d)&&(a[d]=t,a[t]=o[t]=o[d],e=u[d])}}}))})),{root:o,align:a}}function l(t,e,n,o,a){var u={},s=function(t,e,n,o){var a=new i,u=t.graph(),s=function(t,e,n){return function(i,o,a){var u,s=i.node(o),c=i.node(a),f=0;if(f+=s.width/2,r.has(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":u=-s.width/2;break;case"r":u=s.width/2}if(u&&(f+=n?u:-u),u=0,f+=(s.dummy?e:t)/2,f+=(c.dummy?e:t)/2,f+=c.width/2,r.has(c,"labelpos"))switch(c.labelpos.toLowerCase()){case"l":u=c.width/2;break;case"r":u=-c.width/2}return u&&(f+=n?u:-u),u=0,f}}(u.nodesep,u.edgesep,o);return r.forEach(e,(function(e){var i;r.forEach(e,(function(e){var r=n[e];if(a.setNode(r),i){var o=n[i],u=a.edge(o,r);a.setEdge(o,r,Math.max(s(t,e,i),u||0))}i=e}))})),a}(t,e,n,a),c=a?"borderLeft":"borderRight";function f(t,e){for(var n=s.nodes(),r=n.pop(),i={};r;)i[r]?t(r):(i[r]=!0,n.push(r),n=n.concat(e(r))),r=n.pop()}return f((function(t){u[t]=s.inEdges(t).reduce((function(t,e){return Math.max(t,u[e.v]+s.edge(e))}),0)}),s.predecessors.bind(s)),f((function(e){var n=s.outEdges(e).reduce((function(t,e){return Math.min(t,u[e.w]-s.edge(e))}),Number.POSITIVE_INFINITY),r=t.node(e);n!==Number.POSITIVE_INFINITY&&r.borderType!==c&&(u[e]=Math.max(u[e],n))}),s.successors.bind(s)),r.forEach(o,(function(t){u[t]=u[n[t]]})),u}function h(t,e){return r.minBy(r.values(e),(function(e){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return r.forIn(e,(function(e,r){var o=function(t,e){return t.node(e).width}(t,r)/2;n=Math.max(e+o,n),i=Math.min(e-o,i)})),n-i}))}function d(t,e){var n=r.values(e),i=r.min(n),o=r.max(n);r.forEach(["u","d"],(function(n){r.forEach(["l","r"],(function(a){var u,s=n+a,c=t[s];if(c!==e){var f=r.values(c);(u="l"===a?i-r.min(f):o-r.max(f))&&(t[s]=r.mapValues(c,(function(t){return t+u})))}}))}))}function p(t,e){return r.mapValues(t.ul,(function(n,i){if(e)return t[e.toLowerCase()][i];var o=r.sortBy(r.map(t,i));return(o[1]+o[2])/2}))}t.exports={positionX:function(t){var e,n=o.buildLayerMatrix(t),i=r.merge(a(t,n),u(t,n)),s={};r.forEach(["u","d"],(function(o){e="u"===o?n:r.values(n).reverse(),r.forEach(["l","r"],(function(n){"r"===n&&(e=r.map(e,(function(t){return r.values(t).reverse()})));var a=("u"===o?t.predecessors:t.successors).bind(t),u=f(t,e,i,a),c=l(t,e,u.root,u.align,"r"===n);"r"===n&&(c=r.mapValues(c,(function(t){return-t}))),s[o+n]=c}))}));var c=h(t,s);return d(s,c),p(s,t.graph().align)},findType1Conflicts:a,findType2Conflicts:u,addConflict:s,hasConflict:c,verticalAlignment:f,horizontalCompaction:l,alignCoordinates:d,findSmallestWidthAlignment:h,balance:p}},2644:function(t,e,n){"use strict";var r=n(556);t.exports=function(t,e){var n=r.filter(t.nodes(),(function(e){return!t.children(e).length})),i=r.max(r.map(n,(function(e){return t.node(e).rank}))),o=r.map(r.range(i+1),(function(){return[]}));r.forEach(e,(function(e){var n=t.node(e);n.dummy||(n.fixorder=o[n.rank].length,o[n.rank].push(e))}))}},2645:function(t,e,n){var r=n(556),i=n(643),o=n(689).Graph;t.exports={debugOrdering:function(t){var e=i.buildLayerMatrix(t),n=new o({compound:!0,multigraph:!0}).setGraph({});return r.forEach(t.nodes(),(function(e){n.setNode(e,{label:e}),n.setParent(e,"layer"+t.node(e).rank)})),r.forEach(t.edges(),(function(t){n.setEdge(t.v,t.w,{},t.name)})),r.forEach(e,(function(t,e){var i="layer"+e;n.setNode(i,{rank:"same"}),r.reduce(t,(function(t,e){return n.setEdge(t,e,{style:"invis"}),e}))})),n}}},2646:function(t,e){t.exports="0.1.1"},2647:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{s(r.next(t))}catch(e){o(e)}}function u(t){try{s(r.throw(t))}catch(e){o(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(u){o=[6,u],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},o=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.Container=void 0;var a=n(2648),u=n(652),s=n(758),c=n(601),f=n(1912),l=n(2649),h=n(2656),d=n(2658),p=n(829),m=n(986),v=n(2661),g=n(2662),y=function(){function t(t){this._appliedMiddleware=[];var e=t||{};if("object"!==typeof e)throw new Error(""+u.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===e.defaultScope)e.defaultScope=s.BindingScopeEnum.Transient;else if(e.defaultScope!==s.BindingScopeEnum.Singleton&&e.defaultScope!==s.BindingScopeEnum.Transient&&e.defaultScope!==s.BindingScopeEnum.Request)throw new Error(""+u.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===e.autoBindInjectable)e.autoBindInjectable=!1;else if("boolean"!==typeof e.autoBindInjectable)throw new Error(""+u.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===e.skipBaseClassChecks)e.skipBaseClassChecks=!1;else if("boolean"!==typeof e.skipBaseClassChecks)throw new Error(""+u.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:e.autoBindInjectable,defaultScope:e.defaultScope,skipBaseClassChecks:e.skipBaseClassChecks},this.id=p.id(),this._bindingDictionary=new g.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new f.MetadataReader}return t.merge=function(e,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var a=new t,u=o([e,n],r).map((function(t){return l.getBindingDictionary(t)})),s=l.getBindingDictionary(a);function c(t,e){t.traverse((function(t,n){n.forEach((function(t){e.add(t.serviceIdentifier,t.clone())}))}))}return u.forEach((function(t){c(t,s)})),a},t.prototype.load=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=this._getContainerModuleHelpersFactory(),r=0,i=t;r<i.length;r++){var o=i[r],a=n(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)}},t.prototype.loadAsync=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r(this,void 0,void 0,(function(){var e,n,r,o,a;return i(this,(function(i){switch(i.label){case 0:e=this._getContainerModuleHelpersFactory(),n=0,r=t,i.label=1;case 1:return n<r.length?(o=r[n],a=e(o.id),[4,o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)]):[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.unload=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(t){return function(e){return e.moduleId===t}};e.forEach((function(e){var n=r(e.id);t._bindingDictionary.removeByCondition(n)}))},t.prototype.bind=function(t){var e=this.options.defaultScope||s.BindingScopeEnum.Transient,n=new a.Binding(t,e);return this._bindingDictionary.add(t,n),new d.BindingToSyntax(n)},t.prototype.rebind=function(t){return this.unbind(t),this.bind(t)},t.prototype.unbind=function(t){try{this._bindingDictionary.remove(t)}catch(e){throw new Error(u.CANNOT_UNBIND+" "+m.getServiceIdentifierAsString(t))}},t.prototype.unbindAll=function(){this._bindingDictionary=new g.Lookup},t.prototype.isBound=function(t){var e=this._bindingDictionary.hasKey(t);return!e&&this.parent&&(e=this.parent.isBound(t)),e},t.prototype.isBoundNamed=function(t,e){return this.isBoundTagged(t,c.NAMED_TAG,e)},t.prototype.isBoundTagged=function(t,e,n){var r=!1;if(this._bindingDictionary.hasKey(t)){var i=this._bindingDictionary.get(t),o=l.createMockRequest(this,t,e,n);r=i.some((function(t){return t.constraint(o)}))}return!r&&this.parent&&(r=this.parent.isBoundTagged(t,e,n)),r},t.prototype.snapshot=function(){this._snapshots.push(v.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},t.prototype.restore=function(){var t=this._snapshots.pop();if(void 0===t)throw new Error(u.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=t.bindings,this._middleware=t.middleware},t.prototype.createChild=function(e){var n=new t(e||this.options);return n.parent=this,n},t.prototype.applyMiddleware=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._appliedMiddleware=this._appliedMiddleware.concat(t);var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=t.reduce((function(t,e){return e(t)}),n)},t.prototype.applyCustomMetadataReader=function(t){this._metadataReader=t},t.prototype.get=function(t){return this._get(!1,!1,s.TargetTypeEnum.Variable,t)},t.prototype.getTagged=function(t,e,n){return this._get(!1,!1,s.TargetTypeEnum.Variable,t,e,n)},t.prototype.getNamed=function(t,e){return this.getTagged(t,c.NAMED_TAG,e)},t.prototype.getAll=function(t){return this._get(!0,!0,s.TargetTypeEnum.Variable,t)},t.prototype.getAllTagged=function(t,e,n){return this._get(!1,!0,s.TargetTypeEnum.Variable,t,e,n)},t.prototype.getAllNamed=function(t,e){return this.getAllTagged(t,c.NAMED_TAG,e)},t.prototype.resolve=function(t){var e=this.createChild();return e.bind(t).toSelf(),this._appliedMiddleware.forEach((function(t){e.applyMiddleware(t)})),e.get(t)},t.prototype._getContainerModuleHelpersFactory=function(){var t=this,e=function(t,e){t._binding.moduleId=e},n=function(n){return function(r){var i=t.rebind.bind(t)(r);return e(i,n),i}};return function(r){return{bindFunction:(i=r,function(n){var r=t.bind.bind(t)(n);return e(r,i),r}),isboundFunction:function(e){return t.isBound.bind(t)(e)},rebindFunction:n(r),unbindFunction:function(e){t.unbind.bind(t)(e)}};var i}},t.prototype._get=function(t,e,n,r,i,o){var a=null,s={avoidConstraints:t,contextInterceptor:function(t){return t},isMultiInject:e,key:i,serviceIdentifier:r,targetType:n,value:o};if(this._middleware){if(void 0===(a=this._middleware(s))||null===a)throw new Error(u.INVALID_MIDDLEWARE_RETURN)}else a=this._planAndResolve()(s);return a},t.prototype._planAndResolve=function(){var t=this;return function(e){var n=l.plan(t._metadataReader,t,e.isMultiInject,e.targetType,e.serviceIdentifier,e.key,e.value,e.avoidConstraints);return n=e.contextInterceptor(n),h.resolve(n)}},t}();e.Container=y},2648:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Binding=void 0;var r=n(758),i=n(829),o=function(){function t(t,e){this.id=i.id(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=r.BindingTypeEnum.Invalid,this.constraint=function(t){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return t.prototype.clone=function(){var e=new t(this.serviceIdentifier,this.scope);return e.activated=e.scope===r.BindingScopeEnum.Singleton&&this.activated,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.cache=this.cache,e},t}();e.Binding=o},2649:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getBindingDictionary=e.createMockRequest=e.plan=void 0;var r=n(2650),i=n(652),o=n(758),a=n(601),u=n(1913),s=n(986),c=n(2651),f=n(690),l=n(2652),h=n(2653),d=n(2655),p=n(1915);function m(t){return t._bindingDictionary}function v(t,e,n,o,a){var u=y(n.container,a.serviceIdentifier),c=[];return u.length===r.BindingCount.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"===typeof a.serviceIdentifier&&t.getConstructorMetadata(a.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(a.serviceIdentifier).toSelf(),u=y(n.container,a.serviceIdentifier)),c=e?u:u.filter((function(t){var e=new d.Request(t.serviceIdentifier,n,o,t,a);return t.constraint(e)})),function(t,e,n,o){switch(e.length){case r.BindingCount.NoBindingsAvailable:if(n.isOptional())return e;var a=s.getServiceIdentifierAsString(t),u=i.NOT_REGISTERED;throw u+=s.listMetadataForTarget(a,n),u+=s.listRegisteredBindingsForServiceIdentifier(o,a,y),new Error(u);case r.BindingCount.OnlyOneBindingAvailable:if(!n.isArray())return e;case r.BindingCount.MultipleBindingsAvailable:default:if(n.isArray())return e;a=s.getServiceIdentifierAsString(t),u=i.AMBIGUOUS_MATCH+" "+a;throw u+=s.listRegisteredBindingsForServiceIdentifier(o,a,y),new Error(u)}}(a.serviceIdentifier,c,a,n.container),c}function g(t,e,n,r,a,u){var s,c;if(null===a){s=v(t,e,r,null,u),c=new d.Request(n,r,null,s,u);var f=new l.Plan(r,c);r.addPlan(f)}else s=v(t,e,r,a,u),c=a.addChildRequest(u.serviceIdentifier,s,u);s.forEach((function(e){var n=null;if(u.isArray())n=c.addChildRequest(e.serviceIdentifier,e,u);else{if(e.cache)return;n=c}if(e.type===o.BindingTypeEnum.Instance&&null!==e.implementationType){var a=h.getDependencies(t,e.implementationType);if(!r.container.options.skipBaseClassChecks){var s=h.getBaseClassDependencyCount(t,e.implementationType);if(a.length<s){var f=i.ARGUMENTS_LENGTH_MISMATCH(h.getFunctionName(e.implementationType));throw new Error(f)}}a.forEach((function(e){g(t,!1,e.serviceIdentifier,r,n,e)}))}}))}function y(t,e){var n=[],r=m(t);return r.hasKey(e)?n=r.get(e):null!==t.parent&&(n=y(t.parent,e)),n}e.getBindingDictionary=m,e.plan=function(t,e,n,r,i,o,l,h){void 0===h&&(h=!1);var d=new c.Context(e),m=function(t,e,n,r,i,o){var u=t?a.MULTI_INJECT_TAG:a.INJECT_TAG,s=new f.Metadata(u,n),c=new p.Target(e,r,n,s);if(void 0!==i){var l=new f.Metadata(i,o);c.metadata.push(l)}return c}(n,r,i,"",o,l);try{return g(t,h,i,d,null,m),d}catch(v){throw u.isStackOverflowExeption(v)&&d.plan&&s.circularDependencyToException(d.plan.rootRequest),v}},e.createMockRequest=function(t,e,n,r){var i=new p.Target(o.TargetTypeEnum.Variable,"",e,new f.Metadata(n,r)),a=new c.Context(t);return new d.Request(e,a,null,[],i)}},2650:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BindingCount=void 0;e.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}},2651:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Context=void 0;var r=n(829),i=function(){function t(t){this.id=r.id(),this.container=t}return t.prototype.addPlan=function(t){this.plan=t},t.prototype.setCurrentRequest=function(t){this.currentRequest=t},t}();e.Context=i},2652:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Plan=void 0;var r=function(t,e){this.parentContext=t,this.rootRequest=e};e.Plan=r},2653:function(t,e,n){"use strict";var r=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.getFunctionName=e.getBaseClassDependencyCount=e.getDependencies=void 0;var i=n(1914),o=n(652),a=n(758),u=n(601),s=n(986);Object.defineProperty(e,"getFunctionName",{enumerable:!0,get:function(){return s.getFunctionName}});var c=n(1915);function f(t,e,n,i){var a=t.getConstructorMetadata(n),u=a.compilerGeneratedMetadata;if(void 0===u){var s=o.MISSING_INJECTABLE_ANNOTATION+" "+e+".";throw new Error(s)}var c=a.userGeneratedMetadata,f=Object.keys(c),d=0===n.length&&f.length>0,p=f.length>n.length,m=function(t,e,n,r,i){for(var o=[],a=0;a<i;a++){var u=l(a,t,e,n,r);null!==u&&o.push(u)}return o}(i,e,u,c,d||p?f.length:n.length),v=h(t,n);return r(r([],m),v)}function l(t,e,n,r,u){var s=u[t.toString()]||[],f=d(s),l=!0!==f.unmanaged,h=r[t],p=f.inject||f.multiInject;if((h=p||h)instanceof i.LazyServiceIdentifer&&(h=h.unwrap()),l){if(!e&&(h===Object||h===Function||void 0===h)){var m=o.MISSING_INJECT_ANNOTATION+" argument "+t+" in class "+n+".";throw new Error(m)}var v=new c.Target(a.TargetTypeEnum.ConstructorArgument,f.targetName,h);return v.metadata=s,v}return null}function h(t,e){for(var n=t.getPropertiesMetadata(e),i=[],o=0,u=Object.keys(n);o<u.length;o++){var s=u[o],f=n[s],l=d(n[s]),p=l.targetName||s,m=l.inject||l.multiInject,v=new c.Target(a.TargetTypeEnum.ClassProperty,p,m);v.metadata=f,i.push(v)}var g=Object.getPrototypeOf(e.prototype).constructor;if(g!==Object){var y=h(t,g);i=r(r([],i),y)}return i}function d(t){var e={};return t.forEach((function(t){e[t.key.toString()]=t.value})),{inject:e[u.INJECT_TAG],multiInject:e[u.MULTI_INJECT_TAG],targetName:e[u.NAME_TAG],unmanaged:e[u.UNMANAGED_TAG]}}e.getDependencies=function(t,e){return f(t,s.getFunctionName(e),e,!1)},e.getBaseClassDependencyCount=function t(e,n){var r=Object.getPrototypeOf(n.prototype).constructor;if(r!==Object){var i=f(e,s.getFunctionName(r),r,!0),o=i.map((function(t){return t.metadata.filter((function(t){return t.key===u.UNMANAGED_TAG}))})),a=[].concat.apply([],o).length,c=i.length-a;return c>0?c:t(e,r)}return 0}},2654:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QueryableString=void 0;var r=function(){function t(t){this.str=t}return t.prototype.startsWith=function(t){return 0===this.str.indexOf(t)},t.prototype.endsWith=function(t){var e,n=t.split("").reverse().join("");return e=this.str.split("").reverse().join(""),this.startsWith.call({str:e},n)},t.prototype.contains=function(t){return-1!==this.str.indexOf(t)},t.prototype.equals=function(t){return this.str===t},t.prototype.value=function(){return this.str},t}();e.QueryableString=r},2655:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Request=void 0;var r=n(829),i=function(){function t(t,e,n,i,o){this.id=r.id(),this.serviceIdentifier=t,this.parentContext=e,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}return t.prototype.addChildRequest=function(e,n,r){var i=new t(e,this.parentContext,this,n,r);return this.childRequests.push(i),i},t}();e.Request=i},2656:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.resolve=void 0;var r=n(652),i=n(758),o=n(1913),a=n(986),u=n(2657),s=function(t,e,n){try{return n()}catch(i){throw o.isStackOverflowExeption(i)?new Error(r.CIRCULAR_DEPENDENCY_IN_FACTORY(t,e.toString())):i}},c=function t(e){return function(n){n.parentContext.setCurrentRequest(n);var o=n.bindings,c=n.childRequests,f=n.target&&n.target.isArray(),l=!n.parentRequest||!n.parentRequest.target||!n.target||!n.parentRequest.target.matchesArray(n.target.serviceIdentifier);if(f&&l)return c.map((function(n){return t(e)(n)}));var h=null;if(!n.target.isOptional()||0!==o.length){var d=o[0],p=d.scope===i.BindingScopeEnum.Singleton,m=d.scope===i.BindingScopeEnum.Request;if(p&&d.activated)return d.cache;if(m&&null!==e&&e.has(d.id))return e.get(d.id);if(d.type===i.BindingTypeEnum.ConstantValue)h=d.cache,d.activated=!0;else if(d.type===i.BindingTypeEnum.Function)h=d.cache,d.activated=!0;else if(d.type===i.BindingTypeEnum.Constructor)h=d.implementationType;else if(d.type===i.BindingTypeEnum.DynamicValue&&null!==d.dynamicValue)h=s("toDynamicValue",d.serviceIdentifier,(function(){return d.dynamicValue(n.parentContext)}));else if(d.type===i.BindingTypeEnum.Factory&&null!==d.factory)h=s("toFactory",d.serviceIdentifier,(function(){return d.factory(n.parentContext)}));else if(d.type===i.BindingTypeEnum.Provider&&null!==d.provider)h=s("toProvider",d.serviceIdentifier,(function(){return d.provider(n.parentContext)}));else{if(d.type!==i.BindingTypeEnum.Instance||null===d.implementationType){var v=a.getServiceIdentifierAsString(n.serviceIdentifier);throw new Error(r.INVALID_BINDING_TYPE+" "+v)}h=u.resolveInstance(d.implementationType,c,t(e))}return"function"===typeof d.onActivation&&(h=d.onActivation(n.parentContext,h)),p&&(d.cache=h,d.activated=!0),m&&null!==e&&!e.has(d.id)&&e.set(d.id,h),h}}};e.resolve=function(t){return c(t.plan.rootRequest.requestScope)(t.plan.rootRequest)}},2657:function(t,e,n){"use strict";var r=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.resolveInstance=void 0;var i=n(652),o=n(758),a=n(601);e.resolveInstance=function(t,e,n){var u,s,c=null;if(e.length>0){var f=e.filter((function(t){return null!==t.target&&t.target.type===o.TargetTypeEnum.ConstructorArgument})).map(n);s=f,c=function(t,e,n){var r=e.filter((function(t){return null!==t.target&&t.target.type===o.TargetTypeEnum.ClassProperty})),i=r.map(n);return r.forEach((function(e,n){var r;r=e.target.name.value();var o=i[n];t[r]=o})),t}(c=new((u=t).bind.apply(u,r([void 0],s))),e,n)}else c=new t;return function(t,e){if(Reflect.hasMetadata(a.POST_CONSTRUCT,t)){var n=Reflect.getMetadata(a.POST_CONSTRUCT,t);try{e[n.value]()}catch(r){throw new Error(i.POST_CONSTRUCT_ERROR(t.name,r.message))}}}(t,c),c}},2658:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BindingToSyntax=void 0;var r=n(652),i=n(758),o=n(2659),a=n(1916),u=function(){function t(t){this._binding=t}return t.prototype.to=function(t){return this._binding.type=i.BindingTypeEnum.Instance,this._binding.implementationType=t,new o.BindingInWhenOnSyntax(this._binding)},t.prototype.toSelf=function(){if("function"!==typeof this._binding.serviceIdentifier)throw new Error(""+r.INVALID_TO_SELF_VALUE);var t=this._binding.serviceIdentifier;return this.to(t)},t.prototype.toConstantValue=function(t){return this._binding.type=i.BindingTypeEnum.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=i.BindingScopeEnum.Singleton,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toDynamicValue=function(t){return this._binding.type=i.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new o.BindingInWhenOnSyntax(this._binding)},t.prototype.toConstructor=function(t){return this._binding.type=i.BindingTypeEnum.Constructor,this._binding.implementationType=t,this._binding.scope=i.BindingScopeEnum.Singleton,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toFactory=function(t){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=t,this._binding.scope=i.BindingScopeEnum.Singleton,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toFunction=function(t){if("function"!==typeof t)throw new Error(r.INVALID_FUNCTION_BINDING);var e=this.toConstantValue(t);return this._binding.type=i.BindingTypeEnum.Function,this._binding.scope=i.BindingScopeEnum.Singleton,e},t.prototype.toAutoFactory=function(t){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=function(e){return function(){return e.container.get(t)}},this._binding.scope=i.BindingScopeEnum.Singleton,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toProvider=function(t){return this._binding.type=i.BindingTypeEnum.Provider,this._binding.provider=t,this._binding.scope=i.BindingScopeEnum.Singleton,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toService=function(t){this.toDynamicValue((function(e){return e.container.get(t)}))},t}();e.BindingToSyntax=u},2659:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BindingInWhenOnSyntax=void 0;var r=n(2660),i=n(1447),o=n(1448),a=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new o.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new i.BindingOnSyntax(this._binding),this._bindingInSyntax=new r.BindingInSyntax(t)}return t.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},t.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},t.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}();e.BindingInWhenOnSyntax=a},2660:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BindingInSyntax=void 0;var r=n(758),i=n(1916),o=function(){function t(t){this._binding=t}return t.prototype.inRequestScope=function(){return this._binding.scope=r.BindingScopeEnum.Request,new i.BindingWhenOnSyntax(this._binding)},t.prototype.inSingletonScope=function(){return this._binding.scope=r.BindingScopeEnum.Singleton,new i.BindingWhenOnSyntax(this._binding)},t.prototype.inTransientScope=function(){return this._binding.scope=r.BindingScopeEnum.Transient,new i.BindingWhenOnSyntax(this._binding)},t}();e.BindingInSyntax=o},2661:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerSnapshot=void 0;var r=function(){function t(){}return t.of=function(e,n){var r=new t;return r.bindings=e,r.middleware=n,r},t}();e.ContainerSnapshot=r},2662:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Lookup=void 0;var r=n(652),i=function(){function t(){this._map=new Map}return t.prototype.getMap=function(){return this._map},t.prototype.add=function(t,e){if(null===t||void 0===t)throw new Error(r.NULL_ARGUMENT);if(null===e||void 0===e)throw new Error(r.NULL_ARGUMENT);var n=this._map.get(t);void 0!==n?(n.push(e),this._map.set(t,n)):this._map.set(t,[e])},t.prototype.get=function(t){if(null===t||void 0===t)throw new Error(r.NULL_ARGUMENT);var e=this._map.get(t);if(void 0!==e)return e;throw new Error(r.KEY_NOT_FOUND)},t.prototype.remove=function(t){if(null===t||void 0===t)throw new Error(r.NULL_ARGUMENT);if(!this._map.delete(t))throw new Error(r.KEY_NOT_FOUND)},t.prototype.removeByCondition=function(t){var e=this;this._map.forEach((function(n,r){var i=n.filter((function(e){return!t(e)}));i.length>0?e._map.set(r,i):e._map.delete(r)}))},t.prototype.hasKey=function(t){if(null===t||void 0===t)throw new Error(r.NULL_ARGUMENT);return this._map.has(t)},t.prototype.clone=function(){var e=new t;return this._map.forEach((function(t,n){t.forEach((function(t){return e.add(n,t.clone())}))})),e},t.prototype.traverse=function(t){this._map.forEach((function(e,n){t(n,e)}))},t}();e.Lookup=i},2663:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AsyncContainerModule=e.ContainerModule=void 0;var r=n(829),i=function(t){this.id=r.id(),this.registry=t};e.ContainerModule=i;var o=function(t){this.id=r.id(),this.registry=t};e.AsyncContainerModule=o},2664:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.injectable=void 0;var r=n(652),i=n(601);e.injectable=function(){return function(t){if(Reflect.hasOwnMetadata(i.PARAM_TYPES,t))throw new Error(r.DUPLICATED_INJECTABLE_DECORATOR);var e=Reflect.getMetadata(i.DESIGN_PARAM_TYPES,t)||[];return Reflect.defineMetadata(i.PARAM_TYPES,e,t),t}}},2665:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.tagged=void 0;var r=n(690),i=n(781);e.tagged=function(t,e){return function(n,o,a){var u=new r.Metadata(t,e);"number"===typeof a?i.tagParameter(n,o,a,u):i.tagProperty(n,o,u)}}},2666:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.named=void 0;var r=n(601),i=n(690),o=n(781);e.named=function(t){return function(e,n,a){var u=new i.Metadata(r.NAMED_TAG,t);"number"===typeof a?o.tagParameter(e,n,a,u):o.tagProperty(e,n,u)}}},2667:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.optional=void 0;var r=n(601),i=n(690),o=n(781);e.optional=function(){return function(t,e,n){var a=new i.Metadata(r.OPTIONAL_TAG,!0);"number"===typeof n?o.tagParameter(t,e,n,a):o.tagProperty(t,e,a)}}},2668:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.unmanaged=void 0;var r=n(601),i=n(690),o=n(781);e.unmanaged=function(){return function(t,e,n){var a=new i.Metadata(r.UNMANAGED_TAG,!0);o.tagParameter(t,e,n,a)}}},2669:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.multiInject=void 0;var r=n(601),i=n(690),o=n(781);e.multiInject=function(t){return function(e,n,a){var u=new i.Metadata(r.MULTI_INJECT_TAG,t);"number"===typeof a?o.tagParameter(e,n,a,u):o.tagProperty(e,n,u)}}},2670:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.targetName=void 0;var r=n(601),i=n(690),o=n(781);e.targetName=function(t){return function(e,n,a){var u=new i.Metadata(r.NAME_TAG,t);o.tagParameter(e,n,a,u)}}},2671:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.postConstruct=void 0;var r=n(652),i=n(601),o=n(690);e.postConstruct=function(){return function(t,e,n){var a=new o.Metadata(i.POST_CONSTRUCT,e);if(Reflect.hasOwnMetadata(i.POST_CONSTRUCT,t.constructor))throw new Error(r.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(i.POST_CONSTRUCT,a,t.constructor)}}},2672:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.multiBindToService=void 0;e.multiBindToService=function(t){return function(e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.forEach((function(n){return t.bind(n).toService(e)}))}}}},2673:function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},t.exports.default=t.exports,t.exports.__esModule=!0,n(e,r)}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},2674:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2675);e.default=function(t,e){return void 0===e&&(e=!0),{lazyInject:r.makePropertyInjectDecorator(t,e),lazyInjectNamed:r.makePropertyInjectNamedDecorator(t,e),lazyInjectTagged:r.makePropertyInjectTaggedDecorator(t,e),lazyMultiInject:r.makePropertyMultiInjectDecorator(t,e)}}},2675:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Symbol.for("INJECTION");function i(t,e,n,i){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:function(){return i&&!Reflect.hasMetadata(r,this,e)&&Reflect.defineMetadata(r,n(),this,e),Reflect.hasMetadata(r,this,e)?Reflect.getMetadata(r,this,e):n()},set:function(t){Reflect.defineMetadata(r,t,this,e)}})}e.makePropertyInjectDecorator=function(t,e){return function(n){return function(r,o){i(r,o,(function(){return t.get(n)}),e)}}},e.makePropertyInjectNamedDecorator=function(t,e){return function(n,r){return function(o,a){i(o,a,(function(){return t.getNamed(n,r)}),e)}}},e.makePropertyInjectTaggedDecorator=function(t,e){return function(n,r,o){return function(a,u){i(a,u,(function(){return t.getTagged(n,r,o)}),e)}}},e.makePropertyMultiInjectDecorator=function(t,e){return function(n){return function(r,o){i(r,o,(function(){return t.getAll(n)}),e)}}}},2676:function(t,e,n){t.exports=function(){"use strict";var t=function(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array||t instanceof Uint8ClampedArray},e=function(t,e){for(var n=Object.keys(e),r=0;r<n.length;++r)t[n[r]]=e[n[r]];return t},n="\n";function r(t){return"undefined"!==typeof atob?atob(t):"base64:"+t}function i(t){throw new Error("(regl) "+t)}function o(t,e){t||i(e)}function a(t){return t?": "+t:""}function u(t,e,n){t in e||i("unknown parameter ("+t+")"+a(n)+". possible values: "+Object.keys(e).join())}function s(e,n){t(e)||i("invalid parameter type"+a(n)+". must be a typed array")}function c(t,e){switch(e){case"number":return"number"===typeof t;case"object":return"object"===typeof t;case"string":return"string"===typeof t;case"boolean":return"boolean"===typeof t;case"function":return"function"===typeof t;case"undefined":return"undefined"===typeof t;case"symbol":return"symbol"===typeof t}}function f(t,e,n){c(t,e)||i("invalid parameter type"+a(n)+". expected "+e+", got "+typeof t)}function l(t,e){t>=0&&(0|t)===t||i("invalid parameter type, ("+t+")"+a(e)+". must be a nonnegative integer")}function h(t,e,n){e.indexOf(t)<0&&i("invalid value"+a(n)+". must be one of: "+e)}var d=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function p(t){Object.keys(t).forEach((function(t){d.indexOf(t)<0&&i('invalid regl constructor argument "'+t+'". must be one of '+d)}))}function m(t,e){for(t+="";t.length<e;)t=" "+t;return t}function v(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function g(t,e){this.number=t,this.line=e,this.errors=[]}function y(t,e,n){this.file=t,this.line=e,this.message=n}function b(){var t=new Error,e=(t.stack||t).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(e);if(n)return n[1];var r=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(e);return r?r[1]:"unknown"}function E(){var t=new Error,e=(t.stack||t).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(e);if(n)return n[1];var r=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(e);return r?r[1]:"unknown"}function _(t,e){var n=t.split("\n"),i=1,o=0,a={unknown:new v,0:new v};a.unknown.name=a[0].name=e||b(),a.unknown.lines.push(new g(0,""));for(var u=0;u<n.length;++u){var s=n[u],c=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(s);if(c)switch(c[1]){case"line":var f=/(\d+)(\s+\d+)?/.exec(c[2]);f&&(i=0|f[1],f[2]&&((o=0|f[2])in a||(a[o]=new v)));break;case"define":var l=/SHADER_NAME(_B64)?\s+(.*)$/.exec(c[2]);l&&(a[o].name=l[1]?r(l[2]):l[2])}a[o].lines.push(new g(i++,s))}return Object.keys(a).forEach((function(t){var e=a[t];e.lines.forEach((function(t){e.index[t.number]=t}))})),a}function w(t){var e=[];return t.split("\n").forEach((function(t){if(!(t.length<5)){var n=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(t);n?e.push(new y(0|n[1],0|n[2],n[3].trim())):t.length>0&&e.push(new y("unknown",0,t))}})),e}function x(t,e){e.forEach((function(e){var n=t[e.file];if(n){var r=n.index[e.line];if(r)return r.errors.push(e),void(n.hasErrors=!0)}t.unknown.hasErrors=!0,t.unknown.lines[0].errors.push(e)}))}function T(t,e,r,i,a){if(!t.getShaderParameter(e,t.COMPILE_STATUS)){var u=t.getShaderInfoLog(e),s=i===t.FRAGMENT_SHADER?"fragment":"vertex";I(r,"string",s+" shader source must be a string",a);var c=_(r,a),f=w(u);x(c,f),Object.keys(c).forEach((function(t){var e=c[t];if(e.hasErrors){var r=[""],i=[""];o("file number "+t+": "+e.name+"\n","color:red;text-decoration:underline;font-weight:bold"),e.lines.forEach((function(t){if(t.errors.length>0){o(m(t.number,4)+"|  ","background-color:yellow; font-weight:bold"),o(t.line+n,"color:red; background-color:yellow; font-weight:bold");var e=0;t.errors.forEach((function(r){var i=r.message,a=/^\s*'(.*)'\s*:\s*(.*)$/.exec(i);if(a){var u=a[1];i=a[2],"assign"===u&&(u="="),e=Math.max(t.line.indexOf(u,e),0)}else e=0;o(m("| ",6)),o(m("^^^",e+3)+n,"font-weight:bold"),o(m("| ",6)),o(i+n,"font-weight:bold")})),o(m("| ",6)+n)}else o(m(t.number,4)+"|  "),o(t.line+n,"color:red")})),"undefined"===typeof document||window.chrome||(i[0]=r.join("%c"))}function o(t,e){r.push(t),i.push(e||"")}})),o.raise("Error compiling "+s+" shader, "+c[0].name)}}function S(t,e,n,r,i){if(!t.getProgramParameter(e,t.LINK_STATUS)){t.getProgramInfoLog(e);var a=_(n,i),u='Error linking program with vertex shader, "'+_(r,i)[0].name+'", and fragment shader "'+a[0].name+'"';o.raise(u)}}function A(t){t._commandRef=b()}function O(t,e,n,r){function i(t){return t?r.id(t):0}function o(t,e){Object.keys(e).forEach((function(e){t[r.id(e)]=!0}))}A(t),t._fragId=i(t.static.frag),t._vertId=i(t.static.vert);var a=t._uniformSet={};o(a,e.static),o(a,e.dynamic);var u=t._attributeSet={};o(u,n.static),o(u,n.dynamic),t._hasCount="count"in t.static||"count"in t.dynamic||"elements"in t.static||"elements"in t.dynamic}function R(t,e){var n=E();i(t+" in command "+(e||b())+("unknown"===n?"":" called from "+n))}function C(t,e,n){t||R(e,n||b())}function M(t,e,n,r){t in e||R("unknown parameter ("+t+")"+a(n)+". possible values: "+Object.keys(e).join(),r||b())}function I(t,e,n,r){c(t,e)||R("invalid parameter type"+a(n)+". expected "+e+", got "+typeof t,r||b())}function N(t){t()}function k(t,e,n){t.texture?h(t.texture._texture.internalformat,e,"unsupported texture format for attachment"):h(t.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")}var P=33071,j=9728,D=9984,L=9985,B=9986,F=9987,U=5121,G=5122,V=5123,z=5124,H=5125,W=5126,q=32819,X=32820,Y=33635,K=34042,Q=36193,Z={};function J(t,e){return t===X||t===q||t===Y?2:t===K?4:Z[t]*e}function $(t){return!(t&t-1)&&!!t}function tt(t,e,n){var r,i=e.width,a=e.height,u=e.channels;o(i>0&&i<=n.maxTextureSize&&a>0&&a<=n.maxTextureSize,"invalid texture shape"),t.wrapS===P&&t.wrapT===P||o($(i)&&$(a),"incompatible wrap mode for texture, both width and height must be power of 2"),1===e.mipmask?1!==i&&1!==a&&o(t.minFilter!==D&&t.minFilter!==B&&t.minFilter!==L&&t.minFilter!==F,"min filter requires mipmap"):(o($(i)&&$(a),"texture must be a square power of 2 to support mipmapping"),o(e.mipmask===(i<<1)-1,"missing or incomplete mipmap data")),e.type===W&&(n.extensions.indexOf("oes_texture_float_linear")<0&&o(t.minFilter===j&&t.magFilter===j,"filter not supported, must enable oes_texture_float_linear"),o(!t.genMipmaps,"mipmap generation not supported with float textures"));var s=e.images;for(r=0;r<16;++r)if(s[r]){var c=i>>r,f=a>>r;o(e.mipmask&1<<r,"missing mipmap data");var l=s[r];if(o(l.width===c&&l.height===f,"invalid shape for mip images"),o(l.format===e.format&&l.internalformat===e.internalformat&&l.type===e.type,"incompatible type for mip image"),l.compressed);else if(l.data){var h=Math.ceil(J(l.type,u)*c/l.unpackAlignment)*l.unpackAlignment;o(l.data.byteLength===h*f,"invalid data for image, buffer size is inconsistent with image format")}else l.element||l.copy}else t.genMipmaps||o(0===(e.mipmask&1<<r),"extra mipmap data");e.compressed&&o(!t.genMipmaps,"mipmap generation for compressed images not supported")}function et(t,e,n,r){var i=t.width,a=t.height,u=t.channels;o(i>0&&i<=r.maxTextureSize&&a>0&&a<=r.maxTextureSize,"invalid texture shape"),o(i===a,"cube map must be square"),o(e.wrapS===P&&e.wrapT===P,"wrap mode not supported by cube map");for(var s=0;s<n.length;++s){var c=n[s];o(c.width===i&&c.height===a,"inconsistent cube map face shape"),e.genMipmaps&&(o(!c.compressed,"can not generate mipmap for compressed textures"),o(1===c.mipmask,"can not specify mipmaps and generate mipmaps"));for(var f=c.images,l=0;l<16;++l){var h=f[l];if(h){var d=i>>l,p=a>>l;o(c.mipmask&1<<l,"missing mipmap data"),o(h.width===d&&h.height===p,"invalid shape for mip images"),o(h.format===t.format&&h.internalformat===t.internalformat&&h.type===t.type,"incompatible type for mip image"),h.compressed||(h.data?o(h.data.byteLength===d*p*Math.max(J(h.type,u),h.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):h.element||h.copy)}}}}Z[5120]=Z[U]=1,Z[G]=Z[V]=Z[Q]=Z[Y]=Z[q]=Z[X]=2,Z[z]=Z[H]=Z[W]=Z[K]=4;var nt=e(o,{optional:N,raise:i,commandRaise:R,command:C,parameter:u,commandParameter:M,constructor:p,type:f,commandType:I,isTypedArray:s,nni:l,oneOf:h,shaderError:T,linkError:S,callSite:E,saveCommandRef:A,saveDrawInfo:O,framebufferFormat:k,guessCommand:b,texture2D:tt,textureCube:et}),rt=0,it=0,ot=5,at=6;function ut(t,e){this.id=rt++,this.type=t,this.data=e}function st(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function ct(t){if(0===t.length)return[];var e=t.charAt(0),n=t.charAt(t.length-1);if(t.length>1&&e===n&&('"'===e||"'"===e))return['"'+st(t.substr(1,t.length-2))+'"'];var r=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t);if(r)return ct(t.substr(0,r.index)).concat(ct(r[1])).concat(ct(t.substr(r.index+r[0].length)));var i=t.split(".");if(1===i.length)return['"'+st(t)+'"'];for(var o=[],a=0;a<i.length;++a)o=o.concat(ct(i[a]));return o}function ft(t){return"["+ct(t).join("][")+"]"}function lt(t,e){return new ut(t,ft(e+""))}function ht(t){return"function"===typeof t&&!t._reglType||t instanceof ut}function dt(t,e){return"function"===typeof t?new ut(it,t):"number"===typeof t||"boolean"===typeof t?new ut(ot,t):Array.isArray(t)?new ut(at,t.map((function(t,n){return dt(t,e+"["+n+"]")}))):t instanceof ut?t:void nt(!1,"invalid option type in uniform "+e)}var pt={DynamicVariable:ut,define:lt,isDynamic:ht,unbox:dt,accessor:ft},mt={next:"function"===typeof requestAnimationFrame?function(t){return requestAnimationFrame(t)}:function(t){return setTimeout(t,16)},cancel:"function"===typeof cancelAnimationFrame?function(t){return cancelAnimationFrame(t)}:clearTimeout},vt="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function gt(){var t={"":0},e=[""];return{id:function(n){var r=t[n];return r||(r=t[n]=e.length,e.push(n),r)},str:function(t){return e[t]}}}function yt(t,n,r){var i,o=document.createElement("canvas");function a(){var n=window.innerWidth,i=window.innerHeight;if(t!==document.body){var a=t.getBoundingClientRect();n=a.right-a.left,i=a.bottom-a.top}o.width=r*n,o.height=r*i,e(o.style,{width:n+"px",height:i+"px"})}function u(){i?i.disconnect():window.removeEventListener("resize",a),t.removeChild(o)}return e(o.style,{border:0,margin:0,padding:0,top:0,left:0}),t.appendChild(o),t===document.body&&(o.style.position="absolute",e(t.style,{margin:0,padding:0})),t!==document.body&&"function"===typeof ResizeObserver?(i=new ResizeObserver((function(){setTimeout(a)}))).observe(t):window.addEventListener("resize",a,!1),a(),{canvas:o,onDestroy:u}}function bt(t,e){function n(n){try{return t.getContext(n,e)}catch(r){return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}function Et(t){return"string"===typeof t.nodeName&&"function"===typeof t.appendChild&&"function"===typeof t.getBoundingClientRect}function _t(t){return"function"===typeof t.drawArrays||"function"===typeof t.drawElements}function wt(t){return"string"===typeof t?t.split():(nt(Array.isArray(t),"invalid extension array"),t)}function xt(t){return"string"===typeof t?(nt("undefined"!==typeof document,"not supported outside of DOM"),document.querySelector(t)):t}function Tt(t){var e,n,r,i,o=t||{},a={},u=[],s=[],c="undefined"===typeof window?1:window.devicePixelRatio,f=!1,l=function(t){t&&nt.raise(t)},h=function(){};if("string"===typeof o?(nt("undefined"!==typeof document,"selector queries only supported in DOM enviroments"),e=document.querySelector(o),nt(e,"invalid query string for element")):"object"===typeof o?Et(o)?e=o:_t(o)?r=(i=o).canvas:(nt.constructor(o),"gl"in o?i=o.gl:"canvas"in o?r=xt(o.canvas):"container"in o&&(n=xt(o.container)),"attributes"in o&&(a=o.attributes,nt.type(a,"object","invalid context attributes")),"extensions"in o&&(u=wt(o.extensions)),"optionalExtensions"in o&&(s=wt(o.optionalExtensions)),"onDone"in o&&(nt.type(o.onDone,"function","invalid or missing onDone callback"),l=o.onDone),"profile"in o&&(f=!!o.profile),"pixelRatio"in o&&(c=+o.pixelRatio,nt(c>0,"invalid pixel ratio"))):nt.raise("invalid arguments to regl"),e&&("canvas"===e.nodeName.toLowerCase()?r=e:n=e),!i){if(!r){nt("undefined"!==typeof document,"must manually specify webgl context outside of DOM environments");var d=yt(n||document.body,l,c);if(!d)return null;r=d.canvas,h=d.onDestroy}void 0===a.premultipliedAlpha&&(a.premultipliedAlpha=!0),i=bt(r,a)}return i?{gl:i,canvas:r,container:n,extensions:u,optionalExtensions:s,pixelRatio:c,profile:f,onDone:l,onDestroy:h}:(h(),l("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function St(t,e){var n={};function r(e){nt.type(e,"string","extension name must be string");var r,i=e.toLowerCase();try{r=n[i]=t.getExtension(i)}catch(o){}return!!r}for(var i=0;i<e.extensions.length;++i){var o=e.extensions[i];if(!r(o))return e.onDestroy(),e.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return e.optionalExtensions.forEach(r),{extensions:n,restore:function(){Object.keys(n).forEach((function(t){if(n[t]&&!r(t))throw new Error("(regl): error restoring extension "+t)}))}}}function At(t,e){for(var n=Array(t),r=0;r<t;++r)n[r]=e(r);return n}var Ot=5120,Rt=5121,Ct=5122,Mt=5123,It=5124,Nt=5125,kt=5126;function Pt(t){for(var e=16;e<=1<<28;e*=16)if(t<=e)return e;return 0}function jt(t){var e,n;return e=(t>65535)<<4,e|=n=((t>>>=e)>255)<<3,e|=n=((t>>>=n)>15)<<2,(e|=n=((t>>>=n)>3)<<1)|(t>>>=n)>>1}function Dt(){var t=At(8,(function(){return[]}));function e(e){var n=Pt(e),r=t[jt(n)>>2];return r.length>0?r.pop():new ArrayBuffer(n)}function n(e){t[jt(e.byteLength)>>2].push(e)}function r(t,n){var r=null;switch(t){case Ot:r=new Int8Array(e(n),0,n);break;case Rt:r=new Uint8Array(e(n),0,n);break;case Ct:r=new Int16Array(e(2*n),0,n);break;case Mt:r=new Uint16Array(e(2*n),0,n);break;case It:r=new Int32Array(e(4*n),0,n);break;case Nt:r=new Uint32Array(e(4*n),0,n);break;case kt:r=new Float32Array(e(4*n),0,n);break;default:return null}return r.length!==n?r.subarray(0,n):r}function i(t){n(t.buffer)}return{alloc:e,free:n,allocType:r,freeType:i}}var Lt=Dt();Lt.zero=Dt();var Bt=3408,Ft=3410,Ut=3411,Gt=3412,Vt=3413,zt=3414,Ht=3415,Wt=33901,qt=33902,Xt=3379,Yt=3386,Kt=34921,Qt=36347,Zt=36348,Jt=35661,$t=35660,te=34930,ee=36349,ne=34076,re=34024,ie=7936,oe=7937,ae=7938,ue=35724,se=34047,ce=36063,fe=34852,le=3553,he=34067,de=34069,pe=33984,me=6408,ve=5126,ge=5121,ye=36160,be=36053,Ee=36064,_e=16384,we=function(t,e){var n=1;e.ext_texture_filter_anisotropic&&(n=t.getParameter(se));var r=1,i=1;e.webgl_draw_buffers&&(r=t.getParameter(fe),i=t.getParameter(ce));var o=!!e.oes_texture_float;if(o){var a=t.createTexture();t.bindTexture(le,a),t.texImage2D(le,0,me,1,1,0,me,ve,null);var u=t.createFramebuffer();if(t.bindFramebuffer(ye,u),t.framebufferTexture2D(ye,Ee,le,a,0),t.bindTexture(le,null),t.checkFramebufferStatus(ye)!==be)o=!1;else{t.viewport(0,0,1,1),t.clearColor(1,0,0,1),t.clear(_e);var s=Lt.allocType(ve,4);t.readPixels(0,0,1,1,me,ve,s),t.getError()?o=!1:(t.deleteFramebuffer(u),t.deleteTexture(a),o=1===s[0]),Lt.freeType(s)}}var c=!0;if("undefined"===typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var f=t.createTexture(),l=Lt.allocType(ge,36);t.activeTexture(pe),t.bindTexture(he,f),t.texImage2D(de,0,me,3,3,0,me,ge,l),Lt.freeType(l),t.bindTexture(he,null),t.deleteTexture(f),c=!t.getError()}return{colorBits:[t.getParameter(Ft),t.getParameter(Ut),t.getParameter(Gt),t.getParameter(Vt)],depthBits:t.getParameter(zt),stencilBits:t.getParameter(Ht),subpixelBits:t.getParameter(Bt),extensions:Object.keys(e).filter((function(t){return!!e[t]})),maxAnisotropic:n,maxDrawbuffers:r,maxColorAttachments:i,pointSizeDims:t.getParameter(Wt),lineWidthDims:t.getParameter(qt),maxViewportDims:t.getParameter(Yt),maxCombinedTextureUnits:t.getParameter(Jt),maxCubeMapSize:t.getParameter(ne),maxRenderbufferSize:t.getParameter(re),maxTextureUnits:t.getParameter(te),maxTextureSize:t.getParameter(Xt),maxAttributes:t.getParameter(Kt),maxVertexUniforms:t.getParameter(Qt),maxVertexTextureUnits:t.getParameter($t),maxVaryingVectors:t.getParameter(Zt),maxFragmentUniforms:t.getParameter(ee),glsl:t.getParameter(ue),renderer:t.getParameter(oe),vendor:t.getParameter(ie),version:t.getParameter(ae),readFloat:o,npotTextureCube:c}};function xe(e){return!!e&&"object"===typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"===typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||t(e.data))}var Te=function(t){return Object.keys(t).map((function(e){return t[e]}))},Se={shape:Ie,flatten:Me};function Ae(t,e,n){for(var r=0;r<e;++r)n[r]=t[r]}function Oe(t,e,n,r){for(var i=0,o=0;o<e;++o)for(var a=t[o],u=0;u<n;++u)r[i++]=a[u]}function Re(t,e,n,r,i,o){for(var a=o,u=0;u<e;++u)for(var s=t[u],c=0;c<n;++c)for(var f=s[c],l=0;l<r;++l)i[a++]=f[l]}function Ce(t,e,n,r,i){for(var o=1,a=n+1;a<e.length;++a)o*=e[a];var u=e[n];if(e.length-n===4){var s=e[n+1],c=e[n+2],f=e[n+3];for(a=0;a<u;++a)Re(t[a],s,c,f,r,i),i+=o}else for(a=0;a<u;++a)Ce(t[a],e,n+1,r,i),i+=o}function Me(t,e,n,r){var i=1;if(e.length)for(var o=0;o<e.length;++o)i*=e[o];else i=0;var a=r||Lt.allocType(n,i);switch(e.length){case 0:break;case 1:Ae(t,e[0],a);break;case 2:Oe(t,e[0],e[1],a);break;case 3:Re(t,e[0],e[1],e[2],a,0);break;default:Ce(t,e,0,a,0)}return a}function Ie(t){for(var e=[],n=t;n.length;n=n[0])e.push(n.length);return e}var Ne={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},ke={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Pe={dynamic:35048,stream:35040,static:35044},je=Se.flatten,De=Se.shape,Le=35044,Be=35040,Fe=5121,Ue=5126,Ge=[];function Ve(t){return 0|Ne[Object.prototype.toString.call(t)]}function ze(t,e){for(var n=0;n<e.length;++n)t[n]=e[n]}function He(t,e,n,r,i,o,a){for(var u=0,s=0;s<n;++s)for(var c=0;c<r;++c)t[u++]=e[i*s+o*c+a]}function We(e,n,r,i){var o=0,a={};function u(t){this.id=o++,this.buffer=e.createBuffer(),this.type=t,this.usage=Le,this.byteLength=0,this.dimension=1,this.dtype=Fe,this.persistentData=null,r.profile&&(this.stats={size:0})}u.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},u.prototype.destroy=function(){d(this)};var s=[];function c(t,e){var n=s.pop();return n||(n=new u(t)),n.bind(),h(n,e,Be,0,1,!1),n}function f(t){s.push(t)}function l(t,n,r){t.byteLength=n.byteLength,e.bufferData(t.type,n,r)}function h(e,n,r,i,o,a){var u,s;if(e.usage=r,Array.isArray(n)){if(e.dtype=i||Ue,n.length>0)if(Array.isArray(n[0])){u=De(n);for(var c=1,f=1;f<u.length;++f)c*=u[f];e.dimension=c,l(e,s=je(n,u,e.dtype),r),a?e.persistentData=s:Lt.freeType(s)}else if("number"===typeof n[0]){e.dimension=o;var h=Lt.allocType(e.dtype,n.length);ze(h,n),l(e,h,r),a?e.persistentData=h:Lt.freeType(h)}else t(n[0])?(e.dimension=n[0].length,e.dtype=i||Ve(n[0])||Ue,l(e,s=je(n,[n.length,n[0].length],e.dtype),r),a?e.persistentData=s:Lt.freeType(s)):nt.raise("invalid buffer data")}else if(t(n))e.dtype=i||Ve(n),e.dimension=o,l(e,n,r),a&&(e.persistentData=new Uint8Array(new Uint8Array(n.buffer)));else if(xe(n)){u=n.shape;var d=n.stride,p=n.offset,m=0,v=0,g=0,y=0;1===u.length?(m=u[0],v=1,g=d[0],y=0):2===u.length?(m=u[0],v=u[1],g=d[0],y=d[1]):nt.raise("invalid shape"),e.dtype=i||Ve(n.data)||Ue,e.dimension=v;var b=Lt.allocType(e.dtype,m*v);He(b,n.data,m,v,g,y,p),l(e,b,r),a?e.persistentData=b:Lt.freeType(b)}else n instanceof ArrayBuffer?(e.dtype=Fe,e.dimension=o,l(e,n,r),a&&(e.persistentData=new Uint8Array(new Uint8Array(n)))):nt.raise("invalid buffer data")}function d(t){n.bufferCount--,i(t);var r=t.buffer;nt(r,"buffer must not be deleted already"),e.deleteBuffer(r),t.buffer=null,delete a[t.id]}function p(i,o,s,c){n.bufferCount++;var f=new u(o);function l(n){var i=Le,o=null,a=0,u=0,s=1;return Array.isArray(n)||t(n)||xe(n)||n instanceof ArrayBuffer?o=n:"number"===typeof n?a=0|n:n&&(nt.type(n,"object","buffer arguments must be an object, a number or an array"),"data"in n&&(nt(null===o||Array.isArray(o)||t(o)||xe(o),"invalid data for buffer"),o=n.data),"usage"in n&&(nt.parameter(n.usage,Pe,"invalid buffer usage"),i=Pe[n.usage]),"type"in n&&(nt.parameter(n.type,ke,"invalid buffer type"),u=ke[n.type]),"dimension"in n&&(nt.type(n.dimension,"number","invalid dimension"),s=0|n.dimension),"length"in n&&(nt.nni(a,"buffer length must be a nonnegative integer"),a=0|n.length)),f.bind(),o?h(f,o,i,u,s,c):(a&&e.bufferData(f.type,a,i),f.dtype=u||Fe,f.usage=i,f.dimension=s,f.byteLength=a),r.profile&&(f.stats.size=f.byteLength*Ge[f.dtype]),l}function p(t,n){nt(n+t.byteLength<=f.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+t.byteLength+" starting from offset "+n+" to a buffer of size "+f.byteLength),e.bufferSubData(f.type,n,t)}function m(e,n){var r,i=0|(n||0);if(f.bind(),t(e)||e instanceof ArrayBuffer)p(e,i);else if(Array.isArray(e)){if(e.length>0)if("number"===typeof e[0]){var o=Lt.allocType(f.dtype,e.length);ze(o,e),p(o,i),Lt.freeType(o)}else if(Array.isArray(e[0])||t(e[0])){r=De(e);var a=je(e,r,f.dtype);p(a,i),Lt.freeType(a)}else nt.raise("invalid buffer data")}else if(xe(e)){r=e.shape;var u=e.stride,s=0,c=0,h=0,d=0;1===r.length?(s=r[0],c=1,h=u[0],d=0):2===r.length?(s=r[0],c=r[1],h=u[0],d=u[1]):nt.raise("invalid shape");var m=Array.isArray(e.data)?f.dtype:Ve(e.data),v=Lt.allocType(m,s*c);He(v,e.data,s,c,h,d,e.offset),p(v,i),Lt.freeType(v)}else nt.raise("invalid data for buffer subdata");return l}return a[f.id]=f,s||l(i),l._reglType="buffer",l._buffer=f,l.subdata=m,r.profile&&(l.stats=f.stats),l.destroy=function(){d(f)},l}function m(){Te(a).forEach((function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)}))}return r.profile&&(n.getTotalBufferSize=function(){var t=0;return Object.keys(a).forEach((function(e){t+=a[e].stats.size})),t}),{create:p,createStream:c,destroyStream:f,clear:function(){Te(a).forEach(d),s.forEach(d)},getBuffer:function(t){return t&&t._buffer instanceof u?t._buffer:null},restore:m,_initBuffer:h}}Ge[5120]=1,Ge[5122]=2,Ge[5124]=4,Ge[5121]=1,Ge[5123]=2,Ge[5125]=4,Ge[5126]=4;var qe={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Xe=0,Ye=1,Ke=4,Qe=5120,Ze=5121,Je=5122,$e=5123,tn=5124,en=5125,nn=34963,rn=35040,on=35044;function an(e,n,r,i){var o={},a=0,u={uint8:Ze,uint16:$e};function s(t){this.id=a++,o[this.id]=this,this.buffer=t,this.primType=Ke,this.vertCount=0,this.type=0}n.oes_element_index_uint&&(u.uint32=en),s.prototype.bind=function(){this.buffer.bind()};var c=[];function f(t){var e=c.pop();return e||(e=new s(r.create(null,nn,!0,!1)._buffer)),h(e,t,rn,-1,-1,0,0),e}function l(t){c.push(t)}function h(i,o,a,u,s,c,f){var l;if(i.buffer.bind(),o){var h=f;f||t(o)&&(!xe(o)||t(o.data))||(h=n.oes_element_index_uint?en:$e),r._initBuffer(i.buffer,o,a,h,3)}else e.bufferData(nn,c,a),i.buffer.dtype=l||Ze,i.buffer.usage=a,i.buffer.dimension=3,i.buffer.byteLength=c;if(l=f,!f){switch(i.buffer.dtype){case Ze:case Qe:l=Ze;break;case $e:case Je:l=$e;break;case en:case tn:l=en;break;default:nt.raise("unsupported type for element array")}i.buffer.dtype=l}i.type=l,nt(l!==en||!!n.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var d=s;d<0&&(d=i.buffer.byteLength,l===$e?d>>=1:l===en&&(d>>=2)),i.vertCount=d;var p=u;if(u<0){p=Ke;var m=i.buffer.dimension;1===m&&(p=Xe),2===m&&(p=Ye),3===m&&(p=Ke)}i.primType=p}function d(t){i.elementsCount--,nt(null!==t.buffer,"must not double destroy elements"),delete o[t.id],t.buffer.destroy(),t.buffer=null}function p(e,n){var o=r.create(null,nn,!0),a=new s(o._buffer);function c(e){if(e)if("number"===typeof e)o(e),a.primType=Ke,a.vertCount=0|e,a.type=Ze;else{var n=null,r=on,i=-1,s=-1,f=0,l=0;Array.isArray(e)||t(e)||xe(e)?n=e:(nt.type(e,"object","invalid arguments for elements"),"data"in e&&(n=e.data,nt(Array.isArray(n)||t(n)||xe(n),"invalid data for element buffer")),"usage"in e&&(nt.parameter(e.usage,Pe,"invalid element buffer usage"),r=Pe[e.usage]),"primitive"in e&&(nt.parameter(e.primitive,qe,"invalid element buffer primitive"),i=qe[e.primitive]),"count"in e&&(nt("number"===typeof e.count&&e.count>=0,"invalid vertex count for elements"),s=0|e.count),"type"in e&&(nt.parameter(e.type,u,"invalid buffer type"),l=u[e.type]),"length"in e?f=0|e.length:(f=s,l===$e||l===Je?f*=2:l!==en&&l!==tn||(f*=4))),h(a,n,r,i,s,f,l)}else o(),a.primType=Ke,a.vertCount=0,a.type=Ze;return c}return i.elementsCount++,c(e),c._reglType="elements",c._elements=a,c.subdata=function(t,e){return o.subdata(t,e),c},c.destroy=function(){d(a)},c}return{create:p,createStream:f,destroyStream:l,getElements:function(t){return"function"===typeof t&&t._elements instanceof s?t._elements:null},clear:function(){Te(o).forEach(d)}}}var un=new Float32Array(1),sn=new Uint32Array(un.buffer),cn=5123;function fn(t){for(var e=Lt.allocType(cn,t.length),n=0;n<t.length;++n)if(isNaN(t[n]))e[n]=65535;else if(t[n]===1/0)e[n]=31744;else if(t[n]===-1/0)e[n]=64512;else{un[0]=t[n];var r=sn[0],i=r>>>31<<15,o=(r<<1>>>24)-127,a=r>>13&1023;if(o<-24)e[n]=i;else if(o<-14){var u=-14-o;e[n]=i+(a+1024>>u)}else e[n]=o>15?i+31744:i+(o+15<<10)+a}return e}function ln(e){return Array.isArray(e)||t(e)}var hn=function(t){return!(t&t-1)&&!!t},dn=34467,pn=3553,mn=34067,vn=34069,gn=6408,yn=6406,bn=6407,En=6409,_n=6410,wn=32854,xn=32855,Tn=36194,Sn=32819,An=32820,On=33635,Rn=34042,Cn=6402,Mn=34041,In=35904,Nn=35906,kn=36193,Pn=33776,jn=33777,Dn=33778,Ln=33779,Bn=35986,Fn=35987,Un=34798,Gn=35840,Vn=35841,zn=35842,Hn=35843,Wn=36196,qn=5121,Xn=5123,Yn=5125,Kn=5126,Qn=10242,Zn=10243,Jn=10497,$n=33071,tr=33648,er=10240,nr=10241,rr=9728,ir=9729,or=9984,ar=9985,ur=9986,sr=9987,cr=33170,fr=4352,lr=4353,hr=4354,dr=34046,pr=3317,mr=37440,vr=37441,gr=37443,yr=37444,br=33984,Er=[or,ur,ar,sr],_r=[0,En,_n,bn,gn],wr={};function xr(t){return"[object "+t+"]"}wr[En]=wr[yn]=wr[Cn]=1,wr[Mn]=wr[_n]=2,wr[bn]=wr[In]=3,wr[gn]=wr[Nn]=4;var Tr=xr("HTMLCanvasElement"),Sr=xr("OffscreenCanvas"),Ar=xr("CanvasRenderingContext2D"),Or=xr("ImageBitmap"),Rr=xr("HTMLImageElement"),Cr=xr("HTMLVideoElement"),Mr=Object.keys(Ne).concat([Tr,Sr,Ar,Or,Rr,Cr]),Ir=[];Ir[qn]=1,Ir[Kn]=4,Ir[kn]=2,Ir[Xn]=2,Ir[Yn]=4;var Nr=[];function kr(t){return Array.isArray(t)&&(0===t.length||"number"===typeof t[0])}function Pr(t){return!!Array.isArray(t)&&!(0===t.length||!ln(t[0]))}function jr(t){return Object.prototype.toString.call(t)}function Dr(t){return jr(t)===Tr}function Lr(t){return jr(t)===Sr}function Br(t){return jr(t)===Ar}function Fr(t){return jr(t)===Or}function Ur(t){return jr(t)===Rr}function Gr(t){return jr(t)===Cr}function Vr(t){if(!t)return!1;var e=jr(t);return Mr.indexOf(e)>=0||kr(t)||Pr(t)||xe(t)}function zr(t){return 0|Ne[Object.prototype.toString.call(t)]}function Hr(t,e){var n=e.length;switch(t.type){case qn:case Xn:case Yn:case Kn:var r=Lt.allocType(t.type,n);r.set(e),t.data=r;break;case kn:t.data=fn(e);break;default:nt.raise("unsupported texture type, must specify a typed array")}}function Wr(t,e){return Lt.allocType(t.type===kn?Kn:t.type,e)}function qr(t,e){t.type===kn?(t.data=fn(e),Lt.freeType(e)):t.data=e}function Xr(t,e,n,r,i,o){for(var a=t.width,u=t.height,s=t.channels,c=Wr(t,a*u*s),f=0,l=0;l<u;++l)for(var h=0;h<a;++h)for(var d=0;d<s;++d)c[f++]=e[n*h+r*l+i*d+o];qr(t,c)}function Yr(t,e,n,r,i,o){var a;if(a="undefined"!==typeof Nr[t]?Nr[t]:wr[t]*Ir[e],o&&(a*=6),i){for(var u=0,s=n;s>=1;)u+=a*s*s,s/=2;return u}return a*n*r}function Kr(n,r,i,o,a,u,s){var c={"don't care":fr,"dont care":fr,nice:hr,fast:lr},f={repeat:Jn,clamp:$n,mirror:tr},l={nearest:rr,linear:ir},h=e({mipmap:sr,"nearest mipmap nearest":or,"linear mipmap nearest":ar,"nearest mipmap linear":ur,"linear mipmap linear":sr},l),d={none:0,browser:yr},p={uint8:qn,rgba4:Sn,rgb565:On,"rgb5 a1":An},m={alpha:yn,luminance:En,"luminance alpha":_n,rgb:bn,rgba:gn,rgba4:wn,"rgb5 a1":xn,rgb565:Tn},v={};r.ext_srgb&&(m.srgb=In,m.srgba=Nn),r.oes_texture_float&&(p.float32=p.float=Kn),r.oes_texture_half_float&&(p.float16=p["half float"]=kn),r.webgl_depth_texture&&(e(m,{depth:Cn,"depth stencil":Mn}),e(p,{uint16:Xn,uint32:Yn,"depth stencil":Rn})),r.webgl_compressed_texture_s3tc&&e(v,{"rgb s3tc dxt1":Pn,"rgba s3tc dxt1":jn,"rgba s3tc dxt3":Dn,"rgba s3tc dxt5":Ln}),r.webgl_compressed_texture_atc&&e(v,{"rgb atc":Bn,"rgba atc explicit alpha":Fn,"rgba atc interpolated alpha":Un}),r.webgl_compressed_texture_pvrtc&&e(v,{"rgb pvrtc 4bppv1":Gn,"rgb pvrtc 2bppv1":Vn,"rgba pvrtc 4bppv1":zn,"rgba pvrtc 2bppv1":Hn}),r.webgl_compressed_texture_etc1&&(v["rgb etc1"]=Wn);var g=Array.prototype.slice.call(n.getParameter(dn));Object.keys(v).forEach((function(t){var e=v[t];g.indexOf(e)>=0&&(m[t]=e)}));var y=Object.keys(m);i.textureFormats=y;var b=[];Object.keys(m).forEach((function(t){var e=m[t];b[e]=t}));var E=[];Object.keys(p).forEach((function(t){var e=p[t];E[e]=t}));var _=[];Object.keys(l).forEach((function(t){var e=l[t];_[e]=t}));var w=[];Object.keys(h).forEach((function(t){var e=h[t];w[e]=t}));var x=[];Object.keys(f).forEach((function(t){var e=f[t];x[e]=t}));var T=y.reduce((function(t,e){var n=m[e];return n===En||n===yn||n===En||n===_n||n===Cn||n===Mn||r.ext_srgb&&(n===In||n===Nn)?t[n]=n:n===xn||e.indexOf("rgba")>=0?t[n]=gn:t[n]=bn,t}),{});function S(){this.internalformat=gn,this.format=gn,this.type=qn,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=yr,this.width=0,this.height=0,this.channels=0}function A(t,e){t.internalformat=e.internalformat,t.format=e.format,t.type=e.type,t.compressed=e.compressed,t.premultiplyAlpha=e.premultiplyAlpha,t.flipY=e.flipY,t.unpackAlignment=e.unpackAlignment,t.colorSpace=e.colorSpace,t.width=e.width,t.height=e.height,t.channels=e.channels}function O(t,e){if("object"===typeof e&&e){if("premultiplyAlpha"in e&&(nt.type(e.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),t.premultiplyAlpha=e.premultiplyAlpha),"flipY"in e&&(nt.type(e.flipY,"boolean","invalid texture flip"),t.flipY=e.flipY),"alignment"in e&&(nt.oneOf(e.alignment,[1,2,4,8],"invalid texture unpack alignment"),t.unpackAlignment=e.alignment),"colorSpace"in e&&(nt.parameter(e.colorSpace,d,"invalid colorSpace"),t.colorSpace=d[e.colorSpace]),"type"in e){var n=e.type;nt(r.oes_texture_float||!("float"===n||"float32"===n),"you must enable the OES_texture_float extension in order to use floating point textures."),nt(r.oes_texture_half_float||!("half float"===n||"float16"===n),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),nt(r.webgl_depth_texture||!("uint16"===n||"uint32"===n||"depth stencil"===n),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),nt.parameter(n,p,"invalid texture type"),t.type=p[n]}var o=t.width,a=t.height,u=t.channels,s=!1;"shape"in e?(nt(Array.isArray(e.shape)&&e.shape.length>=2,"shape must be an array"),o=e.shape[0],a=e.shape[1],3===e.shape.length&&(u=e.shape[2],nt(u>0&&u<=4,"invalid number of channels"),s=!0),nt(o>=0&&o<=i.maxTextureSize,"invalid width"),nt(a>=0&&a<=i.maxTextureSize,"invalid height")):("radius"in e&&(o=a=e.radius,nt(o>=0&&o<=i.maxTextureSize,"invalid radius")),"width"in e&&(o=e.width,nt(o>=0&&o<=i.maxTextureSize,"invalid width")),"height"in e&&(a=e.height,nt(a>=0&&a<=i.maxTextureSize,"invalid height")),"channels"in e&&(u=e.channels,nt(u>0&&u<=4,"invalid number of channels"),s=!0)),t.width=0|o,t.height=0|a,t.channels=0|u;var c=!1;if("format"in e){var f=e.format;nt(r.webgl_depth_texture||!("depth"===f||"depth stencil"===f),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),nt.parameter(f,m,"invalid texture format");var l=t.internalformat=m[f];t.format=T[l],f in p&&("type"in e||(t.type=p[f])),f in v&&(t.compressed=!0),c=!0}!s&&c?t.channels=wr[t.format]:s&&!c?t.channels!==_r[t.format]&&(t.format=t.internalformat=_r[t.channels]):c&&s&&nt(t.channels===wr[t.format],"number of channels inconsistent with specified format")}}function R(t){n.pixelStorei(mr,t.flipY),n.pixelStorei(vr,t.premultiplyAlpha),n.pixelStorei(gr,t.colorSpace),n.pixelStorei(pr,t.unpackAlignment)}function C(){S.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function M(e,n){var r=null;if(Vr(n)?r=n:n&&(nt.type(n,"object","invalid pixel data type"),O(e,n),"x"in n&&(e.xOffset=0|n.x),"y"in n&&(e.yOffset=0|n.y),Vr(n.data)&&(r=n.data)),nt(!e.compressed||r instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),n.copy){nt(!r,"can not specify copy and data field for the same texture");var o=a.viewportWidth,u=a.viewportHeight;e.width=e.width||o-e.xOffset,e.height=e.height||u-e.yOffset,e.needsCopy=!0,nt(e.xOffset>=0&&e.xOffset<o&&e.yOffset>=0&&e.yOffset<u&&e.width>0&&e.width<=o&&e.height>0&&e.height<=u,"copy texture read out of bounds")}else if(r){if(t(r))e.channels=e.channels||4,e.data=r,"type"in n||e.type!==qn||(e.type=zr(r));else if(kr(r))e.channels=e.channels||4,Hr(e,r),e.alignment=1,e.needsFree=!0;else if(xe(r)){var s=r.data;Array.isArray(s)||e.type!==qn||(e.type=zr(s));var c,f,l,h,d,p,m=r.shape,v=r.stride;3===m.length?(l=m[2],p=v[2]):(nt(2===m.length,"invalid ndarray pixel data, must be 2 or 3D"),l=1,p=1),c=m[0],f=m[1],h=v[0],d=v[1],e.alignment=1,e.width=c,e.height=f,e.channels=l,e.format=e.internalformat=_r[l],e.needsFree=!0,Xr(e,s,h,d,p,r.offset)}else if(Dr(r)||Lr(r)||Br(r))Dr(r)||Lr(r)?e.element=r:e.element=r.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(Fr(r))e.element=r,e.width=r.width,e.height=r.height,e.channels=4;else if(Ur(r))e.element=r,e.width=r.naturalWidth,e.height=r.naturalHeight,e.channels=4;else if(Gr(r))e.element=r,e.width=r.videoWidth,e.height=r.videoHeight,e.channels=4;else if(Pr(r)){var g=e.width||r[0].length,y=e.height||r.length,b=e.channels;b=ln(r[0][0])?b||r[0][0].length:b||1;for(var E=Se.shape(r),_=1,w=0;w<E.length;++w)_*=E[w];var x=Wr(e,_);Se.flatten(r,E,"",x),qr(e,x),e.alignment=1,e.width=g,e.height=y,e.channels=b,e.format=e.internalformat=_r[b],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;e.type===Kn?nt(i.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):e.type===kn&&nt(i.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function I(t,e,r){var i=t.element,a=t.data,u=t.internalformat,s=t.format,c=t.type,f=t.width,l=t.height;R(t),i?n.texImage2D(e,r,s,s,c,i):t.compressed?n.compressedTexImage2D(e,r,u,f,l,0,a):t.needsCopy?(o(),n.copyTexImage2D(e,r,s,t.xOffset,t.yOffset,f,l,0)):n.texImage2D(e,r,s,f,l,0,s,c,a||null)}function N(t,e,r,i,a){var u=t.element,s=t.data,c=t.internalformat,f=t.format,l=t.type,h=t.width,d=t.height;R(t),u?n.texSubImage2D(e,a,r,i,f,l,u):t.compressed?n.compressedTexSubImage2D(e,a,r,i,c,h,d,s):t.needsCopy?(o(),n.copyTexSubImage2D(e,a,r,i,t.xOffset,t.yOffset,h,d)):n.texSubImage2D(e,a,r,i,h,d,f,l,s)}var k=[];function P(){return k.pop()||new C}function j(t){t.needsFree&&Lt.freeType(t.data),C.call(t),k.push(t)}function D(){S.call(this),this.genMipmaps=!1,this.mipmapHint=fr,this.mipmask=0,this.images=Array(16)}function L(t,e,n){var r=t.images[0]=P();t.mipmask=1,r.width=t.width=e,r.height=t.height=n,r.channels=t.channels=4}function B(t,e){var n=null;if(Vr(e))A(n=t.images[0]=P(),t),M(n,e),t.mipmask=1;else if(O(t,e),Array.isArray(e.mipmap))for(var r=e.mipmap,i=0;i<r.length;++i)A(n=t.images[i]=P(),t),n.width>>=i,n.height>>=i,M(n,r[i]),t.mipmask|=1<<i;else A(n=t.images[0]=P(),t),M(n,e),t.mipmask=1;A(t,t.images[0]),!t.compressed||t.internalformat!==Pn&&t.internalformat!==jn&&t.internalformat!==Dn&&t.internalformat!==Ln||nt(t.width%4===0&&t.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function F(t,e){for(var n=t.images,r=0;r<n.length;++r){if(!n[r])return;I(n[r],e,r)}}var U=[];function G(){var t=U.pop()||new D;S.call(t),t.mipmask=0;for(var e=0;e<16;++e)t.images[e]=null;return t}function V(t){for(var e=t.images,n=0;n<e.length;++n)e[n]&&j(e[n]),e[n]=null;U.push(t)}function z(){this.minFilter=rr,this.magFilter=rr,this.wrapS=$n,this.wrapT=$n,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=fr}function H(t,e){if("min"in e){var n=e.min;nt.parameter(n,h),t.minFilter=h[n],Er.indexOf(t.minFilter)>=0&&!("faces"in e)&&(t.genMipmaps=!0)}if("mag"in e){var r=e.mag;nt.parameter(r,l),t.magFilter=l[r]}var o=t.wrapS,a=t.wrapT;if("wrap"in e){var u=e.wrap;"string"===typeof u?(nt.parameter(u,f),o=a=f[u]):Array.isArray(u)&&(nt.parameter(u[0],f),nt.parameter(u[1],f),o=f[u[0]],a=f[u[1]])}else{if("wrapS"in e){var s=e.wrapS;nt.parameter(s,f),o=f[s]}if("wrapT"in e){var d=e.wrapT;nt.parameter(d,f),a=f[d]}}if(t.wrapS=o,t.wrapT=a,"anisotropic"in e){var p=e.anisotropic;nt("number"===typeof p&&p>=1&&p<=i.maxAnisotropic,"aniso samples must be between 1 and "),t.anisotropic=e.anisotropic}if("mipmap"in e){var m=!1;switch(typeof e.mipmap){case"string":nt.parameter(e.mipmap,c,"invalid mipmap hint"),t.mipmapHint=c[e.mipmap],t.genMipmaps=!0,m=!0;break;case"boolean":m=t.genMipmaps=e.mipmap;break;case"object":nt(Array.isArray(e.mipmap),"invalid mipmap type"),t.genMipmaps=!1,m=!0;break;default:nt.raise("invalid mipmap type")}m&&!("min"in e)&&(t.minFilter=or)}}function W(t,e){n.texParameteri(e,nr,t.minFilter),n.texParameteri(e,er,t.magFilter),n.texParameteri(e,Qn,t.wrapS),n.texParameteri(e,Zn,t.wrapT),r.ext_texture_filter_anisotropic&&n.texParameteri(e,dr,t.anisotropic),t.genMipmaps&&(n.hint(cr,t.mipmapHint),n.generateMipmap(e))}var q=0,X={},Y=i.maxTextureUnits,K=Array(Y).map((function(){return null}));function Q(t){S.call(this),this.mipmask=0,this.internalformat=gn,this.id=q++,this.refCount=1,this.target=t,this.texture=n.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new z,s.profile&&(this.stats={size:0})}function Z(t){n.activeTexture(br),n.bindTexture(t.target,t.texture)}function J(){var t=K[0];t?n.bindTexture(t.target,t.texture):n.bindTexture(pn,null)}function $(t){var e=t.texture;nt(e,"must not double destroy texture");var r=t.unit,i=t.target;r>=0&&(n.activeTexture(br+r),n.bindTexture(i,null),K[r]=null),n.deleteTexture(e),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete X[t.id],u.textureCount--}function tt(t,e){var r=new Q(pn);function o(t,e){var n=r.texInfo;z.call(n);var a=G();return"number"===typeof t?L(a,0|t,"number"===typeof e?0|e:0|t):t?(nt.type(t,"object","invalid arguments to regl.texture"),H(n,t),B(a,t)):L(a,1,1),n.genMipmaps&&(a.mipmask=(a.width<<1)-1),r.mipmask=a.mipmask,A(r,a),nt.texture2D(n,a,i),r.internalformat=a.internalformat,o.width=a.width,o.height=a.height,Z(r),F(a,pn),W(n,pn),J(),V(a),s.profile&&(r.stats.size=Yr(r.internalformat,r.type,a.width,a.height,n.genMipmaps,!1)),o.format=b[r.internalformat],o.type=E[r.type],o.mag=_[n.magFilter],o.min=w[n.minFilter],o.wrapS=x[n.wrapS],o.wrapT=x[n.wrapT],o}function a(t,e,n,i){nt(!!t,"must specify image data");var a=0|e,u=0|n,s=0|i,c=P();return A(c,r),c.width=0,c.height=0,M(c,t),c.width=c.width||(r.width>>s)-a,c.height=c.height||(r.height>>s)-u,nt(r.type===c.type&&r.format===c.format&&r.internalformat===c.internalformat,"incompatible format for texture.subimage"),nt(a>=0&&u>=0&&a+c.width<=r.width&&u+c.height<=r.height,"texture.subimage write out of bounds"),nt(r.mipmask&1<<s,"missing mipmap data"),nt(c.data||c.element||c.needsCopy,"missing image data"),Z(r),N(c,pn,a,u,s),J(),j(c),o}function c(t,e){var i=0|t,a=0|e||i;if(i===r.width&&a===r.height)return o;o.width=r.width=i,o.height=r.height=a,Z(r);for(var u=0;r.mipmask>>u;++u){var c=i>>u,f=a>>u;if(!c||!f)break;n.texImage2D(pn,u,r.format,c,f,0,r.format,r.type,null)}return J(),s.profile&&(r.stats.size=Yr(r.internalformat,r.type,i,a,!1,!1)),o}return X[r.id]=r,u.textureCount++,o(t,e),o.subimage=a,o.resize=c,o._reglType="texture2d",o._texture=r,s.profile&&(o.stats=r.stats),o.destroy=function(){r.decRef()},o}function et(t,e,r,o,a,c){var f=new Q(mn);X[f.id]=f,u.cubeCount++;var l=new Array(6);function h(t,e,n,r,o,a){var u,c=f.texInfo;for(z.call(c),u=0;u<6;++u)l[u]=G();if("number"!==typeof t&&t)if("object"===typeof t)if(e)B(l[0],t),B(l[1],e),B(l[2],n),B(l[3],r),B(l[4],o),B(l[5],a);else if(H(c,t),O(f,t),"faces"in t){var d=t.faces;for(nt(Array.isArray(d)&&6===d.length,"cube faces must be a length 6 array"),u=0;u<6;++u)nt("object"===typeof d[u]&&!!d[u],"invalid input for cube map face"),A(l[u],f),B(l[u],d[u])}else for(u=0;u<6;++u)B(l[u],t);else nt.raise("invalid arguments to cube map");else{var p=0|t||1;for(u=0;u<6;++u)L(l[u],p,p)}for(A(f,l[0]),i.npotTextureCube||nt(hn(f.width)&&hn(f.height),"your browser does not support non power or two texture dimensions"),c.genMipmaps?f.mipmask=(l[0].width<<1)-1:f.mipmask=l[0].mipmask,nt.textureCube(f,c,l,i),f.internalformat=l[0].internalformat,h.width=l[0].width,h.height=l[0].height,Z(f),u=0;u<6;++u)F(l[u],vn+u);for(W(c,mn),J(),s.profile&&(f.stats.size=Yr(f.internalformat,f.type,h.width,h.height,c.genMipmaps,!0)),h.format=b[f.internalformat],h.type=E[f.type],h.mag=_[c.magFilter],h.min=w[c.minFilter],h.wrapS=x[c.wrapS],h.wrapT=x[c.wrapT],u=0;u<6;++u)V(l[u]);return h}function d(t,e,n,r,i){nt(!!e,"must specify image data"),nt("number"===typeof t&&t===(0|t)&&t>=0&&t<6,"invalid face");var o=0|n,a=0|r,u=0|i,s=P();return A(s,f),s.width=0,s.height=0,M(s,e),s.width=s.width||(f.width>>u)-o,s.height=s.height||(f.height>>u)-a,nt(f.type===s.type&&f.format===s.format&&f.internalformat===s.internalformat,"incompatible format for texture.subimage"),nt(o>=0&&a>=0&&o+s.width<=f.width&&a+s.height<=f.height,"texture.subimage write out of bounds"),nt(f.mipmask&1<<u,"missing mipmap data"),nt(s.data||s.element||s.needsCopy,"missing image data"),Z(f),N(s,vn+t,o,a,u),J(),j(s),h}function p(t){var e=0|t;if(e!==f.width){h.width=f.width=e,h.height=f.height=e,Z(f);for(var r=0;r<6;++r)for(var i=0;f.mipmask>>i;++i)n.texImage2D(vn+r,i,f.format,e>>i,e>>i,0,f.format,f.type,null);return J(),s.profile&&(f.stats.size=Yr(f.internalformat,f.type,h.width,h.height,!1,!0)),h}}return h(t,e,r,o,a,c),h.subimage=d,h.resize=p,h._reglType="textureCube",h._texture=f,s.profile&&(h.stats=f.stats),h.destroy=function(){f.decRef()},h}function rt(){for(var t=0;t<Y;++t)n.activeTexture(br+t),n.bindTexture(pn,null),K[t]=null;Te(X).forEach($),u.cubeCount=0,u.textureCount=0}function it(){for(var t=0;t<Y;++t){var e=K[t];e&&(e.bindCount=0,e.unit=-1,K[t]=null)}Te(X).forEach((function(t){t.texture=n.createTexture(),n.bindTexture(t.target,t.texture);for(var e=0;e<32;++e)if(0!==(t.mipmask&1<<e))if(t.target===pn)n.texImage2D(pn,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);else for(var r=0;r<6;++r)n.texImage2D(vn+r,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);W(t.texInfo,t.target)}))}function ot(){for(var t=0;t<Y;++t){var e=K[t];e&&(e.bindCount=0,e.unit=-1,K[t]=null),n.activeTexture(br+t),n.bindTexture(pn,null),n.bindTexture(mn,null)}}return e(Q.prototype,{bind:function(){var t=this;t.bindCount+=1;var e=t.unit;if(e<0){for(var r=0;r<Y;++r){var i=K[r];if(i){if(i.bindCount>0)continue;i.unit=-1}K[r]=t,e=r;break}e>=Y&&nt.raise("insufficient number of texture units"),s.profile&&u.maxTextureUnits<e+1&&(u.maxTextureUnits=e+1),t.unit=e,n.activeTexture(br+e),n.bindTexture(t.target,t.texture)}return e},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&$(this)}}),s.profile&&(u.getTotalTextureSize=function(){var t=0;return Object.keys(X).forEach((function(e){t+=X[e].stats.size})),t}),{create2D:tt,createCube:et,clear:rt,getTexture:function(t){return null},restore:it,refresh:ot}}Nr[wn]=2,Nr[xn]=2,Nr[Tn]=2,Nr[Mn]=4,Nr[Pn]=.5,Nr[jn]=.5,Nr[Dn]=1,Nr[Ln]=1,Nr[Bn]=.5,Nr[Fn]=1,Nr[Un]=1,Nr[Gn]=.5,Nr[Vn]=.25,Nr[zn]=.5,Nr[Hn]=.25,Nr[Wn]=.5;var Qr=36161,Zr=32854,Jr=32855,$r=36194,ti=33189,ei=36168,ni=34041,ri=35907,ii=34836,oi=34842,ai=34843,ui=[];function si(t,e,n){return ui[t]*e*n}ui[Zr]=2,ui[Jr]=2,ui[$r]=2,ui[ti]=2,ui[ei]=1,ui[ni]=4,ui[ri]=4,ui[ii]=16,ui[oi]=8,ui[ai]=6;var ci=function(t,e,n,r,i){var o={rgba4:Zr,rgb565:$r,"rgb5 a1":Jr,depth:ti,stencil:ei,"depth stencil":ni};e.ext_srgb&&(o.srgba=ri),e.ext_color_buffer_half_float&&(o.rgba16f=oi,o.rgb16f=ai),e.webgl_color_buffer_float&&(o.rgba32f=ii);var a=[];Object.keys(o).forEach((function(t){var e=o[t];a[e]=t}));var u=0,s={};function c(t){this.id=u++,this.refCount=1,this.renderbuffer=t,this.format=Zr,this.width=0,this.height=0,i.profile&&(this.stats={size:0})}function f(e){var n=e.renderbuffer;nt(n,"must not double destroy renderbuffer"),t.bindRenderbuffer(Qr,null),t.deleteRenderbuffer(n),e.renderbuffer=null,e.refCount=0,delete s[e.id],r.renderbufferCount--}function l(e,u){var f=new c(t.createRenderbuffer());function l(e,r){var u=0,s=0,c=Zr;if("object"===typeof e&&e){var h=e;if("shape"in h){var d=h.shape;nt(Array.isArray(d)&&d.length>=2,"invalid renderbuffer shape"),u=0|d[0],s=0|d[1]}else"radius"in h&&(u=s=0|h.radius),"width"in h&&(u=0|h.width),"height"in h&&(s=0|h.height);"format"in h&&(nt.parameter(h.format,o,"invalid renderbuffer format"),c=o[h.format])}else"number"===typeof e?(u=0|e,s="number"===typeof r?0|r:u):e?nt.raise("invalid arguments to renderbuffer constructor"):u=s=1;if(nt(u>0&&s>0&&u<=n.maxRenderbufferSize&&s<=n.maxRenderbufferSize,"invalid renderbuffer size"),u!==f.width||s!==f.height||c!==f.format)return l.width=f.width=u,l.height=f.height=s,f.format=c,t.bindRenderbuffer(Qr,f.renderbuffer),t.renderbufferStorage(Qr,c,u,s),nt(0===t.getError(),"invalid render buffer format"),i.profile&&(f.stats.size=si(f.format,f.width,f.height)),l.format=a[f.format],l}function h(e,r){var o=0|e,a=0|r||o;return o===f.width&&a===f.height||(nt(o>0&&a>0&&o<=n.maxRenderbufferSize&&a<=n.maxRenderbufferSize,"invalid renderbuffer size"),l.width=f.width=o,l.height=f.height=a,t.bindRenderbuffer(Qr,f.renderbuffer),t.renderbufferStorage(Qr,f.format,o,a),nt(0===t.getError(),"invalid render buffer format"),i.profile&&(f.stats.size=si(f.format,f.width,f.height))),l}return s[f.id]=f,r.renderbufferCount++,l(e,u),l.resize=h,l._reglType="renderbuffer",l._renderbuffer=f,i.profile&&(l.stats=f.stats),l.destroy=function(){f.decRef()},l}function h(){Te(s).forEach((function(e){e.renderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(Qr,e.renderbuffer),t.renderbufferStorage(Qr,e.format,e.width,e.height)})),t.bindRenderbuffer(Qr,null)}return c.prototype.decRef=function(){--this.refCount<=0&&f(this)},i.profile&&(r.getTotalRenderbufferSize=function(){var t=0;return Object.keys(s).forEach((function(e){t+=s[e].stats.size})),t}),{create:l,clear:function(){Te(s).forEach(f)},restore:h}},fi=36160,li=36161,hi=3553,di=34069,pi=36064,mi=36096,vi=36128,gi=33306,yi=36053,bi=36054,Ei=36055,_i=36057,wi=36061,xi=36193,Ti=5121,Si=5126,Ai=6407,Oi=6408,Ri=6402,Ci=[Ai,Oi],Mi=[];Mi[Oi]=4,Mi[Ai]=3;var Ii=[];Ii[Ti]=1,Ii[Si]=4,Ii[xi]=2;var Ni=33189,ki=36168,Pi=34041,ji=[32854,32855,36194,35907,34842,34843,34836],Di={};function Li(t,n,r,i,o,a){var u={cur:null,next:null,dirty:!1,setFBO:null},s=["rgba"],c=["rgba4","rgb565","rgb5 a1"];n.ext_srgb&&c.push("srgba"),n.ext_color_buffer_half_float&&c.push("rgba16f","rgb16f"),n.webgl_color_buffer_float&&c.push("rgba32f");var f=["uint8"];function l(t,e,n){this.target=t,this.texture=e,this.renderbuffer=n;var r=0,i=0;e?(r=e.width,i=e.height):n&&(r=n.width,i=n.height),this.width=r,this.height=i}function h(t){t&&(t.texture&&t.texture._texture.decRef(),t.renderbuffer&&t.renderbuffer._renderbuffer.decRef())}function d(t,e,n){if(t)if(t.texture){var r=t.texture._texture,i=Math.max(1,r.width),o=Math.max(1,r.height);nt(i===e&&o===n,"inconsistent width/height for supplied texture"),r.refCount+=1}else{var a=t.renderbuffer._renderbuffer;nt(a.width===e&&a.height===n,"inconsistent width/height for renderbuffer"),a.refCount+=1}}function p(e,n){n&&(n.texture?t.framebufferTexture2D(fi,e,n.target,n.texture._texture.texture,0):t.framebufferRenderbuffer(fi,e,li,n.renderbuffer._renderbuffer.renderbuffer))}function m(t){var e=hi,n=null,r=null,i=t;"object"===typeof t&&(i=t.data,"target"in t&&(e=0|t.target)),nt.type(i,"function","invalid attachment data");var o=i._reglType;return"texture2d"===o?(n=i,nt(e===hi)):"textureCube"===o?(n=i,nt(e>=di&&e<di+6,"invalid cube map target")):"renderbuffer"===o?(r=i,e=li):nt.raise("invalid regl object for attachment"),new l(e,n,r)}function v(t,e,n,r,a){if(n){var u=i.create2D({width:t,height:e,format:r,type:a});return u._texture.refCount=0,new l(hi,u,null)}var s=o.create({width:t,height:e,format:r});return s._renderbuffer.refCount=0,new l(li,null,s)}function g(t){return t&&(t.texture||t.renderbuffer)}function y(t,e,n){t&&(t.texture?t.texture.resize(e,n):t.renderbuffer&&t.renderbuffer.resize(e,n),t.width=e,t.height=n)}n.oes_texture_half_float&&f.push("half float","float16"),n.oes_texture_float&&f.push("float","float32");var b=0,E={};function _(){this.id=b++,E[this.id]=this,this.framebuffer=t.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function w(t){t.colorAttachments.forEach(h),h(t.depthAttachment),h(t.stencilAttachment),h(t.depthStencilAttachment)}function x(e){var n=e.framebuffer;nt(n,"must not double destroy framebuffer"),t.deleteFramebuffer(n),e.framebuffer=null,a.framebufferCount--,delete E[e.id]}function T(e){var n;t.bindFramebuffer(fi,e.framebuffer);var i=e.colorAttachments;for(n=0;n<i.length;++n)p(pi+n,i[n]);for(n=i.length;n<r.maxColorAttachments;++n)t.framebufferTexture2D(fi,pi+n,hi,null,0);t.framebufferTexture2D(fi,gi,hi,null,0),t.framebufferTexture2D(fi,mi,hi,null,0),t.framebufferTexture2D(fi,vi,hi,null,0),p(mi,e.depthAttachment),p(vi,e.stencilAttachment),p(gi,e.depthStencilAttachment);var o=t.checkFramebufferStatus(fi);t.isContextLost()||o===yi||nt.raise("framebuffer configuration not supported, status = "+Di[o]),t.bindFramebuffer(fi,u.next?u.next.framebuffer:null),u.cur=u.next,t.getError()}function S(t,i){var o=new _;function l(t,e){var i;nt(u.next!==o,"can not update framebuffer which is currently in use");var a=0,h=0,p=!0,y=!0,b=null,E=!0,_="rgba",x="uint8",S=1,A=null,O=null,R=null,C=!1;if("number"===typeof t)a=0|t,h=0|e||a;else if(t){nt.type(t,"object","invalid arguments for framebuffer");var M=t;if("shape"in M){var I=M.shape;nt(Array.isArray(I)&&I.length>=2,"invalid shape for framebuffer"),a=I[0],h=I[1]}else"radius"in M&&(a=h=M.radius),"width"in M&&(a=M.width),"height"in M&&(h=M.height);("color"in M||"colors"in M)&&(b=M.color||M.colors,Array.isArray(b)&&nt(1===b.length||n.webgl_draw_buffers,"multiple render targets not supported")),b||("colorCount"in M&&(S=0|M.colorCount,nt(S>0,"invalid color buffer count")),"colorTexture"in M&&(E=!!M.colorTexture,_="rgba4"),"colorType"in M&&(x=M.colorType,E?(nt(n.oes_texture_float||!("float"===x||"float32"===x),"you must enable OES_texture_float in order to use floating point framebuffer objects"),nt(n.oes_texture_half_float||!("half float"===x||"float16"===x),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===x||"float16"===x?(nt(n.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),_="rgba16f"):"float"!==x&&"float32"!==x||(nt(n.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),_="rgba32f"),nt.oneOf(x,f,"invalid color type")),"colorFormat"in M&&(_=M.colorFormat,s.indexOf(_)>=0?E=!0:c.indexOf(_)>=0?E=!1:E?nt.oneOf(M.colorFormat,s,"invalid color format for texture"):nt.oneOf(M.colorFormat,c,"invalid color format for renderbuffer"))),("depthTexture"in M||"depthStencilTexture"in M)&&(C=!(!M.depthTexture&&!M.depthStencilTexture),nt(!C||n.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in M&&("boolean"===typeof M.depth?p=M.depth:(A=M.depth,y=!1)),"stencil"in M&&("boolean"===typeof M.stencil?y=M.stencil:(O=M.stencil,p=!1)),"depthStencil"in M&&("boolean"===typeof M.depthStencil?p=y=M.depthStencil:(R=M.depthStencil,p=!1,y=!1))}else a=h=1;var N=null,k=null,P=null,j=null;if(Array.isArray(b))N=b.map(m);else if(b)N=[m(b)];else for(N=new Array(S),i=0;i<S;++i)N[i]=v(a,h,E,_,x);nt(n.webgl_draw_buffers||N.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),nt(N.length<=r.maxColorAttachments,"too many color attachments, not supported"),a=a||N[0].width,h=h||N[0].height,A?k=m(A):p&&!y&&(k=v(a,h,C,"depth","uint32")),O?P=m(O):y&&!p&&(P=v(a,h,!1,"stencil","uint8")),R?j=m(R):!A&&!O&&y&&p&&(j=v(a,h,C,"depth stencil","depth stencil")),nt(!!A+!!O+!!R<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var D=null;for(i=0;i<N.length;++i)if(d(N[i],a,h),nt(!N[i]||N[i].texture&&Ci.indexOf(N[i].texture._texture.format)>=0||N[i].renderbuffer&&ji.indexOf(N[i].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+i+" is invalid"),N[i]&&N[i].texture){var L=Mi[N[i].texture._texture.format]*Ii[N[i].texture._texture.type];null===D?D=L:nt(D===L,"all color attachments much have the same number of bits per pixel.")}return d(k,a,h),nt(!k||k.texture&&k.texture._texture.format===Ri||k.renderbuffer&&k.renderbuffer._renderbuffer.format===Ni,"invalid depth attachment for framebuffer object"),d(P,a,h),nt(!P||P.renderbuffer&&P.renderbuffer._renderbuffer.format===ki,"invalid stencil attachment for framebuffer object"),d(j,a,h),nt(!j||j.texture&&j.texture._texture.format===Pi||j.renderbuffer&&j.renderbuffer._renderbuffer.format===Pi,"invalid depth-stencil attachment for framebuffer object"),w(o),o.width=a,o.height=h,o.colorAttachments=N,o.depthAttachment=k,o.stencilAttachment=P,o.depthStencilAttachment=j,l.color=N.map(g),l.depth=g(k),l.stencil=g(P),l.depthStencil=g(j),l.width=o.width,l.height=o.height,T(o),l}function h(t,e){nt(u.next!==o,"can not resize a framebuffer which is currently in use");var n=Math.max(0|t,1),r=Math.max(0|e||n,1);if(n===o.width&&r===o.height)return l;for(var i=o.colorAttachments,a=0;a<i.length;++a)y(i[a],n,r);return y(o.depthAttachment,n,r),y(o.stencilAttachment,n,r),y(o.depthStencilAttachment,n,r),o.width=l.width=n,o.height=l.height=r,T(o),l}return a.framebufferCount++,l(t,i),e(l,{resize:h,_reglType:"framebuffer",_framebuffer:o,destroy:function(){x(o),w(o)},use:function(t){u.setFBO({framebuffer:l},t)}})}function A(t){var o=Array(6);function a(t){var r;nt(o.indexOf(u.next)<0,"can not update framebuffer which is currently in use");var c,l={color:null},h=0,d=null,p="rgba",m="uint8",v=1;if("number"===typeof t)h=0|t;else if(t){nt.type(t,"object","invalid arguments for framebuffer");var g=t;if("shape"in g){var y=g.shape;nt(Array.isArray(y)&&y.length>=2,"invalid shape for framebuffer"),nt(y[0]===y[1],"cube framebuffer must be square"),h=y[0]}else"radius"in g&&(h=0|g.radius),"width"in g?(h=0|g.width,"height"in g&&nt(g.height===h,"must be square")):"height"in g&&(h=0|g.height);("color"in g||"colors"in g)&&(d=g.color||g.colors,Array.isArray(d)&&nt(1===d.length||n.webgl_draw_buffers,"multiple render targets not supported")),d||("colorCount"in g&&(v=0|g.colorCount,nt(v>0,"invalid color buffer count")),"colorType"in g&&(nt.oneOf(g.colorType,f,"invalid color type"),m=g.colorType),"colorFormat"in g&&(p=g.colorFormat,nt.oneOf(g.colorFormat,s,"invalid color format for texture"))),"depth"in g&&(l.depth=g.depth),"stencil"in g&&(l.stencil=g.stencil),"depthStencil"in g&&(l.depthStencil=g.depthStencil)}else h=1;if(d)if(Array.isArray(d))for(c=[],r=0;r<d.length;++r)c[r]=d[r];else c=[d];else{c=Array(v);var b={radius:h,format:p,type:m};for(r=0;r<v;++r)c[r]=i.createCube(b)}for(l.color=Array(c.length),r=0;r<c.length;++r){var E=c[r];nt("function"===typeof E&&"textureCube"===E._reglType,"invalid cube map"),h=h||E.width,nt(E.width===h&&E.height===h,"invalid cube map shape"),l.color[r]={target:di,data:c[r]}}for(r=0;r<6;++r){for(var _=0;_<c.length;++_)l.color[_].target=di+r;r>0&&(l.depth=o[0].depth,l.stencil=o[0].stencil,l.depthStencil=o[0].depthStencil),o[r]?o[r](l):o[r]=S(l)}return e(a,{width:h,height:h,color:c})}function c(t){var e,n=0|t;if(nt(n>0&&n<=r.maxCubeMapSize,"invalid radius for cube fbo"),n===a.width)return a;var i=a.color;for(e=0;e<i.length;++e)i[e].resize(n);for(e=0;e<6;++e)o[e].resize(n);return a.width=a.height=n,a}return a(t),e(a,{faces:o,resize:c,_reglType:"framebufferCube",destroy:function(){o.forEach((function(t){t.destroy()}))}})}function O(){u.cur=null,u.next=null,u.dirty=!0,Te(E).forEach((function(e){e.framebuffer=t.createFramebuffer(),T(e)}))}return e(u,{getFramebuffer:function(t){if("function"===typeof t&&"framebuffer"===t._reglType){var e=t._framebuffer;if(e instanceof _)return e}return null},create:S,createCube:A,clear:function(){Te(E).forEach(x)},restore:O})}Di[yi]="complete",Di[bi]="incomplete attachment",Di[_i]="incomplete dimensions",Di[Ei]="incomplete, missing attachment",Di[wi]="unsupported";var Bi=5126,Fi=34962;function Ui(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Bi,this.offset=0,this.stride=0,this.divisor=0}function Gi(e,n,r,i,o){for(var a=r.maxAttributes,u=new Array(a),s=0;s<a;++s)u[s]=new Ui;var c=0,f={},l={Record:Ui,scope:{},state:u,currentVAO:null,targetVAO:null,restore:d()?E:function(){},createVAO:_,getVAO:m,destroyBuffer:h,setVAO:d()?v:g,clear:d()?y:function(){}};function h(t){for(var n=0;n<u.length;++n){var r=u[n];r.buffer===t&&(e.disableVertexAttribArray(n),r.buffer=null)}}function d(){return n.oes_vertex_array_object}function p(){return n.angle_instanced_arrays}function m(t){return"function"===typeof t&&t._vao?t._vao:null}function v(t){if(t!==l.currentVAO){var e=d();t?e.bindVertexArrayOES(t.vao):e.bindVertexArrayOES(null),l.currentVAO=t}}function g(t){if(t!==l.currentVAO){if(t)t.bindAttrs();else for(var n=p(),r=0;r<u.length;++r){var i=u[r];i.buffer?(e.enableVertexAttribArray(r),e.vertexAttribPointer(r,i.size,i.type,i.normalized,i.stride,i.offfset),n&&i.divisor&&n.vertexAttribDivisorANGLE(r,i.divisor)):(e.disableVertexAttribArray(r),e.vertexAttrib4f(r,i.x,i.y,i.z,i.w))}l.currentVAO=t}}function y(){Te(f).forEach((function(t){t.destroy()}))}function b(){this.id=++c,this.attributes=[];var t=d();this.vao=t?t.createVertexArrayOES():null,f[this.id]=this,this.buffers=[]}function E(){d()&&Te(f).forEach((function(t){t.refresh()}))}function _(e){var r=new b;function u(e){nt(Array.isArray(e),"arguments to vertex array constructor must be an array"),nt(e.length<a,"too many attributes"),nt(e.length>0,"must specify at least one attribute");var i={},s=r.attributes;s.length=e.length;for(var c=0;c<e.length;++c){var f,l=e[c],h=s[c]=new Ui,d=l.data||l;Array.isArray(d)||t(d)||xe(d)?(r.buffers[c]&&(f=r.buffers[c],t(d)&&f._buffer.byteLength>=d.byteLength?f.subdata(d):(f.destroy(),r.buffers[c]=null)),r.buffers[c]||(f=r.buffers[c]=o.create(l,Fi,!1,!0)),h.buffer=o.getBuffer(f),h.size=0|h.buffer.dimension,h.normalized=!1,h.type=h.buffer.dtype,h.offset=0,h.stride=0,h.divisor=0,h.state=1,i[c]=1):o.getBuffer(l)?(h.buffer=o.getBuffer(l),h.size=0|h.buffer.dimension,h.normalized=!1,h.type=h.buffer.dtype,h.offset=0,h.stride=0,h.divisor=0,h.state=1):o.getBuffer(l.buffer)?(h.buffer=o.getBuffer(l.buffer),h.size=0|(+l.size||h.buffer.dimension),h.normalized=!!l.normalized||!1,"type"in l?(nt.parameter(l.type,ke,"invalid buffer type"),h.type=ke[l.type]):h.type=h.buffer.dtype,h.offset=0|(l.offset||0),h.stride=0|(l.stride||0),h.divisor=0|(l.divisor||0),h.state=1,nt(h.size>=1&&h.size<=4,"size must be between 1 and 4"),nt(h.offset>=0,"invalid offset"),nt(h.stride>=0&&h.stride<=255,"stride must be between 0 and 255"),nt(h.divisor>=0,"divisor must be positive"),nt(!h.divisor||!!n.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in l?(nt(c>0,"first attribute must not be a constant"),h.x=+l.x||0,h.y=+l.y||0,h.z=+l.z||0,h.w=+l.w||0,h.state=2):nt(!1,"invalid attribute spec for location "+c)}for(var p=0;p<r.buffers.length;++p)!i[p]&&r.buffers[p]&&(r.buffers[p].destroy(),r.buffers[p]=null);return r.refresh(),u}return i.vaoCount+=1,u.destroy=function(){for(var t=0;t<r.buffers.length;++t)r.buffers[t]&&r.buffers[t].destroy();r.buffers.length=0,r.destroy()},u._vao=r,u._reglType="vao",u(e)}return b.prototype.bindAttrs=function(){for(var t=p(),n=this.attributes,r=0;r<n.length;++r){var i=n[r];i.buffer?(e.enableVertexAttribArray(r),e.bindBuffer(Fi,i.buffer.buffer),e.vertexAttribPointer(r,i.size,i.type,i.normalized,i.stride,i.offset),t&&i.divisor&&t.vertexAttribDivisorANGLE(r,i.divisor)):(e.disableVertexAttribArray(r),e.vertexAttrib4f(r,i.x,i.y,i.z,i.w))}for(var o=n.length;o<a;++o)e.disableVertexAttribArray(o)},b.prototype.refresh=function(){var t=d();t&&(t.bindVertexArrayOES(this.vao),this.bindAttrs(),l.currentVAO=this)},b.prototype.destroy=function(){if(this.vao){var t=d();this===l.currentVAO&&(l.currentVAO=null,t.bindVertexArrayOES(null)),t.deleteVertexArrayOES(this.vao),this.vao=null}f[this.id]&&(delete f[this.id],i.vaoCount-=1)},l}var Vi=35632,zi=35633,Hi=35718,Wi=35721;function qi(t,n,r,i){var o={},a={};function u(t,e,n,r){this.name=t,this.id=e,this.location=n,this.info=r}function s(t,e){for(var n=0;n<t.length;++n)if(t[n].id===e.id)return void(t[n].location=e.location);t.push(e)}function c(e,r,i){var u=e===Vi?o:a,s=u[r];if(!s){var c=n.str(r);s=t.createShader(e),t.shaderSource(s,c),t.compileShader(s),nt.shaderError(t,s,c,e,i),u[r]=s}return s}var f={},l=[],h=0;function d(t,e){this.id=h++,this.fragId=t,this.vertId=e,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,i.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function p(e,r,o){var a,f,l=c(Vi,e.fragId),h=c(zi,e.vertId),d=e.program=t.createProgram();if(t.attachShader(d,l),t.attachShader(d,h),o)for(a=0;a<o.length;++a){var p=o[a];t.bindAttribLocation(d,p[0],p[1])}t.linkProgram(d),nt.linkError(t,d,n.str(e.fragId),n.str(e.vertId),r);var m=t.getProgramParameter(d,Hi);i.profile&&(e.stats.uniformsCount=m);var v=e.uniforms;for(a=0;a<m;++a)if(f=t.getActiveUniform(d,a))if(f.size>1)for(var g=0;g<f.size;++g){var y=f.name.replace("[0]","["+g+"]");s(v,new u(y,n.id(y),t.getUniformLocation(d,y),f))}else s(v,new u(f.name,n.id(f.name),t.getUniformLocation(d,f.name),f));var b=t.getProgramParameter(d,Wi);i.profile&&(e.stats.attributesCount=b);var E=e.attributes;for(a=0;a<b;++a)(f=t.getActiveAttrib(d,a))&&s(E,new u(f.name,n.id(f.name),t.getAttribLocation(d,f.name),f))}function m(){o={},a={};for(var t=0;t<l.length;++t)p(l[t],null,l[t].attributes.map((function(t){return[t.location,t.name]})))}return i.profile&&(r.getMaxUniformsCount=function(){var t=0;return l.forEach((function(e){e.stats.uniformsCount>t&&(t=e.stats.uniformsCount)})),t},r.getMaxAttributesCount=function(){var t=0;return l.forEach((function(e){e.stats.attributesCount>t&&(t=e.stats.attributesCount)})),t}),{clear:function(){var e=t.deleteShader.bind(t);Te(o).forEach(e),o={},Te(a).forEach(e),a={},l.forEach((function(e){t.deleteProgram(e.program)})),l.length=0,f={},r.shaderCount=0},program:function(n,i,u,s){nt.command(n>=0,"missing vertex shader",u),nt.command(i>=0,"missing fragment shader",u);var c=f[i];c||(c=f[i]={});var h=c[n];if(h&&(h.refCount++,!s))return h;var m=new d(i,n);return r.shaderCount++,p(m,u,s),h||(c[n]=m),l.push(m),e(m,{destroy:function(){if(m.refCount--,m.refCount<=0){t.deleteProgram(m.program);var e=l.indexOf(m);l.splice(e,1),r.shaderCount--}c[m.vertId].refCount<=0&&(t.deleteShader(a[m.vertId]),delete a[m.vertId],delete f[m.fragId][m.vertId]),Object.keys(f[m.fragId]).length||(t.deleteShader(o[m.fragId]),delete o[m.fragId],delete f[m.fragId])}})},restore:m,shader:c,frag:-1,vert:-1}}var Xi=6408,Yi=5121,Ki=3333,Qi=5126;function Zi(e,n,r,i,o,a,u){function s(s){var c;null===n.next?(nt(o.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),c=Yi):(nt(null!==n.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),c=n.next.colorAttachments[0].texture._texture.type,a.oes_texture_float?(nt(c===Yi||c===Qi,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),c===Qi&&nt(u.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):nt(c===Yi,"Reading from a framebuffer is only allowed for the type 'uint8'"));var f=0,l=0,h=i.framebufferWidth,d=i.framebufferHeight,p=null;t(s)?p=s:s&&(nt.type(s,"object","invalid arguments to regl.read()"),f=0|s.x,l=0|s.y,nt(f>=0&&f<i.framebufferWidth,"invalid x offset for regl.read"),nt(l>=0&&l<i.framebufferHeight,"invalid y offset for regl.read"),h=0|(s.width||i.framebufferWidth-f),d=0|(s.height||i.framebufferHeight-l),p=s.data||null),p&&(c===Yi?nt(p instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):c===Qi&&nt(p instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),nt(h>0&&h+f<=i.framebufferWidth,"invalid width for read pixels"),nt(d>0&&d+l<=i.framebufferHeight,"invalid height for read pixels"),r();var m=h*d*4;return p||(c===Yi?p=new Uint8Array(m):c===Qi&&(p=p||new Float32Array(m))),nt.isTypedArray(p,"data buffer for regl.read() must be a typedarray"),nt(p.byteLength>=m,"data buffer for regl.read() too small"),e.pixelStorei(Ki,4),e.readPixels(f,l,h,d,Xi,c,p),p}function c(t){var e;return n.setFBO({framebuffer:t.framebuffer},(function(){e=s(t)})),e}function f(t){return t&&"framebuffer"in t?c(t):s(t)}return f}function Ji(t){return Array.prototype.slice.call(t)}function $i(t){return Ji(t).join("")}function to(){var t=0,n=[],r=[];function i(e){for(var i=0;i<r.length;++i)if(r[i]===e)return n[i];var o="g"+t++;return n.push(o),r.push(e),o}function o(){var n=[];function r(){n.push.apply(n,Ji(arguments))}var i=[];function o(){var e="v"+t++;return i.push(e),arguments.length>0&&(n.push(e,"="),n.push.apply(n,Ji(arguments)),n.push(";")),e}return e(r,{def:o,toString:function(){return $i([i.length>0?"var "+i.join(",")+";":"",$i(n)])}})}function a(){var t=o(),n=o(),r=t.toString,i=n.toString;function a(e,r){n(e,r,"=",t.def(e,r),";")}return e((function(){t.apply(t,Ji(arguments))}),{def:t.def,entry:t,exit:n,save:a,set:function(e,n,r){a(e,n),t(e,n,"=",r,";")},toString:function(){return r()+i()}})}function u(){var t=$i(arguments),n=a(),r=a(),i=n.toString,o=r.toString;return e(n,{then:function(){return n.apply(n,Ji(arguments)),this},else:function(){return r.apply(r,Ji(arguments)),this},toString:function(){var e=o();return e&&(e="else{"+e+"}"),$i(["if(",t,"){",i(),"}",e])}})}var s=o(),c={};function f(t,n){var r=[];function i(){var t="a"+r.length;return r.push(t),t}n=n||0;for(var o=0;o<n;++o)i();var u=a(),s=u.toString;return c[t]=e(u,{arg:i,toString:function(){return $i(["function(",r.join(),"){",s(),"}"])}})}function l(){var t=['"use strict";',s,"return {"];Object.keys(c).forEach((function(e){t.push('"',e,'":',c[e].toString(),",")})),t.push("}");var e=$i(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(e)).apply(null,r)}return{global:s,link:i,block:o,proc:f,scope:a,cond:u,compile:l}}var eo="xyzw".split(""),no=5121,ro=1,io=2,oo=0,ao=1,uo=2,so=3,co=4,fo=5,lo=6,ho="dither",po="blend.enable",mo="blend.color",vo="blend.equation",go="blend.func",yo="depth.enable",bo="depth.func",Eo="depth.range",_o="depth.mask",wo="colorMask",xo="cull.enable",To="cull.face",So="frontFace",Ao="lineWidth",Oo="polygonOffset.enable",Ro="polygonOffset.offset",Co="sample.alpha",Mo="sample.enable",Io="sample.coverage",No="stencil.enable",ko="stencil.mask",Po="stencil.func",jo="stencil.opFront",Do="stencil.opBack",Lo="scissor.enable",Bo="scissor.box",Fo="viewport",Uo="profile",Go="framebuffer",Vo="vert",zo="frag",Ho="elements",Wo="primitive",qo="count",Xo="offset",Yo="instances",Ko="vao",Qo="Width",Zo="Height",Jo=Go+Qo,$o=Go+Zo,ta=Fo+Qo,ea=Fo+Zo,na="drawingBuffer",ra=na+Qo,ia=na+Zo,oa=[go,vo,Po,jo,Do,Io,Fo,Bo,Ro],aa=34962,ua=34963,sa=3553,ca=34067,fa=2884,la=3042,ha=3024,da=2960,pa=2929,ma=3089,va=32823,ga=32926,ya=32928,ba=5126,Ea=35664,_a=35665,wa=35666,xa=5124,Ta=35667,Sa=35668,Aa=35669,Oa=35670,Ra=35671,Ca=35672,Ma=35673,Ia=35674,Na=35675,ka=35676,Pa=35678,ja=35680,Da=4,La=1028,Ba=1029,Fa=2304,Ua=2305,Ga=32775,Va=32776,za=519,Ha=7680,Wa=0,qa=1,Xa=32774,Ya=513,Ka=36160,Qa=36064,Za={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ja=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],$a={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},tu={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},eu={frag:35632,vert:35633},nu={cw:Fa,ccw:Ua};function ru(e){return Array.isArray(e)||t(e)||xe(e)}function iu(t){return t.sort((function(t,e){return t===Fo?-1:e===Fo?1:t<e?-1:1}))}function ou(t,e,n,r){this.thisDep=t,this.contextDep=e,this.propDep=n,this.append=r}function au(t){return t&&!(t.thisDep||t.contextDep||t.propDep)}function uu(t){return new ou(!1,!1,!1,t)}function su(t,e){var n=t.type;if(n===oo){var r=t.data.length;return new ou(!0,r>=1,r>=2,e)}if(n===co){var i=t.data;return new ou(i.thisDep,i.contextDep,i.propDep,e)}if(n===fo)return new ou(!1,!1,!1,e);if(n===lo){for(var o=!1,a=!1,u=!1,s=0;s<t.data.length;++s){var c=t.data[s];if(c.type===ao)u=!0;else if(c.type===uo)a=!0;else if(c.type===so)o=!0;else if(c.type===oo){o=!0;var f=c.data;f>=1&&(a=!0),f>=2&&(u=!0)}else c.type===co&&(o=o||c.data.thisDep,a=a||c.data.contextDep,u=u||c.data.propDep)}return new ou(o,a,u,e)}return new ou(n===so,n===uo,n===ao,e)}var cu=new ou(!1,!1,!1,(function(){}));function fu(t,n,r,i,o,a,u,s,c,f,l,h,d,p,m){var v=f.Record,g={add:32774,subtract:32778,"reverse subtract":32779};r.ext_blend_minmax&&(g.min=Ga,g.max=Va);var y=r.angle_instanced_arrays,b=r.webgl_draw_buffers,E={dirty:!0,profile:m.profile},_={},w=[],x={},T={};function S(t){return t.replace(".","_")}function A(t,e,n){var r=S(t);w.push(t),_[r]=E[r]=!!n,x[r]=e}function O(t,e,n){var r=S(t);w.push(t),Array.isArray(n)?(E[r]=n.slice(),_[r]=n.slice()):E[r]=_[r]=n,T[r]=e}A(ho,ha),A(po,la),O(mo,"blendColor",[0,0,0,0]),O(vo,"blendEquationSeparate",[Xa,Xa]),O(go,"blendFuncSeparate",[qa,Wa,qa,Wa]),A(yo,pa,!0),O(bo,"depthFunc",Ya),O(Eo,"depthRange",[0,1]),O(_o,"depthMask",!0),O(wo,wo,[!0,!0,!0,!0]),A(xo,fa),O(To,"cullFace",Ba),O(So,So,Ua),O(Ao,Ao,1),A(Oo,va),O(Ro,"polygonOffset",[0,0]),A(Co,ga),A(Mo,ya),O(Io,"sampleCoverage",[1,!1]),A(No,da),O(ko,"stencilMask",-1),O(Po,"stencilFunc",[za,0,-1]),O(jo,"stencilOpSeparate",[La,Ha,Ha,Ha]),O(Do,"stencilOpSeparate",[Ba,Ha,Ha,Ha]),A(Lo,ma),O(Bo,"scissor",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]),O(Fo,Fo,[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);var R={gl:t,context:d,strings:n,next:_,current:E,draw:h,elements:a,buffer:o,shader:l,attributes:f.state,vao:f,uniforms:c,framebuffer:s,extensions:r,timer:p,isBufferArgs:ru},C={primTypes:qe,compareFuncs:$a,blendFuncs:Za,blendEquations:g,stencilOps:tu,glTypes:ke,orientationType:nu};nt.optional((function(){R.isArrayLike=ln})),b&&(C.backBuffer=[Ba],C.drawBuffer=At(i.maxDrawbuffers,(function(t){return 0===t?[0]:At(t,(function(t){return Qa+t}))})));var M=0;function I(){var t=to(),e=t.link,r=t.global;t.id=M++,t.batchId="0";var i=e(R),o=t.shared={props:"a0"};Object.keys(R).forEach((function(t){o[t]=r.def(i,".",t)})),nt.optional((function(){t.CHECK=e(nt),t.commandStr=nt.guessCommand(),t.command=e(t.commandStr),t.assert=function(t,n,r){t("if(!(",n,"))",this.CHECK,".commandRaise(",e(r),",",this.command,");")},C.invalidBlendCombinations=Ja}));var a=t.next={},u=t.current={};Object.keys(T).forEach((function(t){Array.isArray(E[t])&&(a[t]=r.def(o.next,".",t),u[t]=r.def(o.current,".",t))}));var s=t.constants={};Object.keys(C).forEach((function(t){s[t]=r.def(JSON.stringify(C[t]))})),t.invoke=function(n,r){switch(r.type){case oo:var i=["this",o.context,o.props,t.batchId];return n.def(e(r.data),".call(",i.slice(0,Math.max(r.data.length+1,4)),")");case ao:return n.def(o.props,r.data);case uo:return n.def(o.context,r.data);case so:return n.def("this",r.data);case co:return r.data.append(t,n),r.data.ref;case fo:return r.data.toString();case lo:return r.data.map((function(e){return t.invoke(n,e)}))}},t.attribCache={};var c={};return t.scopeAttrib=function(t){var r=n.id(t);if(r in c)return c[r];var i=f.scope[r];return i||(i=f.scope[r]=new v),c[r]=e(i)},t}function N(t){var e,n=t.static,r=t.dynamic;if(Uo in n){var i=!!n[Uo];(e=uu((function(t,e){return i}))).enable=i}else if(Uo in r){var o=r[Uo];e=su(o,(function(t,e){return t.invoke(e,o)}))}return e}function k(t,e){var n=t.static,r=t.dynamic;if(Go in n){var i=n[Go];return i?(i=s.getFramebuffer(i),nt.command(i,"invalid framebuffer object"),uu((function(t,e){var n=t.link(i),r=t.shared;e.set(r.framebuffer,".next",n);var o=r.context;return e.set(o,"."+Jo,n+".width"),e.set(o,"."+$o,n+".height"),n}))):uu((function(t,e){var n=t.shared;e.set(n.framebuffer,".next","null");var r=n.context;return e.set(r,"."+Jo,r+"."+ra),e.set(r,"."+$o,r+"."+ia),"null"}))}if(Go in r){var o=r[Go];return su(o,(function(t,e){var n=t.invoke(e,o),r=t.shared,i=r.framebuffer,a=e.def(i,".getFramebuffer(",n,")");nt.optional((function(){t.assert(e,"!"+n+"||"+a,"invalid framebuffer object")})),e.set(i,".next",a);var u=r.context;return e.set(u,"."+Jo,a+"?"+a+".width:"+u+"."+ra),e.set(u,"."+$o,a+"?"+a+".height:"+u+"."+ia),a}))}return null}function P(t,e,n){var r=t.static,i=t.dynamic;function o(t){if(t in r){var o=r[t];nt.commandType(o,"object","invalid "+t,n.commandStr);var a,u,s=!0,c=0|o.x,f=0|o.y;return"width"in o?(a=0|o.width,nt.command(a>=0,"invalid "+t,n.commandStr)):s=!1,"height"in o?(u=0|o.height,nt.command(u>=0,"invalid "+t,n.commandStr)):s=!1,new ou(!s&&e&&e.thisDep,!s&&e&&e.contextDep,!s&&e&&e.propDep,(function(t,e){var n=t.shared.context,r=a;"width"in o||(r=e.def(n,".",Jo,"-",c));var i=u;return"height"in o||(i=e.def(n,".",$o,"-",f)),[c,f,r,i]}))}if(t in i){var l=i[t],h=su(l,(function(e,n){var r=e.invoke(n,l);nt.optional((function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+t)}));var i=e.shared.context,o=n.def(r,".x|0"),a=n.def(r,".y|0"),u=n.def('"width" in ',r,"?",r,".width|0:","(",i,".",Jo,"-",o,")"),s=n.def('"height" in ',r,"?",r,".height|0:","(",i,".",$o,"-",a,")");return nt.optional((function(){e.assert(n,u+">=0&&"+s+">=0","invalid "+t)})),[o,a,u,s]}));return e&&(h.thisDep=h.thisDep||e.thisDep,h.contextDep=h.contextDep||e.contextDep,h.propDep=h.propDep||e.propDep),h}return e?new ou(e.thisDep,e.contextDep,e.propDep,(function(t,e){var n=t.shared.context;return[0,0,e.def(n,".",Jo),e.def(n,".",$o)]})):null}var a=o(Fo);if(a){var u=a;a=new ou(a.thisDep,a.contextDep,a.propDep,(function(t,e){var n=u.append(t,e),r=t.shared.context;return e.set(r,"."+ta,n[2]),e.set(r,"."+ea,n[3]),n}))}return{viewport:a,scissor_box:o(Bo)}}function j(t,e){var n=t.static;if("string"===typeof n[zo]&&"string"===typeof n[Vo]){if(Object.keys(e.dynamic).length>0)return null;var r=e.static,i=Object.keys(r);if(i.length>0&&"number"===typeof r[i[0]]){for(var o=[],a=0;a<i.length;++a)nt("number"===typeof r[i[a]],"must specify all vertex attribute locations when using vaos"),o.push([0|r[i[a]],i[a]]);return o}}return null}function D(t,e,r){var i=t.static,o=t.dynamic;function a(t){if(t in i){var e=n.id(i[t]);nt.optional((function(){l.shader(eu[t],e,nt.guessCommand())}));var r=uu((function(){return e}));return r.id=e,r}if(t in o){var a=o[t];return su(a,(function(e,n){var r=e.invoke(n,a),i=n.def(e.shared.strings,".id(",r,")");return nt.optional((function(){n(e.shared.shader,".shader(",eu[t],",",i,",",e.command,");")})),i}))}return null}var u,s=a(zo),c=a(Vo),f=null;return au(s)&&au(c)?(f=l.program(c.id,s.id,null,r),u=uu((function(t,e){return t.link(f)}))):u=new ou(s&&s.thisDep||c&&c.thisDep,s&&s.contextDep||c&&c.contextDep,s&&s.propDep||c&&c.propDep,(function(t,e){var n,r=t.shared.shader;n=s?s.append(t,e):e.def(r,".",zo);var i=r+".program("+(c?c.append(t,e):e.def(r,".",Vo))+","+n;return nt.optional((function(){i+=","+t.command})),e.def(i+")")})),{frag:s,vert:c,progVar:u,program:f}}function L(t,e){var n=t.static,r=t.dynamic;function i(){if(Ho in n){var t=n[Ho];ru(t)?t=a.getElements(a.create(t,!0)):t&&(t=a.getElements(t),nt.command(t,"invalid elements",e.commandStr));var i=uu((function(e,n){if(t){var r=e.link(t);return e.ELEMENTS=r,r}return e.ELEMENTS=null,null}));return i.value=t,i}if(Ho in r){var o=r[Ho];return su(o,(function(t,e){var n=t.shared,r=n.isBufferArgs,i=n.elements,a=t.invoke(e,o),u=e.def("null"),s=e.def(r,"(",a,")"),c=t.cond(s).then(u,"=",i,".createStream(",a,");").else(u,"=",i,".getElements(",a,");");return nt.optional((function(){t.assert(c.else,"!"+a+"||"+u,"invalid elements")})),e.entry(c),e.exit(t.cond(s).then(i,".destroyStream(",u,");")),t.ELEMENTS=u,u}))}return null}var o=i();function u(){if(Wo in n){var t=n[Wo];return nt.commandParameter(t,qe,"invalid primitve",e.commandStr),uu((function(e,n){return qe[t]}))}if(Wo in r){var i=r[Wo];return su(i,(function(t,e){var n=t.constants.primTypes,r=t.invoke(e,i);return nt.optional((function(){t.assert(e,r+" in "+n,"invalid primitive, must be one of "+Object.keys(qe))})),e.def(n,"[",r,"]")}))}return o?au(o)?o.value?uu((function(t,e){return e.def(t.ELEMENTS,".primType")})):uu((function(){return Da})):new ou(o.thisDep,o.contextDep,o.propDep,(function(t,e){var n=t.ELEMENTS;return e.def(n,"?",n,".primType:",Da)})):null}function s(t,i){if(t in n){var a=0|n[t];return nt.command(!i||a>=0,"invalid "+t,e.commandStr),uu((function(t,e){return i&&(t.OFFSET=a),a}))}if(t in r){var u=r[t];return su(u,(function(e,n){var r=e.invoke(n,u);return i&&(e.OFFSET=r,nt.optional((function(){e.assert(n,r+">=0","invalid "+t)}))),r}))}return i&&o?uu((function(t,e){return t.OFFSET="0",0})):null}var c=s(Xo,!0);function f(){if(qo in n){var t=0|n[qo];return nt.command("number"===typeof t&&t>=0,"invalid vertex count",e.commandStr),uu((function(){return t}))}if(qo in r){var i=r[qo];return su(i,(function(t,e){var n=t.invoke(e,i);return nt.optional((function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">=0&&"+n+"===("+n+"|0)","invalid vertex count")})),n}))}if(o){if(au(o)){if(o)return c?new ou(c.thisDep,c.contextDep,c.propDep,(function(t,e){var n=e.def(t.ELEMENTS,".vertCount-",t.OFFSET);return nt.optional((function(){t.assert(e,n+">=0","invalid vertex offset/element buffer too small")})),n})):uu((function(t,e){return e.def(t.ELEMENTS,".vertCount")}));var a=uu((function(){return-1}));return nt.optional((function(){a.MISSING=!0})),a}var u=new ou(o.thisDep||c.thisDep,o.contextDep||c.contextDep,o.propDep||c.propDep,(function(t,e){var n=t.ELEMENTS;return t.OFFSET?e.def(n,"?",n,".vertCount-",t.OFFSET,":-1"):e.def(n,"?",n,".vertCount:-1")}));return nt.optional((function(){u.DYNAMIC=!0})),u}return null}return{elements:o,primitive:u(),count:f(),instances:s(Yo,!1),offset:c}}function B(t,e){var n=t.static,r=t.dynamic,o={};return w.forEach((function(t){var a=S(t);function u(e,i){if(t in n){var u=e(n[t]);o[a]=uu((function(){return u}))}else if(t in r){var s=r[t];o[a]=su(s,(function(t,e){return i(t,e,t.invoke(e,s))}))}}switch(t){case xo:case po:case ho:case No:case yo:case Lo:case Oo:case Co:case Mo:case _o:return u((function(n){return nt.commandType(n,"boolean",t,e.commandStr),n}),(function(e,n,r){return nt.optional((function(){e.assert(n,"typeof "+r+'==="boolean"',"invalid flag "+t,e.commandStr)})),r}));case bo:return u((function(n){return nt.commandParameter(n,$a,"invalid "+t,e.commandStr),$a[n]}),(function(e,n,r){var i=e.constants.compareFuncs;return nt.optional((function(){e.assert(n,r+" in "+i,"invalid "+t+", must be one of "+Object.keys($a))})),n.def(i,"[",r,"]")}));case Eo:return u((function(t){return nt.command(ln(t)&&2===t.length&&"number"===typeof t[0]&&"number"===typeof t[1]&&t[0]<=t[1],"depth range is 2d array",e.commandStr),t}),(function(t,e,n){return nt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")})),[e.def("+",n,"[0]"),e.def("+",n,"[1]")]}));case go:return u((function(t){nt.commandType(t,"object","blend.func",e.commandStr);var n="srcRGB"in t?t.srcRGB:t.src,r="srcAlpha"in t?t.srcAlpha:t.src,i="dstRGB"in t?t.dstRGB:t.dst,o="dstAlpha"in t?t.dstAlpha:t.dst;return nt.commandParameter(n,Za,a+".srcRGB",e.commandStr),nt.commandParameter(r,Za,a+".srcAlpha",e.commandStr),nt.commandParameter(i,Za,a+".dstRGB",e.commandStr),nt.commandParameter(o,Za,a+".dstAlpha",e.commandStr),nt.command(-1===Ja.indexOf(n+", "+i),"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+i+")",e.commandStr),[Za[n],Za[i],Za[r],Za[o]]}),(function(e,n,r){var i=e.constants.blendFuncs;function o(o,a){var u=n.def('"',o,a,'" in ',r,"?",r,".",o,a,":",r,".",o);return nt.optional((function(){e.assert(n,u+" in "+i,"invalid "+t+"."+o+a+", must be one of "+Object.keys(Za))})),u}nt.optional((function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid blend func, must be an object")}));var a=o("src","RGB"),u=o("dst","RGB");nt.optional((function(){var t=e.constants.invalidBlendCombinations;e.assert(n,t+".indexOf("+a+'+", "+'+u+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")}));var s=n.def(i,"[",a,"]"),c=n.def(i,"[",o("src","Alpha"),"]");return[s,n.def(i,"[",u,"]"),c,n.def(i,"[",o("dst","Alpha"),"]")]}));case vo:return u((function(n){return"string"===typeof n?(nt.commandParameter(n,g,"invalid "+t,e.commandStr),[g[n],g[n]]):"object"===typeof n?(nt.commandParameter(n.rgb,g,t+".rgb",e.commandStr),nt.commandParameter(n.alpha,g,t+".alpha",e.commandStr),[g[n.rgb],g[n.alpha]]):void nt.commandRaise("invalid blend.equation",e.commandStr)}),(function(e,n,r){var i=e.constants.blendEquations,o=n.def(),a=n.def(),u=e.cond("typeof ",r,'==="string"');return nt.optional((function(){function n(t,n,r){e.assert(t,r+" in "+i,"invalid "+n+", must be one of "+Object.keys(g))}n(u.then,t,r),e.assert(u.else,r+"&&typeof "+r+'==="object"',"invalid "+t),n(u.else,t+".rgb",r+".rgb"),n(u.else,t+".alpha",r+".alpha")})),u.then(o,"=",a,"=",i,"[",r,"];"),u.else(o,"=",i,"[",r,".rgb];",a,"=",i,"[",r,".alpha];"),n(u),[o,a]}));case mo:return u((function(t){return nt.command(ln(t)&&4===t.length,"blend.color must be a 4d array",e.commandStr),At(4,(function(e){return+t[e]}))}),(function(t,e,n){return nt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")})),At(4,(function(t){return e.def("+",n,"[",t,"]")}))}));case ko:return u((function(t){return nt.commandType(t,"number",a,e.commandStr),0|t}),(function(t,e,n){return nt.optional((function(){t.assert(e,"typeof "+n+'==="number"',"invalid stencil.mask")})),e.def(n,"|0")}));case Po:return u((function(n){nt.commandType(n,"object",a,e.commandStr);var r=n.cmp||"keep",i=n.ref||0,o="mask"in n?n.mask:-1;return nt.commandParameter(r,$a,t+".cmp",e.commandStr),nt.commandType(i,"number",t+".ref",e.commandStr),nt.commandType(o,"number",t+".mask",e.commandStr),[$a[r],i,o]}),(function(t,e,n){var r=t.constants.compareFuncs;return nt.optional((function(){function i(){t.assert(e,Array.prototype.join.call(arguments,""),"invalid stencil.func")}i(n+"&&typeof ",n,'==="object"'),i('!("cmp" in ',n,")||(",n,".cmp in ",r,")")})),[e.def('"cmp" in ',n,"?",r,"[",n,".cmp]",":",Ha),e.def(n,".ref|0"),e.def('"mask" in ',n,"?",n,".mask|0:-1")]}));case jo:case Do:return u((function(n){nt.commandType(n,"object",a,e.commandStr);var r=n.fail||"keep",i=n.zfail||"keep",o=n.zpass||"keep";return nt.commandParameter(r,tu,t+".fail",e.commandStr),nt.commandParameter(i,tu,t+".zfail",e.commandStr),nt.commandParameter(o,tu,t+".zpass",e.commandStr),[t===Do?Ba:La,tu[r],tu[i],tu[o]]}),(function(e,n,r){var i=e.constants.stencilOps;function o(o){return nt.optional((function(){e.assert(n,'!("'+o+'" in '+r+")||("+r+"."+o+" in "+i+")","invalid "+t+"."+o+", must be one of "+Object.keys(tu))})),n.def('"',o,'" in ',r,"?",i,"[",r,".",o,"]:",Ha)}return nt.optional((function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+t)})),[t===Do?Ba:La,o("fail"),o("zfail"),o("zpass")]}));case Ro:return u((function(t){nt.commandType(t,"object",a,e.commandStr);var n=0|t.factor,r=0|t.units;return nt.commandType(n,"number",a+".factor",e.commandStr),nt.commandType(r,"number",a+".units",e.commandStr),[n,r]}),(function(e,n,r){return nt.optional((function(){e.assert(n,r+"&&typeof "+r+'==="object"',"invalid "+t)})),[n.def(r,".factor|0"),n.def(r,".units|0")]}));case To:return u((function(t){var n=0;return"front"===t?n=La:"back"===t&&(n=Ba),nt.command(!!n,a,e.commandStr),n}),(function(t,e,n){return nt.optional((function(){t.assert(e,n+'==="front"||'+n+'==="back"',"invalid cull.face")})),e.def(n,'==="front"?',La,":",Ba)}));case Ao:return u((function(t){return nt.command("number"===typeof t&&t>=i.lineWidthDims[0]&&t<=i.lineWidthDims[1],"invalid line width, must be a positive number between "+i.lineWidthDims[0]+" and "+i.lineWidthDims[1],e.commandStr),t}),(function(t,e,n){return nt.optional((function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">="+i.lineWidthDims[0]+"&&"+n+"<="+i.lineWidthDims[1],"invalid line width")})),n}));case So:return u((function(t){return nt.commandParameter(t,nu,a,e.commandStr),nu[t]}),(function(t,e,n){return nt.optional((function(){t.assert(e,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")})),e.def(n+'==="cw"?'+Fa+":"+Ua)}));case wo:return u((function(t){return nt.command(ln(t)&&4===t.length,"color.mask must be length 4 array",e.commandStr),t.map((function(t){return!!t}))}),(function(t,e,n){return nt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")})),At(4,(function(t){return"!!"+n+"["+t+"]"}))}));case Io:return u((function(t){nt.command("object"===typeof t&&t,a,e.commandStr);var n="value"in t?t.value:1,r=!!t.invert;return nt.command("number"===typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",e.commandStr),[n,r]}),(function(t,e,n){return nt.optional((function(){t.assert(e,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")})),[e.def('"value" in ',n,"?+",n,".value:1"),e.def("!!",n,".invert")]}))}})),o}function F(t,e){var n=t.static,r=t.dynamic,i={};return Object.keys(n).forEach((function(t){var r,o=n[t];if("number"===typeof o||"boolean"===typeof o)r=uu((function(){return o}));else if("function"===typeof o){var a=o._reglType;"texture2d"===a||"textureCube"===a?r=uu((function(t){return t.link(o)})):"framebuffer"===a||"framebufferCube"===a?(nt.command(o.color.length>0,'missing color attachment for framebuffer sent to uniform "'+t+'"',e.commandStr),r=uu((function(t){return t.link(o.color[0])}))):nt.commandRaise('invalid data for uniform "'+t+'"',e.commandStr)}else ln(o)?r=uu((function(e){return e.global.def("[",At(o.length,(function(n){return nt.command("number"===typeof o[n]||"boolean"===typeof o[n],"invalid uniform "+t,e.commandStr),o[n]})),"]")})):nt.commandRaise('invalid or missing data for uniform "'+t+'"',e.commandStr);r.value=o,i[t]=r})),Object.keys(r).forEach((function(t){var e=r[t];i[t]=su(e,(function(t,n){return t.invoke(n,e)}))})),i}function U(t,e){var r=t.static,i=t.dynamic,a={};return Object.keys(r).forEach((function(t){var i=r[t],u=n.id(t),s=new v;if(ru(i))s.state=ro,s.buffer=o.getBuffer(o.create(i,aa,!1,!0)),s.type=0;else{var c=o.getBuffer(i);if(c)s.state=ro,s.buffer=c,s.type=0;else if(nt.command("object"===typeof i&&i,"invalid data for attribute "+t,e.commandStr),"constant"in i){var f=i.constant;s.buffer="null",s.state=io,"number"===typeof f?s.x=f:(nt.command(ln(f)&&f.length>0&&f.length<=4,"invalid constant for attribute "+t,e.commandStr),eo.forEach((function(t,e){e<f.length&&(s[t]=f[e])})))}else{c=ru(i.buffer)?o.getBuffer(o.create(i.buffer,aa,!1,!0)):o.getBuffer(i.buffer),nt.command(!!c,'missing buffer for attribute "'+t+'"',e.commandStr);var l=0|i.offset;nt.command(l>=0,'invalid offset for attribute "'+t+'"',e.commandStr);var h=0|i.stride;nt.command(h>=0&&h<256,'invalid stride for attribute "'+t+'", must be integer betweeen [0, 255]',e.commandStr);var d=0|i.size;nt.command(!("size"in i)||d>0&&d<=4,'invalid size for attribute "'+t+'", must be 1,2,3,4',e.commandStr);var p=!!i.normalized,m=0;"type"in i&&(nt.commandParameter(i.type,ke,"invalid type for attribute "+t,e.commandStr),m=ke[i.type]);var g=0|i.divisor;"divisor"in i&&(nt.command(0===g||y,'cannot specify divisor for attribute "'+t+'", instancing not supported',e.commandStr),nt.command(g>=0,'invalid divisor for attribute "'+t+'"',e.commandStr)),nt.optional((function(){var n=e.commandStr,r=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(i).forEach((function(e){nt.command(r.indexOf(e)>=0,'unknown parameter "'+e+'" for attribute pointer "'+t+'" (valid parameters are '+r+")",n)}))})),s.buffer=c,s.state=ro,s.size=d,s.normalized=p,s.type=m||c.dtype,s.offset=l,s.stride=h,s.divisor=g}}a[t]=uu((function(t,e){var n=t.attribCache;if(u in n)return n[u];var r={isStream:!1};return Object.keys(s).forEach((function(t){r[t]=s[t]})),s.buffer&&(r.buffer=t.link(s.buffer),r.type=r.type||r.buffer+".dtype"),n[u]=r,r}))})),Object.keys(i).forEach((function(t){var e=i[t];function n(n,r){var i=n.invoke(r,e),o=n.shared,a=n.constants,u=o.isBufferArgs,s=o.buffer;nt.optional((function(){n.assert(r,i+"&&(typeof "+i+'==="object"||typeof '+i+'==="function")&&('+u+"("+i+")||"+s+".getBuffer("+i+")||"+s+".getBuffer("+i+".buffer)||"+u+"("+i+'.buffer)||("constant" in '+i+"&&(typeof "+i+'.constant==="number"||'+o.isArrayLike+"("+i+".constant))))",'invalid dynamic attribute "'+t+'"')}));var c={isStream:r.def(!1)},f=new v;f.state=ro,Object.keys(f).forEach((function(t){c[t]=r.def(""+f[t])}));var l=c.buffer,h=c.type;function d(t){r(c[t],"=",i,".",t,"|0;")}return r("if(",u,"(",i,")){",c.isStream,"=true;",l,"=",s,".createStream(",aa,",",i,");",h,"=",l,".dtype;","}else{",l,"=",s,".getBuffer(",i,");","if(",l,"){",h,"=",l,".dtype;",'}else if("constant" in ',i,"){",c.state,"=",io,";","if(typeof "+i+'.constant === "number"){',c[eo[0]],"=",i,".constant;",eo.slice(1).map((function(t){return c[t]})).join("="),"=0;","}else{",eo.map((function(t,e){return c[t]+"="+i+".constant.length>"+e+"?"+i+".constant["+e+"]:0;"})).join(""),"}}else{","if(",u,"(",i,".buffer)){",l,"=",s,".createStream(",aa,",",i,".buffer);","}else{",l,"=",s,".getBuffer(",i,".buffer);","}",h,'="type" in ',i,"?",a.glTypes,"[",i,".type]:",l,".dtype;",c.normalized,"=!!",i,".normalized;"),d("size"),d("offset"),d("stride"),d("divisor"),r("}}"),r.exit("if(",c.isStream,"){",s,".destroyStream(",l,");","}"),c}a[t]=su(e,n)})),a}function G(t,e){var n=t.static,r=t.dynamic;if(Ko in n){var i=n[Ko];return null!==i&&null===f.getVAO(i)&&(i=f.createVAO(i)),uu((function(t){return t.link(f.getVAO(i))}))}if(Ko in r){var o=r[Ko];return su(o,(function(t,e){var n=t.invoke(e,o);return e.def(t.shared.vao+".getVAO("+n+")")}))}return null}function V(t){var e=t.static,n=t.dynamic,r={};return Object.keys(e).forEach((function(t){var n=e[t];r[t]=uu((function(t,e){return"number"===typeof n||"boolean"===typeof n?""+n:t.link(n)}))})),Object.keys(n).forEach((function(t){var e=n[t];r[t]=su(e,(function(t,n){return t.invoke(n,e)}))})),r}function z(t,e,n,i,o){var a=t.static,u=t.dynamic;nt.optional((function(){var t=[Go,Vo,zo,Ho,Wo,Xo,qo,Yo,Uo,Ko].concat(w);function e(e){Object.keys(e).forEach((function(e){nt.command(t.indexOf(e)>=0,'unknown parameter "'+e+'"',o.commandStr)}))}e(a),e(u)}));var s=j(t,e),c=k(t,o),l=P(t,c,o),h=L(t,o),d=B(t,o),p=D(t,o,s);function m(t){var e=l[t];e&&(d[t]=e)}m(Fo),m(S(Bo));var v=Object.keys(d).length>0,g={framebuffer:c,draw:h,shader:p,state:d,dirty:v,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(g.profile=N(t,o),g.uniforms=F(n,o),g.drawVAO=g.scopeVAO=G(t,o),!g.drawVAO&&p.program&&!s&&r.angle_instanced_arrays){var y=!0,b=p.program.attributes.map((function(t){var n=e.static[t];return y=y&&!!n,n}));if(y&&b.length>0){var E=f.getVAO(f.createVAO(b));g.drawVAO=new ou(null,null,null,(function(t,e){return t.link(E)})),g.useVAO=!0}}return s?g.useVAO=!0:g.attributes=U(e,o),g.context=V(i,o),g}function H(t,e,n){var r=t.shared.context,i=t.scope();Object.keys(n).forEach((function(o){e.save(r,"."+o);var a=n[o].append(t,e);Array.isArray(a)?i(r,".",o,"=[",a.join(),"];"):i(r,".",o,"=",a,";")})),e(i)}function W(t,e,n,r){var i,o=t.shared,a=o.gl,u=o.framebuffer;b&&(i=e.def(o.extensions,".webgl_draw_buffers"));var s,c=t.constants,f=c.drawBuffer,l=c.backBuffer;s=n?n.append(t,e):e.def(u,".next"),r||e("if(",s,"!==",u,".cur){"),e("if(",s,"){",a,".bindFramebuffer(",Ka,",",s,".framebuffer);"),b&&e(i,".drawBuffersWEBGL(",f,"[",s,".colorAttachments.length]);"),e("}else{",a,".bindFramebuffer(",Ka,",null);"),b&&e(i,".drawBuffersWEBGL(",l,");"),e("}",u,".cur=",s,";"),r||e("}")}function q(t,e,n){var r=t.shared,i=r.gl,o=t.current,a=t.next,u=r.current,s=r.next,c=t.cond(u,".dirty");w.forEach((function(e){var r,f,l=S(e);if(!(l in n.state))if(l in a){r=a[l],f=o[l];var h=At(E[l].length,(function(t){return c.def(r,"[",t,"]")}));c(t.cond(h.map((function(t,e){return t+"!=="+f+"["+e+"]"})).join("||")).then(i,".",T[l],"(",h,");",h.map((function(t,e){return f+"["+e+"]="+t})).join(";"),";"))}else{r=c.def(s,".",l);var d=t.cond(r,"!==",u,".",l);c(d),l in x?d(t.cond(r).then(i,".enable(",x[l],");").else(i,".disable(",x[l],");"),u,".",l,"=",r,";"):d(i,".",T[l],"(",r,");",u,".",l,"=",r,";")}})),0===Object.keys(n.state).length&&c(u,".dirty=false;"),e(c)}function X(t,e,n,r){var i=t.shared,o=t.current,a=i.current,u=i.gl;iu(Object.keys(n)).forEach((function(i){var s=n[i];if(!r||r(s)){var c=s.append(t,e);if(x[i]){var f=x[i];au(s)?e(u,c?".enable(":".disable(",f,");"):e(t.cond(c).then(u,".enable(",f,");").else(u,".disable(",f,");")),e(a,".",i,"=",c,";")}else if(ln(c)){var l=o[i];e(u,".",T[i],"(",c,");",c.map((function(t,e){return l+"["+e+"]="+t})).join(";"),";")}else e(u,".",T[i],"(",c,");",a,".",i,"=",c,";")}}))}function Y(t,e){y&&(t.instancing=e.def(t.shared.extensions,".angle_instanced_arrays"))}function K(t,e,n,r,i){var o,a,u,s=t.shared,c=t.stats,f=s.current,l=s.timer,h=n.profile;function d(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function m(t){t(o=e.def(),"=",d(),";"),"string"===typeof i?t(c,".count+=",i,";"):t(c,".count++;"),p&&(r?t(a=e.def(),"=",l,".getNumPendingQueries();"):t(l,".beginQuery(",c,");"))}function v(t){t(c,".cpuTime+=",d(),"-",o,";"),p&&(r?t(l,".pushScopeStats(",a,",",l,".getNumPendingQueries(),",c,");"):t(l,".endQuery();"))}function g(t){var n=e.def(f,".profile");e(f,".profile=",t,";"),e.exit(f,".profile=",n,";")}if(h){if(au(h))return void(h.enable?(m(e),v(e.exit),g("true")):g("false"));g(u=h.append(t,e))}else u=e.def(f,".profile");var y=t.block();m(y),e("if(",u,"){",y,"}");var b=t.block();v(b),e.exit("if(",u,"){",b,"}")}function Q(t,e,n,r,i){var o=t.shared;function a(t){switch(t){case Ea:case Ta:case Ra:return 2;case _a:case Sa:case Ca:return 3;case wa:case Aa:case Ma:return 4;default:return 1}}function u(n,r,i){var a=o.gl,u=e.def(n,".location"),s=e.def(o.attributes,"[",u,"]"),c=i.state,f=i.buffer,l=[i.x,i.y,i.z,i.w],h=["buffer","normalized","offset","stride"];function d(){e("if(!",s,".buffer){",a,".enableVertexAttribArray(",u,");}");var n,o=i.type;if(n=i.size?e.def(i.size,"||",r):r,e("if(",s,".type!==",o,"||",s,".size!==",n,"||",h.map((function(t){return s+"."+t+"!=="+i[t]})).join("||"),"){",a,".bindBuffer(",aa,",",f,".buffer);",a,".vertexAttribPointer(",[u,n,o,i.normalized,i.stride,i.offset],");",s,".type=",o,";",s,".size=",n,";",h.map((function(t){return s+"."+t+"="+i[t]+";"})).join(""),"}"),y){var c=i.divisor;e("if(",s,".divisor!==",c,"){",t.instancing,".vertexAttribDivisorANGLE(",[u,c],");",s,".divisor=",c,";}")}}function p(){e("if(",s,".buffer){",a,".disableVertexAttribArray(",u,");",s,".buffer=null;","}if(",eo.map((function(t,e){return s+"."+t+"!=="+l[e]})).join("||"),"){",a,".vertexAttrib4f(",u,",",l,");",eo.map((function(t,e){return s+"."+t+"="+l[e]+";"})).join(""),"}")}c===ro?d():c===io?p():(e("if(",c,"===",ro,"){"),d(),e("}else{"),p(),e("}"))}r.forEach((function(r){var o,s=r.name,c=n.attributes[s];if(c){if(!i(c))return;o=c.append(t,e)}else{if(!i(cu))return;var f=t.scopeAttrib(s);nt.optional((function(){t.assert(e,f+".state","missing attribute "+s)})),o={},Object.keys(new v).forEach((function(t){o[t]=e.def(f,".",t)}))}u(t.link(r),a(r.info.type),o)}))}function Z(t,e,r,i,o){for(var a,u=t.shared,s=u.gl,c=0;c<i.length;++c){var f,l=i[c],h=l.name,d=l.info.type,p=r.uniforms[h],m=t.link(l)+".location";if(p){if(!o(p))continue;if(au(p)){var v=p.value;if(nt.command(null!==v&&"undefined"!==typeof v,'missing uniform "'+h+'"',t.commandStr),d===Pa||d===ja){nt.command("function"===typeof v&&(d===Pa&&("texture2d"===v._reglType||"framebuffer"===v._reglType)||d===ja&&("textureCube"===v._reglType||"framebufferCube"===v._reglType)),"invalid texture for uniform "+h,t.commandStr);var g=t.link(v._texture||v.color[0]._texture);e(s,".uniform1i(",m,",",g+".bind());"),e.exit(g,".unbind();")}else if(d===Ia||d===Na||d===ka){nt.optional((function(){nt.command(ln(v),"invalid matrix for uniform "+h,t.commandStr),nt.command(d===Ia&&4===v.length||d===Na&&9===v.length||d===ka&&16===v.length,"invalid length for matrix uniform "+h,t.commandStr)}));var y=t.global.def("new Float32Array(["+Array.prototype.slice.call(v)+"])"),b=2;d===Na?b=3:d===ka&&(b=4),e(s,".uniformMatrix",b,"fv(",m,",false,",y,");")}else{switch(d){case ba:nt.commandType(v,"number","uniform "+h,t.commandStr),a="1f";break;case Ea:nt.command(ln(v)&&2===v.length,"uniform "+h,t.commandStr),a="2f";break;case _a:nt.command(ln(v)&&3===v.length,"uniform "+h,t.commandStr),a="3f";break;case wa:nt.command(ln(v)&&4===v.length,"uniform "+h,t.commandStr),a="4f";break;case Oa:nt.commandType(v,"boolean","uniform "+h,t.commandStr),a="1i";break;case xa:nt.commandType(v,"number","uniform "+h,t.commandStr),a="1i";break;case Ra:case Ta:nt.command(ln(v)&&2===v.length,"uniform "+h,t.commandStr),a="2i";break;case Ca:case Sa:nt.command(ln(v)&&3===v.length,"uniform "+h,t.commandStr),a="3i";break;case Ma:case Aa:nt.command(ln(v)&&4===v.length,"uniform "+h,t.commandStr),a="4i"}e(s,".uniform",a,"(",m,",",ln(v)?Array.prototype.slice.call(v):v,");")}continue}f=p.append(t,e)}else{if(!o(cu))continue;f=e.def(u.uniforms,"[",n.id(h),"]")}d===Pa?(nt(!Array.isArray(f),"must specify a scalar prop for textures"),e("if(",f,"&&",f,'._reglType==="framebuffer"){',f,"=",f,".color[0];","}")):d===ja&&(nt(!Array.isArray(f),"must specify a scalar prop for cube maps"),e("if(",f,"&&",f,'._reglType==="framebufferCube"){',f,"=",f,".color[0];","}")),nt.optional((function(){function n(n,r){t.assert(e,n,'bad data or missing for uniform "'+h+'".  '+r)}function r(t){nt(!Array.isArray(f),"must not specify an array type for uniform"),n("typeof "+f+'==="'+t+'"',"invalid type, expected "+t)}function i(e,r){Array.isArray(f)?nt(f.length===e,"must have length "+e):n(u.isArrayLike+"("+f+")&&"+f+".length==="+e,"invalid vector, should have length "+e,t.commandStr)}function o(e){nt(!Array.isArray(f),"must not specify a value type"),n("typeof "+f+'==="function"&&'+f+'._reglType==="texture'+(e===sa?"2d":"Cube")+'"',"invalid texture type",t.commandStr)}switch(d){case xa:case ba:r("number");break;case Ta:case Ea:i(2,"number");break;case Sa:case _a:i(3,"number");break;case Aa:case wa:case Ia:i(4,"number");break;case Oa:r("boolean");break;case Ra:i(2,"boolean");break;case Ca:i(3,"boolean");break;case Ma:i(4,"boolean");break;case Na:i(9,"number");break;case ka:i(16,"number");break;case Pa:o(sa);break;case ja:o(ca)}}));var E=1;switch(d){case Pa:case ja:var _=e.def(f,"._texture");e(s,".uniform1i(",m,",",_,".bind());"),e.exit(_,".unbind();");continue;case xa:case Oa:a="1i";break;case Ta:case Ra:a="2i",E=2;break;case Sa:case Ca:a="3i",E=3;break;case Aa:case Ma:a="4i",E=4;break;case ba:a="1f";break;case Ea:a="2f",E=2;break;case _a:a="3f",E=3;break;case wa:a="4f",E=4;break;case Ia:a="Matrix2fv";break;case Na:a="Matrix3fv";break;case ka:a="Matrix4fv"}if(e(s,".uniform",a,"(",m,","),"M"===a.charAt(0)){var w=Math.pow(d-Ia+2,2),x=t.global.def("new Float32Array(",w,")");Array.isArray(f)?e("false,(",At(w,(function(t){return x+"["+t+"]="+f[t]})),",",x,")"):e("false,(Array.isArray(",f,")||",f," instanceof Float32Array)?",f,":(",At(w,(function(t){return x+"["+t+"]="+f+"["+t+"]"})),",",x,")")}else E>1?e(At(E,(function(t){return Array.isArray(f)?f[t]:f+"["+t+"]"}))):(nt(!Array.isArray(f),"uniform value must not be an array"),e(f));e(");")}}function J(t,e,n,r){var i=t.shared,o=i.gl,a=i.draw,u=r.draw;function s(){var i,s=u.elements,c=e;return s?((s.contextDep&&r.contextDynamic||s.propDep)&&(c=n),i=s.append(t,c)):i=c.def(a,".",Ho),i&&c("if("+i+")"+o+".bindBuffer("+ua+","+i+".buffer.buffer);"),i}function c(){var i,o=u.count,s=e;return o?((o.contextDep&&r.contextDynamic||o.propDep)&&(s=n),i=o.append(t,s),nt.optional((function(){o.MISSING&&t.assert(e,"false","missing vertex count"),o.DYNAMIC&&t.assert(s,i+">=0","missing vertex count")}))):(i=s.def(a,".",qo),nt.optional((function(){t.assert(s,i+">=0","missing vertex count")}))),i}var f=s();function l(i){var o=u[i];return o?o.contextDep&&r.contextDynamic||o.propDep?o.append(t,n):o.append(t,e):e.def(a,".",i)}var h,d,p=l(Wo),m=l(Xo),v=c();if("number"===typeof v){if(0===v)return}else n("if(",v,"){"),n.exit("}");y&&(h=l(Yo),d=t.instancing);var g=f+".type",b=u.elements&&au(u.elements);function E(){function t(){n(d,".drawElementsInstancedANGLE(",[p,v,g,m+"<<(("+g+"-"+no+")>>1)",h],");")}function e(){n(d,".drawArraysInstancedANGLE(",[p,m,v,h],");")}f?b?t():(n("if(",f,"){"),t(),n("}else{"),e(),n("}")):e()}function _(){function t(){n(o+".drawElements("+[p,v,g,m+"<<(("+g+"-"+no+")>>1)"]+");")}function e(){n(o+".drawArrays("+[p,m,v]+");")}f?b?t():(n("if(",f,"){"),t(),n("}else{"),e(),n("}")):e()}y&&("number"!==typeof h||h>=0)?"string"===typeof h?(n("if(",h,">0){"),E(),n("}else if(",h,"<0){"),_(),n("}")):E():_()}function $(t,e,n,r,i){var o=I(),a=o.proc("body",i);return nt.optional((function(){o.commandStr=e.commandStr,o.command=o.link(e.commandStr)})),y&&(o.instancing=a.def(o.shared.extensions,".angle_instanced_arrays")),t(o,a,n,r),o.compile().body}function tt(t,e,n,r){Y(t,e),n.useVAO?n.drawVAO?e(t.shared.vao,".setVAO(",n.drawVAO.append(t,e),");"):e(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(e(t.shared.vao,".setVAO(null);"),Q(t,e,n,r.attributes,(function(){return!0}))),Z(t,e,n,r.uniforms,(function(){return!0})),J(t,e,e,n)}function et(t,e){var n=t.proc("draw",1);Y(t,n),H(t,n,e.context),W(t,n,e.framebuffer),q(t,n,e),X(t,n,e.state),K(t,n,e,!1,!0);var r=e.shader.progVar.append(t,n);if(n(t.shared.gl,".useProgram(",r,".program);"),e.shader.program)tt(t,n,e,e.shader.program);else{n(t.shared.vao,".setVAO(null);");var i=t.global.def("{}"),o=n.def(r,".id"),a=n.def(i,"[",o,"]");n(t.cond(a).then(a,".call(this,a0);").else(a,"=",i,"[",o,"]=",t.link((function(n){return $(tt,t,e,n,1)})),"(",r,");",a,".call(this,a0);"))}Object.keys(e.state).length>0&&n(t.shared.current,".dirty=true;")}function rt(t,e,n,r){function i(){return!0}t.batchId="a1",Y(t,e),Q(t,e,n,r.attributes,i),Z(t,e,n,r.uniforms,i),J(t,e,e,n)}function it(t,e,n,r){Y(t,e);var i=n.contextDep,o=e.def(),a="a0",u="a1",s=e.def();t.shared.props=s,t.batchId=o;var c=t.scope(),f=t.scope();function l(t){return t.contextDep&&i||t.propDep}function h(t){return!l(t)}if(e(c.entry,"for(",o,"=0;",o,"<",u,";++",o,"){",s,"=",a,"[",o,"];",f,"}",c.exit),n.needsContext&&H(t,f,n.context),n.needsFramebuffer&&W(t,f,n.framebuffer),X(t,f,n.state,l),n.profile&&l(n.profile)&&K(t,f,n,!1,!0),r)n.useVAO?n.drawVAO?l(n.drawVAO)?f(t.shared.vao,".setVAO(",n.drawVAO.append(t,f),");"):c(t.shared.vao,".setVAO(",n.drawVAO.append(t,c),");"):c(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(c(t.shared.vao,".setVAO(null);"),Q(t,c,n,r.attributes,h),Q(t,f,n,r.attributes,l)),Z(t,c,n,r.uniforms,h),Z(t,f,n,r.uniforms,l),J(t,c,f,n);else{var d=t.global.def("{}"),p=n.shader.progVar.append(t,f),m=f.def(p,".id"),v=f.def(d,"[",m,"]");f(t.shared.gl,".useProgram(",p,".program);","if(!",v,"){",v,"=",d,"[",m,"]=",t.link((function(e){return $(rt,t,n,e,2)})),"(",p,");}",v,".call(this,a0[",o,"],",o,");")}}function ot(t,e){var n=t.proc("batch",2);t.batchId="0",Y(t,n);var r=!1,i=!0;Object.keys(e.context).forEach((function(t){r=r||e.context[t].propDep})),r||(H(t,n,e.context),i=!1);var o=e.framebuffer,a=!1;function u(t){return t.contextDep&&r||t.propDep}o?(o.propDep?r=a=!0:o.contextDep&&r&&(a=!0),a||W(t,n,o)):W(t,n,null),e.state.viewport&&e.state.viewport.propDep&&(r=!0),q(t,n,e),X(t,n,e.state,(function(t){return!u(t)})),e.profile&&u(e.profile)||K(t,n,e,!1,"a1"),e.contextDep=r,e.needsContext=i,e.needsFramebuffer=a;var s=e.shader.progVar;if(s.contextDep&&r||s.propDep)it(t,n,e,null);else{var c=s.append(t,n);if(n(t.shared.gl,".useProgram(",c,".program);"),e.shader.program)it(t,n,e,e.shader.program);else{n(t.shared.vao,".setVAO(null);");var f=t.global.def("{}"),l=n.def(c,".id"),h=n.def(f,"[",l,"]");n(t.cond(h).then(h,".call(this,a0,a1);").else(h,"=",f,"[",l,"]=",t.link((function(n){return $(it,t,e,n,2)})),"(",c,");",h,".call(this,a0,a1);"))}}Object.keys(e.state).length>0&&n(t.shared.current,".dirty=true;")}function at(t,e){var r=t.proc("scope",3);t.batchId="a2";var i=t.shared,o=i.current;function a(n){var o=e.shader[n];o&&r.set(i.shader,"."+n,o.append(t,r))}H(t,r,e.context),e.framebuffer&&e.framebuffer.append(t,r),iu(Object.keys(e.state)).forEach((function(n){var o=e.state[n].append(t,r);ln(o)?o.forEach((function(e,i){r.set(t.next[n],"["+i+"]",e)})):r.set(i.next,"."+n,o)})),K(t,r,e,!0,!0),[Ho,Xo,qo,Yo,Wo].forEach((function(n){var o=e.draw[n];o&&r.set(i.draw,"."+n,""+o.append(t,r))})),Object.keys(e.uniforms).forEach((function(o){var a=e.uniforms[o].append(t,r);Array.isArray(a)&&(a="["+a.join()+"]"),r.set(i.uniforms,"["+n.id(o)+"]",a)})),Object.keys(e.attributes).forEach((function(n){var i=e.attributes[n].append(t,r),o=t.scopeAttrib(n);Object.keys(new v).forEach((function(t){r.set(o,"."+t,i[t])}))})),e.scopeVAO&&r.set(i.vao,".targetVAO",e.scopeVAO.append(t,r)),a(Vo),a(zo),Object.keys(e.state).length>0&&(r(o,".dirty=true;"),r.exit(o,".dirty=true;")),r("a1(",t.shared.context,",a0,",t.batchId,");")}function ut(t){if("object"===typeof t&&!ln(t)){for(var e=Object.keys(t),n=0;n<e.length;++n)if(pt.isDynamic(t[e[n]]))return!0;return!1}}function st(t,e,n){var r=e.static[n];if(r&&ut(r)){var i=t.global,o=Object.keys(r),a=!1,u=!1,s=!1,c=t.global.def("{}");o.forEach((function(e){var n=r[e];if(pt.isDynamic(n)){"function"===typeof n&&(n=r[e]=pt.unbox(n));var o=su(n,null);a=a||o.thisDep,s=s||o.propDep,u=u||o.contextDep}else{switch(i(c,".",e,"="),typeof n){case"number":i(n);break;case"string":i('"',n,'"');break;case"object":Array.isArray(n)&&i("[",n.join(),"]");break;default:i(t.link(n))}i(";")}})),e.dynamic[n]=new pt.DynamicVariable(co,{thisDep:a,contextDep:u,propDep:s,ref:c,append:f}),delete e.static[n]}function f(t,e){o.forEach((function(n){var i=r[n];if(pt.isDynamic(i)){var o=t.invoke(e,i);e(c,".",n,"=",o,";")}}))}}function ct(t,n,r,i,o){var a=I();a.stats=a.link(o),Object.keys(n.static).forEach((function(t){st(a,n,t)})),oa.forEach((function(e){st(a,t,e)}));var u=z(t,n,r,i,a);return et(a,u),at(a,u),ot(a,u),e(a.compile(),{destroy:function(){u.shader.program.destroy()}})}return{next:_,current:E,procs:function(){var t=I(),e=t.proc("poll"),n=t.proc("refresh"),o=t.block();e(o),n(o);var a,u=t.shared,s=u.gl,c=u.next,f=u.current;o(f,".dirty=false;"),W(t,e),W(t,n,null,!0),y&&(a=t.link(y)),r.oes_vertex_array_object&&n(t.link(r.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var l=0;l<i.maxAttributes;++l){var h=n.def(u.attributes,"[",l,"]"),d=t.cond(h,".buffer");d.then(s,".enableVertexAttribArray(",l,");",s,".bindBuffer(",aa,",",h,".buffer.buffer);",s,".vertexAttribPointer(",l,",",h,".size,",h,".type,",h,".normalized,",h,".stride,",h,".offset);").else(s,".disableVertexAttribArray(",l,");",s,".vertexAttrib4f(",l,",",h,".x,",h,".y,",h,".z,",h,".w);",h,".buffer=null;"),n(d),y&&n(a,".vertexAttribDivisorANGLE(",l,",",h,".divisor);")}return n(t.shared.vao,".currentVAO=null;",t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"),Object.keys(x).forEach((function(r){var i=x[r],a=o.def(c,".",r),u=t.block();u("if(",a,"){",s,".enable(",i,")}else{",s,".disable(",i,")}",f,".",r,"=",a,";"),n(u),e("if(",a,"!==",f,".",r,"){",u,"}")})),Object.keys(T).forEach((function(r){var i,a,u=T[r],l=E[r],h=t.block();if(h(s,".",u,"("),ln(l)){var d=l.length;i=t.global.def(c,".",r),a=t.global.def(f,".",r),h(At(d,(function(t){return i+"["+t+"]"})),");",At(d,(function(t){return a+"["+t+"]="+i+"["+t+"];"})).join("")),e("if(",At(d,(function(t){return i+"["+t+"]!=="+a+"["+t+"]"})).join("||"),"){",h,"}")}else i=o.def(c,".",r),a=o.def(f,".",r),h(i,");",f,".",r,"=",i,";"),e("if(",i,"!==",a,"){",h,"}");n(h)})),t.compile()}(),compile:ct}}function lu(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var hu=34918,du=34919,pu=35007,mu=function(t,e){if(!e.ext_disjoint_timer_query)return null;var n=[];function r(){return n.pop()||e.ext_disjoint_timer_query.createQueryEXT()}function i(t){n.push(t)}var o=[];function a(t){var n=r();e.ext_disjoint_timer_query.beginQueryEXT(pu,n),o.push(n),d(o.length-1,o.length,t)}function u(){e.ext_disjoint_timer_query.endQueryEXT(pu)}function s(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var c=[];function f(){return c.pop()||new s}function l(t){c.push(t)}var h=[];function d(t,e,n){var r=f();r.startQueryIndex=t,r.endQueryIndex=e,r.sum=0,r.stats=n,h.push(r)}var p=[],m=[];function v(){var t,n,r=o.length;if(0!==r){m.length=Math.max(m.length,r+1),p.length=Math.max(p.length,r+1),p[0]=0,m[0]=0;var a=0;for(t=0,n=0;n<o.length;++n){var u=o[n];e.ext_disjoint_timer_query.getQueryObjectEXT(u,du)?(a+=e.ext_disjoint_timer_query.getQueryObjectEXT(u,hu),i(u)):o[t++]=u,p[n+1]=a,m[n+1]=t}for(o.length=t,t=0,n=0;n<h.length;++n){var s=h[n],c=s.startQueryIndex,f=s.endQueryIndex;s.sum+=p[f]-p[c];var d=m[c],v=m[f];v===d?(s.stats.gpuTime+=s.sum/1e6,l(s)):(s.startQueryIndex=d,s.endQueryIndex=v,h[t++]=s)}h.length=t}}return{beginQuery:a,endQuery:u,pushScopeStats:d,update:v,getNumPendingQueries:function(){return o.length},clear:function(){n.push.apply(n,o);for(var t=0;t<n.length;t++)e.ext_disjoint_timer_query.deleteQueryEXT(n[t]);o.length=0,n.length=0},restore:function(){o.length=0,n.length=0}}},vu=16384,gu=256,yu=1024,bu=34962,Eu="webglcontextlost",_u="webglcontextrestored",wu=1,xu=2,Tu=3;function Su(t,e){for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}function Au(t){var n=Tt(t);if(!n)return null;var r=n.gl,i=r.getContextAttributes(),o=r.isContextLost(),a=St(r,n);if(!a)return null;var u=gt(),s=lu(),c=a.extensions,f=mu(r,c),l=vt(),h=r.drawingBufferWidth,d=r.drawingBufferHeight,p={tick:0,time:0,viewportWidth:h,viewportHeight:d,framebufferWidth:h,framebufferHeight:d,drawingBufferWidth:h,drawingBufferHeight:d,pixelRatio:n.pixelRatio},m={},v={elements:null,primitive:4,count:-1,offset:0,instances:-1},g=we(r,c),y=We(r,s,n,E),b=Gi(r,c,g,s,y);function E(t){return b.destroyBuffer(t)}var _=an(r,c,y,s),w=qi(r,u,s,n),x=Kr(r,c,g,(function(){A.procs.poll()}),p,s,n),T=ci(r,c,g,s,n),S=Li(r,c,g,x,T,s),A=fu(r,u,c,g,y,_,x,S,m,b,w,v,p,f,n),O=Zi(r,S,A.procs.poll,p,i,c,g),R=A.next,C=r.canvas,M=[],I=[],N=[],k=[n.onDestroy],P=null;function j(){if(0===M.length)return f&&f.update(),void(P=null);P=mt.next(j),X();for(var t=M.length-1;t>=0;--t){var e=M[t];e&&e(p,null,0)}r.flush(),f&&f.update()}function D(){!P&&M.length>0&&(P=mt.next(j))}function L(){P&&(mt.cancel(j),P=null)}function B(t){t.preventDefault(),o=!0,L(),I.forEach((function(t){t()}))}function F(t){r.getError(),o=!1,a.restore(),w.restore(),y.restore(),x.restore(),T.restore(),S.restore(),b.restore(),f&&f.restore(),A.procs.refresh(),D(),N.forEach((function(t){t()}))}function U(){M.length=0,L(),C&&(C.removeEventListener(Eu,B),C.removeEventListener(_u,F)),w.clear(),S.clear(),T.clear(),x.clear(),_.clear(),y.clear(),b.clear(),f&&f.clear(),k.forEach((function(t){t()}))}function G(t){function n(t){var n=e({},t);function r(t){if(t in n){var e=n[t];delete n[t],Object.keys(e).forEach((function(r){n[t+"."+r]=e[r]}))}}return delete n.uniforms,delete n.attributes,delete n.context,delete n.vao,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),r("blend"),r("depth"),r("cull"),r("stencil"),r("polygonOffset"),r("scissor"),r("sample"),"vao"in t&&(n.vao=t.vao),n}function r(t,e){var n={},r={};return Object.keys(t).forEach((function(i){var o=t[i];if(pt.isDynamic(o))r[i]=pt.unbox(o,i);else{if(e&&Array.isArray(o))for(var a=0;a<o.length;++a)if(pt.isDynamic(o[a]))return void(r[i]=pt.unbox(o,i));n[i]=o}})),{dynamic:r,static:n}}nt(!!t,"invalid args to regl({...})"),nt.type(t,"object","invalid args to regl({...})");var i=r(t.context||{},!0),a=r(t.uniforms||{},!0),u=r(t.attributes||{},!1),s=r(n(t),!1),c={gpuTime:0,cpuTime:0,count:0},f=A.compile(s,u,a,i,c),l=f.draw,h=f.batch,d=f.scope,p=[];function m(t){for(;p.length<t;)p.push(null);return p}function v(t,e){var n;if(o&&nt.raise("context lost"),"function"===typeof t)return d.call(this,null,t,0);if("function"===typeof e)if("number"===typeof t)for(n=0;n<t;++n)d.call(this,null,e,n);else{if(!Array.isArray(t))return d.call(this,t,e,0);for(n=0;n<t.length;++n)d.call(this,t[n],e,n)}else if("number"===typeof t){if(t>0)return h.call(this,m(0|t),0|t)}else{if(!Array.isArray(t))return l.call(this,t);if(t.length)return h.call(this,t,t.length)}}return e(v,{stats:c,destroy:function(){f.destroy()}})}C&&(C.addEventListener(Eu,B,!1),C.addEventListener(_u,F,!1));var V=S.setFBO=G({framebuffer:pt.define.call(null,wu,"framebuffer")});function z(t,e){var n=0;A.procs.poll();var i=e.color;i&&(r.clearColor(+i[0]||0,+i[1]||0,+i[2]||0,+i[3]||0),n|=vu),"depth"in e&&(r.clearDepth(+e.depth),n|=gu),"stencil"in e&&(r.clearStencil(0|e.stencil),n|=yu),nt(!!n,"called regl.clear with no buffer specified"),r.clear(n)}function H(t){if(nt("object"===typeof t&&t,"regl.clear() takes an object as input"),"framebuffer"in t)if(t.framebuffer&&"framebufferCube"===t.framebuffer_reglType)for(var n=0;n<6;++n)V(e({framebuffer:t.framebuffer.faces[n]},t),z);else V(t,z);else z(null,t)}function W(t){function e(){var e=Su(M,t);function n(){var t=Su(M,n);M[t]=M[M.length-1],M.length-=1,M.length<=0&&L()}nt(e>=0,"cannot cancel a frame twice"),M[e]=n}return nt.type(t,"function","regl.frame() callback must be a function"),M.push(t),D(),{cancel:e}}function q(){var t=R.viewport,e=R.scissor_box;t[0]=t[1]=e[0]=e[1]=0,p.viewportWidth=p.framebufferWidth=p.drawingBufferWidth=t[2]=e[2]=r.drawingBufferWidth,p.viewportHeight=p.framebufferHeight=p.drawingBufferHeight=t[3]=e[3]=r.drawingBufferHeight}function X(){p.tick+=1,p.time=K(),q(),A.procs.poll()}function Y(){x.refresh(),q(),A.procs.refresh(),f&&f.update()}function K(){return(vt()-l)/1e3}function Q(t,e){var n;switch(nt.type(e,"function","listener callback must be a function"),t){case"frame":return W(e);case"lost":n=I;break;case"restore":n=N;break;case"destroy":n=k;break;default:nt.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(e),{cancel:function(){for(var t=0;t<n.length;++t)if(n[t]===e)return n[t]=n[n.length-1],void n.pop()}}}Y();var Z=e(G,{clear:H,prop:pt.define.bind(null,wu),context:pt.define.bind(null,xu),this:pt.define.bind(null,Tu),draw:G({}),buffer:function(t){return y.create(t,bu,!1,!1)},elements:function(t){return _.create(t,!1)},texture:x.create2D,cube:x.createCube,renderbuffer:T.create,framebuffer:S.create,framebufferCube:S.createCube,vao:b.createVAO,attributes:i,frame:W,on:Q,limits:g,hasExtension:function(t){return g.extensions.indexOf(t.toLowerCase())>=0},read:O,destroy:U,_gl:r,_refresh:Y,poll:function(){X(),f&&f.update()},now:K,stats:s});return n.onDone(null,Z),Z}return Au}()},2677:function(t,e,n){t.exports={EPSILON:n(1934),create:n(1935),clone:n(2678),fromValues:n(2679),copy:n(2680),set:n(1936),equals:n(2681),exactEquals:n(2682),add:n(1937),subtract:n(1463),sub:n(2683),multiply:n(1938),mul:n(2684),divide:n(1939),div:n(2685),inverse:n(2686),min:n(2687),max:n(2688),rotate:n(2689),floor:n(2690),ceil:n(2691),round:n(2692),scale:n(2693),scaleAndAdd:n(2694),distance:n(1940),dist:n(2695),squaredDistance:n(1941),sqrDist:n(2696),length:n(1942),len:n(2697),squaredLength:n(1943),sqrLen:n(2698),negate:n(2699),normalize:n(1944),dot:n(1945),cross:n(2700),lerp:n(2701),random:n(2702),transformMat2:n(2703),transformMat2d:n(2704),transformMat3:n(2705),transformMat4:n(2706),forEach:n(2707),limit:n(2708)}},2678:function(t,e){t.exports=function(t){var e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}},2679:function(t,e){t.exports=function(t,e){var n=new Float32Array(2);return n[0]=t,n[1]=e,n}},2680:function(t,e){t.exports=function(t,e){return t[0]=e[0],t[1]=e[1],t}},2681:function(t,e,n){t.exports=function(t,e){var n=t[0],i=t[1],o=e[0],a=e[1];return Math.abs(n-o)<=r*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-a)<=r*Math.max(1,Math.abs(i),Math.abs(a))};var r=n(1934)},2682:function(t,e){t.exports=function(t,e){return t[0]===e[0]&&t[1]===e[1]}},2683:function(t,e,n){t.exports=n(1463)},2684:function(t,e,n){t.exports=n(1938)},2685:function(t,e,n){t.exports=n(1939)},2686:function(t,e){t.exports=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}},2687:function(t,e){t.exports=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}},2688:function(t,e){t.exports=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}},2689:function(t,e){t.exports=function(t,e,n){var r=Math.cos(n),i=Math.sin(n),o=e[0],a=e[1];return t[0]=o*r-a*i,t[1]=o*i+a*r,t}},2690:function(t,e){t.exports=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}},2691:function(t,e){t.exports=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}},2692:function(t,e){t.exports=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}},2693:function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}},2694:function(t,e){t.exports=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}},2695:function(t,e,n){t.exports=n(1940)},2696:function(t,e,n){t.exports=n(1941)},2697:function(t,e,n){t.exports=n(1942)},2698:function(t,e,n){t.exports=n(1943)},2699:function(t,e){t.exports=function(t,e){return t[0]=-e[0],t[1]=-e[1],t}},2700:function(t,e){t.exports=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}},2701:function(t,e){t.exports=function(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}},2702:function(t,e){t.exports=function(t,e){e=e||1;var n=2*Math.random()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}},2703:function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}},2704:function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}},2705:function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}},2706:function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}},2707:function(t,e,n){t.exports=function(t,e,n,i,o,a){var u,s;e||(e=2);n||(n=0);s=i?Math.min(i*e+n,t.length):t.length;for(u=n;u<s;u+=e)r[0]=t[u],r[1]=t[u+1],o(r,r,a),t[u]=r[0],t[u+1]=r[1];return t};var r=n(1935)()},2708:function(t,e){t.exports=function(t,e,n){var r=e[0]*e[0]+e[1]*e[1];if(r>n*n){var i=Math.sqrt(r);t[0]=e[0]/i*n,t[1]=e[1]/i*n}else t[0]=e[0],t[1]=e[1];return t}},2709:function(t,e,n){var r=n(1937),i=n(1936),o=n(1944),a=n(1463),u=n(1945),s=[0,0];t.exports.computeMiter=function(t,e,n,a,c){return r(t,n,a),o(t,t),i(e,-t[1],t[0]),i(s,-n[1],n[0]),c/u(e,s)},t.exports.normal=function(t,e){return i(t,-e[1],e[0]),t},t.exports.direction=function(t,e,n){return a(t,e,n),o(t,t),t}},2712:function(t,e,n){"use strict";var r=n(79);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(80)),o=n(0),a=(0,i.default)((0,o.jsx)("path",{d:"M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"}),"Dashboard");e.default=a},2915:function(t,e,n){"use strict";n.d(e,"b",(function(){return g})),n.d(e,"a",(function(){return Z}));var r=n(4),i=n(28),o=n(6),a=n(7),u=n(5),s=function(){function t(){Object(r.a)(this,t),this.nodes=[],this.edges=[],this.combos=[],this.positions=[],this.destroyed=!1,this.onLayoutEnd=function(){}}return Object(u.a)(t,[{key:"layout",value:function(t){return this.init(t),this.execute(!0)}},{key:"init",value:function(t){this.nodes=t.nodes||[],this.edges=t.edges||[],this.combos=t.combos||[]}},{key:"execute",value:function(t){}},{key:"executeWithWorker",value:function(){}},{key:"getDefaultCfg",value:function(){return{}}},{key:"updateCfg",value:function(t){t&&Object.assign(this,t)}},{key:"getType",value:function(){return"base"}},{key:"destroy",value:function(){this.nodes=null,this.edges=null,this.combos=null,this.positions=null,this.destroyed=!0}}]),t}(),c=function(t){return"string"===typeof t},f=/-(\w)/g,l=(function(t){var e=Object.create(null)}((function(t){return t.replace(f,(function(t,e){return e?e.toUpperCase():""}))})),Array.isArray),h=function(t){return"number"===typeof t},d=function(t){return Number.isNaN(Number(t))},p=function(t){return null!==t&&"object"===typeof t},m=function(t,e){var n=t[e];return p(n)?n.cell:n},v=function(t,e,n){for(var r=[],i=0;i<t;i++)r[i]=0;return n?(n.forEach((function(t){var n=m(t,"source"),i=m(t,"target");n&&(r[e[n]]+=1),i&&(r[e[i]]+=1)})),r):r},g=(new Map,function(t){Object(o.a)(n,t);var e=Object(a.a)(n);function n(t){var i;return Object(r.a)(this,n),(i=e.call(this)).begin=[0,0],i.preventOverlap=!0,i.preventOverlapPadding=10,i.condense=!1,i.sortBy="degree",i.nodeSize=30,i.nodes=[],i.edges=[],i.width=300,i.height=300,i.row=0,i.col=0,i.cellWidth=0,i.cellHeight=0,i.cellUsed={},i.id2manPos={},i.onLayoutEnd=function(){},i.updateCfg(t),i}return Object(u.a)(n,[{key:"getDefaultCfg",value:function(){return{begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30}}},{key:"execute",value:function(){var t=this,e=t.nodes,n=t.edges,r=e.length,i=t.begin;if(0===r)return t.onLayoutEnd&&t.onLayoutEnd(),{nodes:e,edges:n};if(1===r)return e[0].x=i[0],e[0].y=i[1],t.onLayoutEnd&&t.onLayoutEnd(),{nodes:e,edges:n};var o=[];e.forEach((function(t){o.push(t)}));var a={};if(o.forEach((function(t,e){a[t.id]=e})),("degree"===t.sortBy||!c(t.sortBy)||void 0===o[0][t.sortBy])&&(t.sortBy="degree",d(e[0].degree))){var u=v(o.length,a,n);o.forEach((function(t,e){t.degree=u[e]}))}o.sort((function(e,n){return n[t.sortBy]-e[t.sortBy]})),t.width||"undefined"===typeof window||(t.width=window.innerWidth),t.height||"undefined"===typeof window||(t.height=window.innerHeight);var s=t.rows,f=null!=t.cols?t.cols:t.columns;if(t.cells=r,null!=s&&null!=f?(t.rows=s,t.cols=f):null!=s&&null==f?(t.rows=s,t.cols=Math.ceil(t.cells/t.rows)):null==s&&null!=f?(t.cols=f,t.rows=Math.ceil(t.cells/t.cols)):(t.splits=Math.sqrt(t.cells*t.height/t.width),t.rows=Math.round(t.splits),t.cols=Math.round(t.width/t.height*t.splits)),t.cols*t.rows>t.cells){var m=t.small(),g=t.large();(m-1)*g>=t.cells?t.small(m-1):(g-1)*m>=t.cells&&t.large(g-1)}else for(;t.cols*t.rows<t.cells;){var y=t.small(),b=t.large();(b+1)*y>=t.cells?t.large(b+1):t.small(y+1)}t.cellWidth=t.width/t.cols,t.cellHeight=t.height/t.rows,t.condense&&(t.cellWidth=0,t.cellHeight=0),t.preventOverlap&&o.forEach((function(e){var n,r;e.x&&e.y||(e.x=0,e.y=0),l(e.size)?(n=e.size[0],r=e.size[1]):h(e.size)?(n=e.size,r=e.size):p(e.size)&&(n=e.size.width,r=e.size.height),void 0!==n&&void 0!==r||(l(t.nodeSize)?(n=t.nodeSize[0],r=t.nodeSize[1]):h(t.nodeSize)?(n=t.nodeSize,r=t.nodeSize):(n=30,r=30));var i=t.preventOverlapPadding,o=n+i,a=r+i;t.cellWidth=Math.max(t.cellWidth,o),t.cellHeight=Math.max(t.cellHeight,a)})),t.cellUsed={},t.row=0,t.col=0,t.id2manPos={};for(var E=0;E<o.length;E++){var _=o[E],w=void 0;if(t.position&&(w=t.position(_)),w&&(void 0!==w.row||void 0!==w.col)){var x={row:w.row,col:w.col};if(void 0===x.col)for(x.col=0;t.used(x.row,x.col);)x.col++;else if(void 0===x.row)for(x.row=0;t.used(x.row,x.col);)x.row++;t.id2manPos[_.id]=x,t.use(x.row,x.col)}t.getPos(_)}return t.onLayoutEnd&&t.onLayoutEnd(),{edges:n,nodes:o}}},{key:"small",value:function(t){var e,n=this,r=n.rows||5,i=n.cols||5;null==t?e=Math.min(r,i):Math.min(r,i)===n.rows?n.rows=t:n.cols=t;return e}},{key:"large",value:function(t){var e,n=this,r=n.rows||5,i=n.cols||5;null==t?e=Math.max(r,i):Math.max(r,i)===n.rows?n.rows=t:n.cols=t;return e}},{key:"used",value:function(t,e){return this.cellUsed["c-".concat(t,"-").concat(e)]||!1}},{key:"use",value:function(t,e){this.cellUsed["c-".concat(t,"-").concat(e)]=!0}},{key:"moveToNextCell",value:function(){var t=this,e=t.cols||5;t.col++,t.col>=e&&(t.col=0,t.row++)}},{key:"getPos",value:function(t){var e,n,r=this,i=r.begin,o=r.cellWidth,a=r.cellHeight,u=r.id2manPos[t.id];if(u)e=u.col*o+o/2+i[0],n=u.row*a+a/2+i[1];else{for(;r.used(r.row,r.col);)r.moveToNextCell();e=r.col*o+o/2+i[0],n=r.row*a+a/2+i[1],r.use(r.row,r.col),r.moveToNextCell()}t.x=e,t.y=n}},{key:"getType",value:function(){return"grid"}}]),n}(s));function y(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,a,u,s,c,f,l,h,d=t._root,p={data:r},m=t._x0,v=t._y0,g=t._x1,y=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((c=e>=(o=(m+g)/2))?m=o:g=o,(f=n>=(a=(v+y)/2))?v=a:y=a,i=d,!(d=d[l=f<<1|c]))return i[l]=p,t;if(u=+t._x.call(null,d.data),s=+t._y.call(null,d.data),e===u&&n===s)return p.next=d,i?i[l]=p:t._root=p,t;do{i=i?i[l]=new Array(4):t._root=new Array(4),(c=e>=(o=(m+g)/2))?m=o:g=o,(f=n>=(a=(v+y)/2))?v=a:y=a}while((l=f<<1|c)===(h=(s>=a)<<1|u>=o));return i[h]=d,i[l]=p,t}var b=function(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i};function E(t){return t[0]}function _(t){return t[1]}function w(t,e,n){var r=new x(null==e?E:e,null==n?_:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function x(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function T(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var S=w.prototype=x.prototype;S.copy=function(){var t,e,n=new x(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=T(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=T(e));return n},S.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return y(this.cover(e,n),e,n,t)},S.addAll=function(t){var e,n,r,i,o=t.length,a=new Array(o),u=new Array(o),s=1/0,c=1/0,f=-1/0,l=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(a[n]=r,u[n]=i,r<s&&(s=r),r>f&&(f=r),i<c&&(c=i),i>l&&(l=i));if(s>f||c>l)return this;for(this.cover(s,c).cover(f,l),n=0;n<o;++n)y(this,a[n],u[n],t[n]);return this},S.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var a,u,s=i-n||1,c=this._root;n>t||t>=i||r>e||e>=o;)switch(u=(e<r)<<1|t<n,(a=new Array(4))[u]=c,c=a,s*=2,u){case 0:i=n+s,o=r+s;break;case 1:n=i-s,o=r+s;break;case 2:i=n+s,r=o-s;break;case 3:n=i-s,r=o-s}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},S.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},S.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},S.find=function(t,e,n){var r,i,o,a,u,s,c,f=this._x0,l=this._y0,h=this._x1,d=this._y1,p=[],m=this._root;for(m&&p.push(new b(m,f,l,h,d)),null==n?n=1/0:(f=t-n,l=e-n,h=t+n,d=e+n,n*=n);s=p.pop();)if(!(!(m=s.node)||(i=s.x0)>h||(o=s.y0)>d||(a=s.x1)<f||(u=s.y1)<l))if(m.length){var v=(i+a)/2,g=(o+u)/2;p.push(new b(m[3],v,g,a,u),new b(m[2],i,g,v,u),new b(m[1],v,o,a,g),new b(m[0],i,o,v,g)),(c=(e>=g)<<1|t>=v)&&(s=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=s)}else{var y=t-+this._x.call(null,m.data),E=e-+this._y.call(null,m.data),_=y*y+E*E;if(_<n){var w=Math.sqrt(n=_);f=t-w,l=e-w,h=t+w,d=e+w,r=m.data}}return r},S.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,r,i,o,a,u,s,c,f,l,h,d=this._root,p=this._x0,m=this._y0,v=this._x1,g=this._y1;if(!d)return this;if(d.length)for(;;){if((c=o>=(u=(p+v)/2))?p=u:v=u,(f=a>=(s=(m+g)/2))?m=s:g=s,e=d,!(d=d[l=f<<1|c]))return this;if(!d.length)break;(e[l+1&3]||e[l+2&3]||e[l+3&3])&&(n=e,h=l)}for(;d.data!==t;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):e?(i?e[l]=i:delete e[l],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[h]=d:this._root=d),this):(this._root=i,this)},S.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},S.root=function(){return this._root},S.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},S.visit=function(t){var e,n,r,i,o,a,u=[],s=this._root;for(s&&u.push(new b(s,this._x0,this._y0,this._x1,this._y1));e=u.pop();)if(!t(s=e.node,r=e.x0,i=e.y0,o=e.x1,a=e.y1)&&s.length){var c=(r+o)/2,f=(i+a)/2;(n=s[3])&&u.push(new b(n,c,f,o,a)),(n=s[2])&&u.push(new b(n,r,f,c,a)),(n=s[1])&&u.push(new b(n,c,i,o,f)),(n=s[0])&&u.push(new b(n,r,i,c,f))}return this},S.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new b(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,a=e.x0,u=e.y0,s=e.x1,c=e.y1,f=(a+s)/2,l=(u+c)/2;(o=i[0])&&n.push(new b(o,a,u,f,l)),(o=i[1])&&n.push(new b(o,f,u,s,l)),(o=i[2])&&n.push(new b(o,a,l,f,c)),(o=i[3])&&n.push(new b(o,f,l,s,c))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},S.x=function(t){return arguments.length?(this._x=t,this):this._x},S.y=function(t){return arguments.length?(this._y=t,this):this._y};var A={value:function(){}};function O(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new R(r)}function R(t){this._=t}function C(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function M(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function I(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=A,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}R.prototype=O.prototype={constructor:R,on:function(t,e){var n,r=this._,i=C(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!==typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=i[o]).type)r[n]=I(r[n],t.name,e);else if(null==e)for(n in r)r[n]=I(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=i[o]).type)&&(n=M(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new R(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var N,k,P=0,j=0,D=0,L=0,B=0,F=0,U="object"===typeof performance&&performance.now?performance:Date,G="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function V(){return B||(G(z),B=U.now()+F)}function z(){B=0}function H(){this._call=this._time=this._next=null}function W(t,e,n){var r=new H;return r.restart(t,e,n),r}function q(){B=(L=U.now())+F,P=j=0;try{!function(){V(),++P;for(var t,e=N;e;)(t=B-e._time)>=0&&e._call.call(null,t),e=e._next;--P}()}finally{P=0,function(){var t,e,n=N,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:N=e);k=t,Y(r)}(),B=0}}function X(){var t=U.now(),e=t-L;e>1e3&&(F-=e,L=t)}function Y(t){P||(j&&(j=clearTimeout(j)),t-B>24?(t<1/0&&(j=setTimeout(q,t-U.now()-F)),D&&(D=clearInterval(D))):(D||(L=U.now(),D=setInterval(X,1e3)),P=1,G(q)))}H.prototype=W.prototype={constructor:H,restart:function(t,e,n){if("function"!==typeof t)throw new TypeError("callback is not a function");n=(null==n?V():+n)+(null==e?0:+e),this._next||k===this||(k?k._next=this:N=this,k=this),this._call=t,this._time=n,Y()},stop:function(){this._call&&(this._call=null,this._time=1/0,Y())}};Math.PI,Math.sqrt(5);n(18);var K=n(2560),Q=n.n(K),Z=function(t){Object(o.a)(n,t);var e=Object(a.a)(n);function n(t){var o;return Object(r.a)(this,n),(o=e.call(this)).rankdir="TB",o.nodesep=50,o.ranksep=50,o.controlPoints=!1,o.sortByCombo=!1,o.edgeLabelSpace=!0,o.keepNodeOrder=!1,o.nodes=[],o.edges=[],o.onLayoutEnd=function(){},o.layoutNode=function(t){var e=Object(i.a)(o).nodes.find((function(e){return e.id===t}));return!e||!1!==e.layout},o.updateCfg(t),o}return Object(u.a)(n,[{key:"getDefaultCfg",value:function(){return{rankdir:"TB",align:void 0,nodeSize:void 0,nodesepFunc:void 0,ranksepFunc:void 0,nodesep:50,ranksep:50,controlPoints:!1}}},{key:"execute",value:function(){var t=this,e=this,n=e.nodes,r=e.nodeSize,i=e.rankdir,o=e.combos;if(n){var a,u=e.edges||[],s=new Q.a.graphlib.Graph({multigraph:!0,compound:!0});a=r?l(r)?function(){return r}:function(){return[r,r]}:function(t){return t.size?l(t.size)?t.size:p(t.size)?[t.size.width||40,t.size.height||40]:[t.size,t.size]:[40,40]};var c=J(e.nodesepFunc,e.nodesep,50),f=J(e.ranksepFunc,e.ranksep,50);"LR"!==i&&"RL"!==i||(c=J(e.ranksepFunc,e.ranksep,50),f=J(e.nodesepFunc,e.nodesep,50)),s.setDefaultEdgeLabel((function(){return{}})),s.setGraph(e);var d={};n.filter((function(t){return!1!==t.layout})).forEach((function(e){var n=a(e),r=f(e),i=c(e),o=n[0]+2*i,u=n[1]+2*r,l=e.layer;h(l)?s.setNode(e.id,{width:o,height:u,layer:l}):s.setNode(e.id,{width:o,height:u}),t.sortByCombo&&e.comboId&&(d[e.comboId]||(d[e.comboId]=!0,s.setNode(e.comboId,{})),s.setParent(e.id,e.comboId))})),this.sortByCombo&&o&&o.forEach((function(t){t.parentId&&(d[t.parentId]||(d[t.parentId]=!0,s.setNode(t.parentId,{})),s.setParent(t.id,t.parentId))})),u.forEach((function(e){var n=m(e,"source"),r=m(e,"target");t.layoutNode(n)&&t.layoutNode(r)&&s.setEdge(n,r,{weight:e.weight||1})}));var v,g=void 0;return e.preset&&(g=new Q.a.graphlib.Graph({multigraph:!0,compound:!0}),e.preset.nodes.forEach((function(t){null===g||void 0===g||g.setNode(t.id,t)}))),Q.a.layout(s,{prevGraph:g,edgeLabelSpace:e.edgeLabelSpace,keepNodeOrder:e.keepNodeOrder,nodeOrder:e.nodeOrder}),s.nodes().forEach((function(t){v=s.node(t);var e=n.findIndex((function(e){return e.id===t}));n[e]&&(n[e].x=v.x,n[e].y=v.y,n[e]._order=v._order)})),s.edges().forEach((function(t){v=s.edge(t);var n=u.findIndex((function(e){var n=m(e,"source"),r=m(e,"target");return n===t.v&&r===t.w}));e.edgeLabelSpace&&e.controlPoints&&"loop"!==u[n].type&&(u[n].controlPoints=v.points.slice(1,v.points.length-1))})),e.onLayoutEnd&&e.onLayoutEnd(),{nodes:n,edges:u}}}},{key:"getType",value:function(){return"dagre"}}]),n}(s);function J(t,e,n){return t||(h(e)?function(){return e}:function(){return n})}n(11);var $=n(144),tt=Object.prototype.toString;function et(t){return tt.call(t).endsWith("Array]")}var nt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!et(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,i=e.toIndex,o=void 0===i?t.length:i;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[r],u=r+1;u<o;u++)t[u]>a&&(a=t[u]);return a};var rt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!et(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,i=e.toIndex,o=void 0===i?t.length:i;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[r],u=r+1;u<o;u++)t[u]<a&&(a=t[u]);return a};function it(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!et(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==n.output){if(!et(n.output))throw new TypeError("output option must be an array if specified");e=n.output}else e=new Array(t.length);var r=rt(t),i=nt(t);if(r===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=n.min,a=void 0===o?n.autoMinMax?r:0:o,u=n.max,s=void 0===u?n.autoMinMax?i:1:u;if(a>=s)throw new RangeError("min option must be smaller than max option");for(var c=(s-a)/(i-r),f=0;f<t.length;f++)e[f]=(t[f]-r)*c+a;return e}var ot=" ".repeat(2),at=" ".repeat(4);function ut(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.maxRows,r=void 0===n?15:n,i=e.maxColumns,o=void 0===i?10:i,a=e.maxNumSize,u=void 0===a?8:a;return"".concat(t.constructor.name," {\n").concat(ot,"[\n").concat(at).concat(st(t,r,o,u),"\n").concat(ot,"]\n").concat(ot,"rows: ").concat(t.rows,"\n").concat(ot,"columns: ").concat(t.columns,"\n}")}function st(t,e,n,r){for(var i=t.rows,o=t.columns,a=Math.min(i,e),u=Math.min(o,n),s=[],c=0;c<a;c++){for(var f=[],l=0;l<u;l++)f.push(ct(t.get(c,l),r));s.push("".concat(f.join(" ")))}return u!==o&&(s[s.length-1]+=" ... ".concat(o-n," more columns")),a!==i&&s.push("... ".concat(i-e," more rows")),s.join("\n".concat(at))}function ct(t,e){var n=String(t);if(n.length<=e)return n.padEnd(e," ");var r=t.toPrecision(e-2);if(r.length<=e)return r;var i=t.toExponential(e-2),o=i.indexOf("e"),a=i.slice(o);return i.slice(0,e-a.length)+a}function ft(t,e,n){var r=n?t.rows:t.rows-1;if(e<0||e>r)throw new RangeError("Row index out of range")}function lt(t,e,n){var r=n?t.columns:t.columns-1;if(e<0||e>r)throw new RangeError("Column index out of range")}function ht(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function dt(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function pt(t,e){if("object"!==typeof e)throw new TypeError("unexpected type for row indices");if(e.some((function(e){return e<0||e>=t.rows})))throw new RangeError("row indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function mt(t,e){if("object"!==typeof e)throw new TypeError("unexpected type for column indices");if(e.some((function(e){return e<0||e>=t.columns})))throw new RangeError("column indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function vt(t,e,n,r,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(yt("startRow",e),yt("endRow",n),yt("startColumn",r),yt("endColumn",i),e>n||r>i||e<0||e>=t.rows||n<0||n>=t.rows||r<0||r>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function gt(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=[],r=0;r<t;r++)n.push(e);return n}function yt(t,e){if("number"!==typeof e)throw new TypeError("".concat(t," must be a number"))}function bt(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}function Et(t,e,n){for(var r=t.rows,i=t.columns,o=[],a=0;a<r;a++){for(var u=0,s=0,c=0,f=0;f<i;f++)u+=c=t.get(a,f)-n[a],s+=c*c;e?o.push((s-u*u/i)/(i-1)):o.push((s-u*u/i)/i)}return o}function _t(t,e,n){for(var r=t.rows,i=t.columns,o=[],a=0;a<i;a++){for(var u=0,s=0,c=0,f=0;f<r;f++)u+=c=t.get(f,a)-n[a],s+=c*c;e?o.push((s-u*u/r)/(r-1)):o.push((s-u*u/r)/r)}return o}function wt(t,e,n){for(var r=t.rows,i=t.columns,o=r*i,a=0,u=0,s=0,c=0;c<r;c++)for(var f=0;f<i;f++)a+=s=t.get(c,f)-n,u+=s*s;return e?(u-a*a/o)/(o-1):(u-a*a/o)/o}function xt(t,e){for(var n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e[n])}function Tt(t,e){for(var n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e[r])}function St(t,e){for(var n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e)}function At(t){for(var e=[],n=0;n<t.rows;n++){for(var r=0,i=0;i<t.columns;i++)r+=Math.pow(t.get(n,i),2)/(t.columns-1);e.push(Math.sqrt(r))}return e}function Ot(t,e){for(var n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e[n])}function Rt(t){for(var e=[],n=0;n<t.columns;n++){for(var r=0,i=0;i<t.rows;i++)r+=Math.pow(t.get(i,n),2)/(t.rows-1);e.push(Math.sqrt(r))}return e}function Ct(t,e){for(var n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e[r])}function Mt(t){for(var e=t.size-1,n=0,r=0;r<t.columns;r++)for(var i=0;i<t.rows;i++)n+=Math.pow(t.get(i,r),2)/e;return Math.sqrt(n)}function It(t,e){for(var n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e)}var Nt=function(){function t(){Object(r.a)(this,t)}return Object(u.a)(t,[{key:"size",get:function(){return this.rows*this.columns}},{key:"apply",value:function(t){if("function"!==typeof t)throw new TypeError("callback must be a function");for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.call(this,e,n);return this}},{key:"to1DArray",value:function(){for(var t=[],e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.push(this.get(e,n));return t}},{key:"to2DArray",value:function(){for(var t=[],e=0;e<this.rows;e++){t.push([]);for(var n=0;n<this.columns;n++)t[e].push(this.get(e,n))}return t}},{key:"toJSON",value:function(){return this.to2DArray()}},{key:"isRowVector",value:function(){return 1===this.rows}},{key:"isColumnVector",value:function(){return 1===this.columns}},{key:"isVector",value:function(){return 1===this.rows||1===this.columns}},{key:"isSquare",value:function(){return this.rows===this.columns}},{key:"isEmpty",value:function(){return 0===this.rows||0===this.columns}},{key:"isSymmetric",value:function(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}},{key:"isEchelonForm",value:function(){for(var t=0,e=0,n=-1,r=!0,i=!1;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);t++}return r}},{key:"isReducedEchelonForm",value:function(){for(var t=0,e=0,n=-1,r=!0,i=!1;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);for(var o=e+1;o<this.rows;o++)0!==this.get(t,o)&&(r=!1);t++}return r}},{key:"echelonForm",value:function(){for(var t=this.clone(),e=0,n=0;e<t.rows&&n<t.columns;){for(var r=e,i=e;i<t.rows;i++)t.get(i,n)>t.get(r,n)&&(r=i);if(0===t.get(r,n))n++;else{t.swapRows(e,r);for(var o=t.get(e,n),a=n;a<t.columns;a++)t.set(e,a,t.get(e,a)/o);for(var u=e+1;u<t.rows;u++){var s=t.get(u,n)/t.get(e,n);t.set(u,n,0);for(var c=n+1;c<t.columns;c++)t.set(u,c,t.get(u,c)-t.get(e,c)*s)}e++,n++}}return t}},{key:"reducedEchelonForm",value:function(){for(var t=this.echelonForm(),e=t.columns,n=t.rows,r=n-1;r>=0;)if(0===t.maxRow(r))r--;else{for(var i=0,o=!1;i<n&&!1===o;)1===t.get(r,i)?o=!0:i++;for(var a=0;a<r;a++)for(var u=t.get(a,i),s=i;s<e;s++){var c=t.get(a,s)-u*t.get(r,s);t.set(a,s,c)}r--}return t}},{key:"set",value:function(){throw new Error("set method is unimplemented")}},{key:"get",value:function(){throw new Error("get method is unimplemented")}},{key:"repeat",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!==typeof t)throw new TypeError("options must be an object");var e=t.rows,n=void 0===e?1:e,r=t.columns,i=void 0===r?1:r;if(!Number.isInteger(n)||n<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(i)||i<=0)throw new TypeError("columns must be a positive integer");for(var o=new Dt(this.rows*n,this.columns*i),a=0;a<n;a++)for(var u=0;u<i;u++)o.setSubMatrix(this,this.rows*a,this.columns*u);return o}},{key:"fill",value:function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,t);return this}},{key:"neg",value:function(){return this.mulS(-1)}},{key:"getRow",value:function(t){ft(this,t);for(var e=[],n=0;n<this.columns;n++)e.push(this.get(t,n));return e}},{key:"getRowVector",value:function(t){return Dt.rowVector(this.getRow(t))}},{key:"setRow",value:function(t,e){ft(this,t),e=ht(this,e);for(var n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}},{key:"swapRows",value:function(t,e){ft(this,t),ft(this,e);for(var n=0;n<this.columns;n++){var r=this.get(t,n);this.set(t,n,this.get(e,n)),this.set(e,n,r)}return this}},{key:"getColumn",value:function(t){lt(this,t);for(var e=[],n=0;n<this.rows;n++)e.push(this.get(n,t));return e}},{key:"getColumnVector",value:function(t){return Dt.columnVector(this.getColumn(t))}},{key:"setColumn",value:function(t,e){lt(this,t),e=dt(this,e);for(var n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}},{key:"swapColumns",value:function(t,e){lt(this,t),lt(this,e);for(var n=0;n<this.rows;n++){var r=this.get(n,t);this.set(n,t,this.get(n,e)),this.set(n,e,r)}return this}},{key:"addRowVector",value:function(t){t=ht(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}},{key:"subRowVector",value:function(t){t=ht(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}},{key:"mulRowVector",value:function(t){t=ht(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}},{key:"divRowVector",value:function(t){t=ht(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}},{key:"addColumnVector",value:function(t){t=dt(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}},{key:"subColumnVector",value:function(t){t=dt(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}},{key:"mulColumnVector",value:function(t){t=dt(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}},{key:"divColumnVector",value:function(t){t=dt(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}},{key:"mulRow",value:function(t,e){ft(this,t);for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}},{key:"mulColumn",value:function(t,e){lt(this,t);for(var n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}},{key:"max",value:function(){if(this.isEmpty())return NaN;for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}},{key:"maxIndex",value:function(){bt(this);for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}},{key:"min",value:function(){if(this.isEmpty())return NaN;for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}},{key:"minIndex",value:function(){bt(this);for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}},{key:"maxRow",value:function(t){if(ft(this,t),this.isEmpty())return NaN;for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}},{key:"maxRowIndex",value:function(t){ft(this,t),bt(this);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}},{key:"minRow",value:function(t){if(ft(this,t),this.isEmpty())return NaN;for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}},{key:"minRowIndex",value:function(t){ft(this,t),bt(this);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}},{key:"maxColumn",value:function(t){if(lt(this,t),this.isEmpty())return NaN;for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}},{key:"maxColumnIndex",value:function(t){lt(this,t),bt(this);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}},{key:"minColumn",value:function(t){if(lt(this,t),this.isEmpty())return NaN;for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}},{key:"minColumnIndex",value:function(t){lt(this,t),bt(this);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}},{key:"diag",value:function(){for(var t=Math.min(this.rows,this.columns),e=[],n=0;n<t;n++)e.push(this.get(n,n));return e}},{key:"norm",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"frobenius",e=0;if("max"===t)return this.max();if("frobenius"===t){for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)e+=this.get(n,r)*this.get(n,r);return Math.sqrt(e)}throw new RangeError("unknown norm type: ".concat(t))}},{key:"cumulativeSum",value:function(){for(var t=0,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}},{key:"dot",value:function(e){t.isMatrix(e)&&(e=e.to1DArray());var n=this.to1DArray();if(n.length!==e.length)throw new RangeError("vectors do not have the same size");for(var r=0,i=0;i<n.length;i++)r+=n[i]*e[i];return r}},{key:"mmul",value:function(t){t=Dt.checkMatrix(t);for(var e=this.rows,n=this.columns,r=t.columns,i=new Dt(e,r),o=new Float64Array(n),a=0;a<r;a++){for(var u=0;u<n;u++)o[u]=t.get(u,a);for(var s=0;s<e;s++){for(var c=0,f=0;f<n;f++)c+=this.get(s,f)*o[f];i.set(s,a,c)}}return i}},{key:"strassen2x2",value:function(t){t=Dt.checkMatrix(t);var e=new Dt(2,2),n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),o=t.get(0,1),a=this.get(1,0),u=t.get(1,0),s=this.get(1,1),c=t.get(1,1),f=(n+s)*(r+c),l=(a+s)*r,h=n*(o-c),d=s*(u-r),p=(n+i)*c,m=f+d-p+(i-s)*(u+c),v=h+p,g=l+d,y=f-l+h+(a-n)*(r+o);return e.set(0,0,m),e.set(0,1,v),e.set(1,0,g),e.set(1,1,y),e}},{key:"strassen3x3",value:function(t){t=Dt.checkMatrix(t);var e=new Dt(3,3),n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),o=this.get(1,0),a=this.get(1,1),u=this.get(1,2),s=this.get(2,0),c=this.get(2,1),f=this.get(2,2),l=t.get(0,0),h=t.get(0,1),d=t.get(0,2),p=t.get(1,0),m=t.get(1,1),v=t.get(1,2),g=t.get(2,0),y=t.get(2,1),b=t.get(2,2),E=(n-o)*(-h+m),_=(-n+o+a)*(l-h+m),w=(o+a)*(-l+h),x=n*l,T=(-n+s+c)*(l-d+v),S=(-n+s)*(d-v),A=(s+c)*(-l+d),O=(-i+c+f)*(m+g-y),R=(i-f)*(m-y),C=i*g,M=(c+f)*(-g+y),I=(-i+a+u)*(v+g-b),N=(i-u)*(v-b),k=(a+u)*(-g+b),P=x+C+r*p,j=(n+r+i-o-a-c-f)*m+_+w+x+O+C+M,D=x+T+A+(n+r+i-a-u-s-c)*v+C+I+k,L=E+a*(-l+h+p-m-v-g+b)+_+x+C+I+N,B=E+_+w+x+u*y,F=C+I+N+k+o*d,U=x+T+S+c*(-l+d+p-m-v-g+y)+O+R+C,G=O+R+C+M+s*h,V=x+T+S+A+f*b;return e.set(0,0,P),e.set(0,1,j),e.set(0,2,D),e.set(1,0,L),e.set(1,1,B),e.set(1,2,F),e.set(2,0,U),e.set(2,1,G),e.set(2,2,V),e}},{key:"mmulStrassen",value:function(e){e=Dt.checkMatrix(e);var n=this.clone(),r=n.rows,i=n.columns,o=e.rows,a=e.columns;function u(e,n,r){var i=e.rows,o=e.columns;if(i===n&&o===r)return e;var a=t.zeros(n,r);return a=a.setSubMatrix(e,0,0)}var s=Math.max(r,o),c=Math.max(i,a);return function e(n,r,i,o){if(i<=512||o<=512)return n.mmul(r);i%2===1&&o%2===1?(n=u(n,i+1,o+1),r=u(r,i+1,o+1)):i%2===1?(n=u(n,i+1,o),r=u(r,i+1,o)):o%2===1&&(n=u(n,i,o+1),r=u(r,i,o+1));var a=parseInt(n.rows/2,10),s=parseInt(n.columns/2,10),c=n.subMatrix(0,a-1,0,s-1),f=r.subMatrix(0,a-1,0,s-1),l=n.subMatrix(0,a-1,s,n.columns-1),h=r.subMatrix(0,a-1,s,r.columns-1),d=n.subMatrix(a,n.rows-1,0,s-1),p=r.subMatrix(a,r.rows-1,0,s-1),m=n.subMatrix(a,n.rows-1,s,n.columns-1),v=r.subMatrix(a,r.rows-1,s,r.columns-1),g=e(t.add(c,m),t.add(f,v),a,s),y=e(t.add(d,m),f,a,s),b=e(c,t.sub(h,v),a,s),E=e(m,t.sub(p,f),a,s),_=e(t.add(c,l),v,a,s),w=e(t.sub(d,c),t.add(f,h),a,s),x=e(t.sub(l,m),t.add(p,v),a,s),T=t.add(g,E);T.sub(_),T.add(x);var S=t.add(b,_),A=t.add(y,E),O=t.sub(g,y);O.add(b),O.add(w);var R=t.zeros(2*T.rows,2*T.columns);return(R=(R=(R=(R=R.setSubMatrix(T,0,0)).setSubMatrix(S,T.rows,0)).setSubMatrix(A,0,T.columns)).setSubMatrix(O,T.rows,T.columns)).subMatrix(0,i-1,0,o-1)}(n=u(n,s,c),e=u(e,s,c),s,c)}},{key:"scaleRows",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!==typeof t)throw new TypeError("options must be an object");var e=t.min,n=void 0===e?0:e,r=t.max,i=void 0===r?1:r;if(!Number.isFinite(n))throw new TypeError("min must be a number");if(!Number.isFinite(i))throw new TypeError("max must be a number");if(n>=i)throw new RangeError("min must be smaller than max");for(var o=new Dt(this.rows,this.columns),a=0;a<this.rows;a++){var u=this.getRow(a);u.length>0&&it(u,{min:n,max:i,output:u}),o.setRow(a,u)}return o}},{key:"scaleColumns",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!==typeof t)throw new TypeError("options must be an object");var e=t.min,n=void 0===e?0:e,r=t.max,i=void 0===r?1:r;if(!Number.isFinite(n))throw new TypeError("min must be a number");if(!Number.isFinite(i))throw new TypeError("max must be a number");if(n>=i)throw new RangeError("min must be smaller than max");for(var o=new Dt(this.rows,this.columns),a=0;a<this.columns;a++){var u=this.getColumn(a);u.length&&it(u,{min:n,max:i,output:u}),o.setColumn(a,u)}return o}},{key:"flipRows",value:function(){for(var t=Math.ceil(this.columns/2),e=0;e<this.rows;e++)for(var n=0;n<t;n++){var r=this.get(e,n),i=this.get(e,this.columns-1-n);this.set(e,n,i),this.set(e,this.columns-1-n,r)}return this}},{key:"flipColumns",value:function(){for(var t=Math.ceil(this.rows/2),e=0;e<this.columns;e++)for(var n=0;n<t;n++){var r=this.get(n,e),i=this.get(this.rows-1-n,e);this.set(n,e,i),this.set(this.rows-1-n,e,r)}return this}},{key:"kroneckerProduct",value:function(t){t=Dt.checkMatrix(t);for(var e=this.rows,n=this.columns,r=t.rows,i=t.columns,o=new Dt(e*r,n*i),a=0;a<e;a++)for(var u=0;u<n;u++)for(var s=0;s<r;s++)for(var c=0;c<i;c++)o.set(r*a+s,i*u+c,this.get(a,u)*t.get(s,c));return o}},{key:"kroneckerSum",value:function(t){if(t=Dt.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");var e=this.rows,n=t.rows,r=this.kroneckerProduct(Dt.eye(n,n)),i=Dt.eye(e,e).kroneckerProduct(t);return r.add(i)}},{key:"transpose",value:function(){for(var t=new Dt(this.columns,this.rows),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}},{key:"sortRows",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kt,e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}},{key:"sortColumns",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kt,e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}},{key:"subMatrix",value:function(t,e,n,r){vt(this,t,e,n,r);for(var i=new Dt(e-t+1,r-n+1),o=t;o<=e;o++)for(var a=n;a<=r;a++)i.set(o-t,a-n,this.get(o,a));return i}},{key:"subMatrixRow",value:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||e<0||e>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");for(var r=new Dt(t.length,n-e+1),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(t[i]<0||t[i]>=this.rows)throw new RangeError("Row index out of range: ".concat(t[i]));r.set(i,o-e,this.get(t[i],o))}return r}},{key:"subMatrixColumn",value:function(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||e<0||e>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");for(var r=new Dt(n-e+1,t.length),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(t[i]<0||t[i]>=this.columns)throw new RangeError("Column index out of range: ".concat(t[i]));r.set(o-e,i,this.get(o,t[i]))}return r}},{key:"setSubMatrix",value:function(t,e,n){if((t=Dt.checkMatrix(t)).isEmpty())return this;vt(this,e,e+t.rows-1,n,n+t.columns-1);for(var r=0;r<t.rows;r++)for(var i=0;i<t.columns;i++)this.set(e+r,n+i,t.get(r,i));return this}},{key:"selection",value:function(t,e){for(var n=function(t,e,n){return{row:pt(t,e),column:mt(t,n)}}(this,t,e),r=new Dt(t.length,e.length),i=0;i<n.row.length;i++)for(var o=n.row[i],a=0;a<n.column.length;a++){var u=n.column[a];r.set(i,a,this.get(o,u))}return r}},{key:"trace",value:function(){for(var t=Math.min(this.rows,this.columns),e=0,n=0;n<t;n++)e+=this.get(n,n);return e}},{key:"clone",value:function(){for(var t=new Dt(this.rows,this.columns),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(e,n,this.get(e,n));return t}},{key:"sum",value:function(t){switch(t){case"row":return function(t){for(var e=gt(t.rows),n=0;n<t.rows;++n)for(var r=0;r<t.columns;++r)e[n]+=t.get(n,r);return e}(this);case"column":return function(t){for(var e=gt(t.columns),n=0;n<t.rows;++n)for(var r=0;r<t.columns;++r)e[r]+=t.get(n,r);return e}(this);case void 0:return function(t){for(var e=0,n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)e+=t.get(n,r);return e}(this);default:throw new Error("invalid option: ".concat(t))}}},{key:"product",value:function(t){switch(t){case"row":return function(t){for(var e=gt(t.rows,1),n=0;n<t.rows;++n)for(var r=0;r<t.columns;++r)e[n]*=t.get(n,r);return e}(this);case"column":return function(t){for(var e=gt(t.columns,1),n=0;n<t.rows;++n)for(var r=0;r<t.columns;++r)e[r]*=t.get(n,r);return e}(this);case void 0:return function(t){for(var e=1,n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)e*=t.get(n,r);return e}(this);default:throw new Error("invalid option: ".concat(t))}}},{key:"mean",value:function(t){var e=this.sum(t);switch(t){case"row":for(var n=0;n<this.rows;n++)e[n]/=this.columns;return e;case"column":for(var r=0;r<this.columns;r++)e[r]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error("invalid option: ".concat(t))}}},{key:"variance",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===typeof t&&(e=t,t=void 0),"object"!==typeof e)throw new TypeError("options must be an object");var n=e,r=n.unbiased,i=void 0===r||r,o=n.mean,a=void 0===o?this.mean(t):o;if("boolean"!==typeof i)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!Array.isArray(a))throw new TypeError("mean must be an array");return Et(this,i,a);case"column":if(!Array.isArray(a))throw new TypeError("mean must be an array");return _t(this,i,a);case void 0:if("number"!==typeof a)throw new TypeError("mean must be a number");return wt(this,i,a);default:throw new Error("invalid option: ".concat(t))}}},{key:"standardDeviation",value:function(t,e){"object"===typeof t&&(e=t,t=void 0);var n=this.variance(t,e);if(void 0===t)return Math.sqrt(n);for(var r=0;r<n.length;r++)n[r]=Math.sqrt(n[r]);return n}},{key:"center",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===typeof t&&(e=t,t=void 0),"object"!==typeof e)throw new TypeError("options must be an object");var n=e,r=n.center,i=void 0===r?this.mean(t):r;switch(t){case"row":if(!Array.isArray(i))throw new TypeError("center must be an array");return xt(this,i),this;case"column":if(!Array.isArray(i))throw new TypeError("center must be an array");return Tt(this,i),this;case void 0:if("number"!==typeof i)throw new TypeError("center must be a number");return St(this,i),this;default:throw new Error("invalid option: ".concat(t))}}},{key:"scale",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===typeof t&&(e=t,t=void 0),"object"!==typeof e)throw new TypeError("options must be an object");var n=e.scale;switch(t){case"row":if(void 0===n)n=At(this);else if(!Array.isArray(n))throw new TypeError("scale must be an array");return Ot(this,n),this;case"column":if(void 0===n)n=Rt(this);else if(!Array.isArray(n))throw new TypeError("scale must be an array");return Ct(this,n),this;case void 0:if(void 0===n)n=Mt(this);else if("number"!==typeof n)throw new TypeError("scale must be a number");return It(this,n),this;default:throw new Error("invalid option: ".concat(t))}}},{key:"toString",value:function(t){return ut(this,t)}}],[{key:"from1DArray",value:function(t,e,n){if(t*e!==n.length)throw new RangeError("data length does not match given dimensions");for(var r=new Dt(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n[i*e+o]);return r}},{key:"rowVector",value:function(t){for(var e=new Dt(1,t.length),n=0;n<t.length;n++)e.set(0,n,t[n]);return e}},{key:"columnVector",value:function(t){for(var e=new Dt(t.length,1),n=0;n<t.length;n++)e.set(n,0,t[n]);return e}},{key:"zeros",value:function(t,e){return new Dt(t,e)}},{key:"ones",value:function(t,e){return new Dt(t,e).fill(1)}},{key:"rand",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("object"!==typeof n)throw new TypeError("options must be an object");for(var r=n.random,i=void 0===r?Math.random:r,o=new Dt(t,e),a=0;a<t;a++)for(var u=0;u<e;u++)o.set(a,u,i());return o}},{key:"randInt",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("object"!==typeof n)throw new TypeError("options must be an object");var r=n.min,i=void 0===r?0:r,o=n.max,a=void 0===o?1e3:o,u=n.random,s=void 0===u?Math.random:u;if(!Number.isInteger(i))throw new TypeError("min must be an integer");if(!Number.isInteger(a))throw new TypeError("max must be an integer");if(i>=a)throw new RangeError("min must be smaller than max");for(var c=a-i,f=new Dt(t,e),l=0;l<t;l++)for(var h=0;h<e;h++){var d=i+Math.round(s()*c);f.set(l,h,d)}return f}},{key:"eye",value:function(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);for(var r=Math.min(t,e),i=this.zeros(t,e),o=0;o<r;o++)i.set(o,o,n);return i}},{key:"diag",value:function(t,e,n){var r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);for(var i=Math.min(r,e,n),o=this.zeros(e,n),a=0;a<i;a++)o.set(a,a,t[a]);return o}},{key:"min",value:function(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new Dt(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,Math.min(t.get(o,a),e.get(o,a)));return i}},{key:"max",value:function(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,Math.max(t.get(o,a),e.get(o,a)));return i}},{key:"checkMatrix",value:function(e){return t.isMatrix(e)?e:new Dt(e)}},{key:"isMatrix",value:function(t){return null!=t&&"Matrix"===t.klass}}]),t}();function kt(t,e){return t-e}Nt.prototype.klass="Matrix","undefined"!==typeof Symbol&&(Nt.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return ut(this)}),Nt.random=Nt.rand,Nt.randomInt=Nt.randInt,Nt.diagonal=Nt.diag,Nt.prototype.diagonal=Nt.prototype.diag,Nt.identity=Nt.eye,Nt.prototype.negate=Nt.prototype.neg,Nt.prototype.tensorProduct=Nt.prototype.kroneckerProduct;var Pt,jt,Dt=function(t){Object(o.a)(n,t);var e=Object(a.a)(n);function n(t,i){var o;if(Object(r.a)(this,n),o=e.call(this),n.isMatrix(t))return Object($.a)(o,t.clone());if(Number.isInteger(t)&&t>=0){if(o.data=[],!(Number.isInteger(i)&&i>=0))throw new TypeError("nColumns must be a positive integer");for(var a=0;a<t;a++)o.data.push(new Float64Array(i))}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");var u=t;if("number"!==typeof(i=(t=u.length)?u[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");o.data=[];for(var s=0;s<t;s++){if(u[s].length!==i)throw new RangeError("Inconsistent array dimensions");o.data.push(Float64Array.from(u[s]))}}return o.rows=t,o.columns=i,o}return Object(u.a)(n,[{key:"set",value:function(t,e,n){return this.data[t][e]=n,this}},{key:"get",value:function(t,e){return this.data[t][e]}},{key:"removeRow",value:function(t){return ft(this,t),this.data.splice(t,1),this.rows-=1,this}},{key:"addRow",value:function(t,e){return void 0===e&&(e=t,t=this.rows),ft(this,t,!0),e=Float64Array.from(ht(this,e)),this.data.splice(t,0,e),this.rows+=1,this}},{key:"removeColumn",value:function(t){lt(this,t);for(var e=0;e<this.rows;e++){for(var n=new Float64Array(this.columns-1),r=0;r<t;r++)n[r]=this.data[e][r];for(var i=t+1;i<this.columns;i++)n[i-1]=this.data[e][i];this.data[e]=n}return this.columns-=1,this}},{key:"addColumn",value:function(t,e){"undefined"===typeof e&&(e=t,t=this.columns),lt(this,t,!0),e=dt(this,e);for(var n=0;n<this.rows;n++){for(var r=new Float64Array(this.columns+1),i=0;i<t;i++)r[i]=this.data[n][i];for(r[i++]=e[n];i<this.columns+1;i++)r[i]=this.data[n][i-1];this.data[n]=r}return this.columns+=1,this}}]),n}(Nt);jt=Dt,(Pt=Nt).prototype.add=function(t){return"number"===typeof t?this.addS(t):this.addM(t)},Pt.prototype.addS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t);return this},Pt.prototype.addM=function(t){if(t=jt.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t.get(e,n));return this},Pt.add=function(t,e){return new jt(t).add(e)},Pt.prototype.sub=function(t){return"number"===typeof t?this.subS(t):this.subM(t)},Pt.prototype.subS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t);return this},Pt.prototype.subM=function(t){if(t=jt.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t.get(e,n));return this},Pt.sub=function(t,e){return new jt(t).sub(e)},Pt.prototype.subtract=Pt.prototype.sub,Pt.prototype.subtractS=Pt.prototype.subS,Pt.prototype.subtractM=Pt.prototype.subM,Pt.subtract=Pt.sub,Pt.prototype.mul=function(t){return"number"===typeof t?this.mulS(t):this.mulM(t)},Pt.prototype.mulS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this},Pt.prototype.mulM=function(t){if(t=jt.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t.get(e,n));return this},Pt.mul=function(t,e){return new jt(t).mul(e)},Pt.prototype.multiply=Pt.prototype.mul,Pt.prototype.multiplyS=Pt.prototype.mulS,Pt.prototype.multiplyM=Pt.prototype.mulM,Pt.multiply=Pt.mul,Pt.prototype.div=function(t){return"number"===typeof t?this.divS(t):this.divM(t)},Pt.prototype.divS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t);return this},Pt.prototype.divM=function(t){if(t=jt.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t.get(e,n));return this},Pt.div=function(t,e){return new jt(t).div(e)},Pt.prototype.divide=Pt.prototype.div,Pt.prototype.divideS=Pt.prototype.divS,Pt.prototype.divideM=Pt.prototype.divM,Pt.divide=Pt.div,Pt.prototype.mod=function(t){return"number"===typeof t?this.modS(t):this.modM(t)},Pt.prototype.modS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t);return this},Pt.prototype.modM=function(t){if(t=jt.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t.get(e,n));return this},Pt.mod=function(t,e){return new jt(t).mod(e)},Pt.prototype.modulus=Pt.prototype.mod,Pt.prototype.modulusS=Pt.prototype.modS,Pt.prototype.modulusM=Pt.prototype.modM,Pt.modulus=Pt.mod,Pt.prototype.and=function(t){return"number"===typeof t?this.andS(t):this.andM(t)},Pt.prototype.andS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t);return this},Pt.prototype.andM=function(t){if(t=jt.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t.get(e,n));return this},Pt.and=function(t,e){return new jt(t).and(e)},Pt.prototype.or=function(t){return"number"===typeof t?this.orS(t):this.orM(t)},Pt.prototype.orS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t);return this},Pt.prototype.orM=function(t){if(t=jt.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t.get(e,n));return this},Pt.or=function(t,e){return new jt(t).or(e)},Pt.prototype.xor=function(t){return"number"===typeof t?this.xorS(t):this.xorM(t)},Pt.prototype.xorS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t);return this},Pt.prototype.xorM=function(t){if(t=jt.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t.get(e,n));return this},Pt.xor=function(t,e){return new jt(t).xor(e)},Pt.prototype.leftShift=function(t){return"number"===typeof t?this.leftShiftS(t):this.leftShiftM(t)},Pt.prototype.leftShiftS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t);return this},Pt.prototype.leftShiftM=function(t){if(t=jt.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t.get(e,n));return this},Pt.leftShift=function(t,e){return new jt(t).leftShift(e)},Pt.prototype.signPropagatingRightShift=function(t){return"number"===typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},Pt.prototype.signPropagatingRightShiftS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t);return this},Pt.prototype.signPropagatingRightShiftM=function(t){if(t=jt.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t.get(e,n));return this},Pt.signPropagatingRightShift=function(t,e){return new jt(t).signPropagatingRightShift(e)},Pt.prototype.rightShift=function(t){return"number"===typeof t?this.rightShiftS(t):this.rightShiftM(t)},Pt.prototype.rightShiftS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t);return this},Pt.prototype.rightShiftM=function(t){if(t=jt.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t.get(e,n));return this},Pt.rightShift=function(t,e){return new jt(t).rightShift(e)},Pt.prototype.zeroFillRightShift=Pt.prototype.rightShift,Pt.prototype.zeroFillRightShiftS=Pt.prototype.rightShiftS,Pt.prototype.zeroFillRightShiftM=Pt.prototype.rightShiftM,Pt.zeroFillRightShift=Pt.rightShift,Pt.prototype.not=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},Pt.not=function(t){return new jt(t).not()},Pt.prototype.abs=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},Pt.abs=function(t){return new jt(t).abs()},Pt.prototype.acos=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},Pt.acos=function(t){return new jt(t).acos()},Pt.prototype.acosh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},Pt.acosh=function(t){return new jt(t).acosh()},Pt.prototype.asin=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},Pt.asin=function(t){return new jt(t).asin()},Pt.prototype.asinh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},Pt.asinh=function(t){return new jt(t).asinh()},Pt.prototype.atan=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},Pt.atan=function(t){return new jt(t).atan()},Pt.prototype.atanh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},Pt.atanh=function(t){return new jt(t).atanh()},Pt.prototype.cbrt=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},Pt.cbrt=function(t){return new jt(t).cbrt()},Pt.prototype.ceil=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},Pt.ceil=function(t){return new jt(t).ceil()},Pt.prototype.clz32=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},Pt.clz32=function(t){return new jt(t).clz32()},Pt.prototype.cos=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},Pt.cos=function(t){return new jt(t).cos()},Pt.prototype.cosh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},Pt.cosh=function(t){return new jt(t).cosh()},Pt.prototype.exp=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},Pt.exp=function(t){return new jt(t).exp()},Pt.prototype.expm1=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},Pt.expm1=function(t){return new jt(t).expm1()},Pt.prototype.floor=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},Pt.floor=function(t){return new jt(t).floor()},Pt.prototype.fround=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},Pt.fround=function(t){return new jt(t).fround()},Pt.prototype.log=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},Pt.log=function(t){return new jt(t).log()},Pt.prototype.log1p=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},Pt.log1p=function(t){return new jt(t).log1p()},Pt.prototype.log10=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},Pt.log10=function(t){return new jt(t).log10()},Pt.prototype.log2=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},Pt.log2=function(t){return new jt(t).log2()},Pt.prototype.round=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},Pt.round=function(t){return new jt(t).round()},Pt.prototype.sign=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},Pt.sign=function(t){return new jt(t).sign()},Pt.prototype.sin=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},Pt.sin=function(t){return new jt(t).sin()},Pt.prototype.sinh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},Pt.sinh=function(t){return new jt(t).sinh()},Pt.prototype.sqrt=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},Pt.sqrt=function(t){return new jt(t).sqrt()},Pt.prototype.tan=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},Pt.tan=function(t){return new jt(t).tan()},Pt.prototype.tanh=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},Pt.tanh=function(t){return new jt(t).tanh()},Pt.prototype.trunc=function(){for(var t=0;t<this.rows;t++)for(var e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},Pt.trunc=function(t){return new jt(t).trunc()},Pt.pow=function(t,e){return new jt(t).pow(e)},Pt.prototype.pow=function(t){return"number"===typeof t?this.powS(t):this.powM(t)},Pt.prototype.powS=function(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,Math.pow(this.get(e,n),t));return this},Pt.prototype.powM=function(t){if(t=jt.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,Math.pow(this.get(e,n),t.get(e,n)));return this};n(49);var Lt=n(562),Bt=n.n(Lt),Ft=n(244),Ut=n.n(Ft),Gt=n(245),Vt=n.n(Gt),zt=n(563),Ht=n.n(zt),Wt=(n(564),n(534)),qt=n(558),Xt=n(530);function Yt(t){return"number"===typeof t}function Kt(t){return void 0===t?0:t>360||t<-360?t%360:t}function Qt(t,e,n){return Yt(t)?qt.e.fromValues(t,e,n):3===t.length?qt.e.clone(t):qt.e.fromValues(t[0],t[1],t[2])}var Zt,Jt,$t,te,ee,ne,re,ie,oe,ae,ue=function(){function t(e,n){Ut()(this,t),this.name=void 0,this.matrix=void 0,this.right=void 0,this.up=void 0,this.forward=void 0,this.position=void 0,this.focalPoint=void 0,this.distanceVector=void 0,this.distance=void 0,this.dollyingStep=void 0,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.name=e,this.matrix=qt.b.clone(n.matrix),this.right=qt.e.clone(n.right),this.up=qt.e.clone(n.up),this.forward=qt.e.clone(n.forward),this.position=qt.e.clone(n.position),this.focalPoint=qt.e.clone(n.focalPoint),this.distanceVector=qt.e.clone(n.distanceVector),this.azimuth=n.azimuth,this.elevation=n.elevation,this.roll=n.roll,this.relAzimuth=n.relAzimuth,this.relElevation=n.relElevation,this.relRoll=n.relRoll,this.dollyingStep=n.dollyingStep,this.distance=n.distance}return Vt()(t,[{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getRoll",value:function(){return this.roll}},{key:"retrieve",value:function(t){t.matrix=qt.b.copy(t.matrix,this.matrix),t.right=qt.e.copy(t.right,this.right),t.up=qt.e.copy(t.up,this.up),t.forward=qt.e.copy(t.forward,this.forward),t.position=qt.e.copy(t.position,this.position),t.focalPoint=qt.e.copy(t.focalPoint,this.focalPoint),t.distanceVector=qt.e.copy(t.distanceVector,this.distanceVector),t.azimuth=this.azimuth,t.elevation=this.elevation,t.roll=this.roll,t.relAzimuth=this.relAzimuth,t.relElevation=this.relElevation,t.relRoll=this.relRoll,t.dollyingStep=this.dollyingStep,t.distance=this.distance}}]),t}();!function(t){t.ORBITING="ORBITING",t.EXPLORING="EXPLORING",t.TRACKING="TRACKING"}(ie||(ie={})),function(t){t.DEFAULT="DEFAULT",t.ROTATIONAL="ROTATIONAL",t.TRANSLATIONAL="TRANSLATIONAL",t.CINEMATIC="CINEMATIC"}(oe||(oe={})),function(t){t.ORTHOGRAPHIC="ORTHOGRAPHIC",t.PERSPECTIVE="PERSPECTIVE"}(ae||(ae={}));var se,ce,fe,le,he,de,pe,me=Math.PI/180,ve=180/Math.PI,ge=(Zt=Object(Xt.injectable)(),Jt=Object(Xt.inject)(Wt.IDENTIFIER.InteractorService),Zt((re=ne=function(){function t(){Ut()(this,t),this.matrix=qt.b.create(),this.right=qt.e.fromValues(1,0,0),this.up=qt.e.fromValues(0,1,0),this.forward=qt.e.fromValues(0,0,1),this.position=qt.e.fromValues(0,0,1),this.focalPoint=qt.e.fromValues(0,0,0),this.distanceVector=qt.e.fromValues(0,0,0),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.rotateWorld=!1,Bt()(this,"interactor",ee,this),this.fov=30,this.near=.1,this.far=1e4,this.aspect=1,this.left=void 0,this.rright=void 0,this.top=void 0,this.bottom=void 0,this.zoom=1,this.perspective=qt.b.create(),this.view=void 0,this.following=void 0,this.type=ie.EXPLORING,this.trackingMode=oe.DEFAULT,this.projectionMode=ae.PERSPECTIVE,this.frustum=new Wt.Frustum,this.landmarks=[],this.landmarkAnimationID=void 0}return Vt()(t,[{key:"clone",value:function(){var e=new t;return e.setType(this.type,void 0),e.interactor=this.interactor,e}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.perspective}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"setType",value:function(t,e){return this.type=t,this.type===ie.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===ie.TRACKING&&void 0!==e&&this.setTrackingMode(e),this}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this}},{key:"setTrackingMode",value:function(t){if(this.type!==ie.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this}},{key:"setWorldRotation",value:function(t){this.rotateWorld=t,this._getAngles()}},{key:"getViewTransform",value:function(){return qt.b.invert(qt.b.create(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this}},{key:"setViewOffset",value:function(t,e,n,r,i,o){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.projectionMode===ae.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===ae.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setPerspective",value:function(t,e,n,r){return this.projectionMode=ae.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=r,qt.b.perspective(this.perspective,this.fov*me,this.aspect,this.near,this.far),this}},{key:"setOrthographic",value:function(t,e,n,r,i,o){this.projectionMode=ae.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=r,this.near=i,this.far=o;var a=(this.rright-this.left)/(2*this.zoom),u=(this.top-this.bottom)/(2*this.zoom),s=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,f=s-a,l=s+a,h=c+u,d=c-u;if(void 0!==this.view&&this.view.enabled){var p=(this.rright-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l=(f+=p*this.view.offsetX)+p*this.view.width,d=(h-=m*this.view.offsetY)-m*this.view.height}return qt.b.ortho(this.perspective,f,l,h,d,i,o),this}},{key:"setPosition",value:function(t,e,n){return this._setPosition(t,e,n),this.setFocalPoint(this.focalPoint),this}},{key:"setFocalPoint",value:function(t,e,n){var r=qt.e.fromValues(0,1,0);if(this.focalPoint=Qt(t,e,n),this.trackingMode===oe.CINEMATIC){var i=qt.e.subtract(qt.e.create(),this.focalPoint,this.position);t=i[0],e=i[1],n=i[2];var o=qt.e.length(i),a=Math.asin(e/o)*ve,u=90+Math.atan2(n,t)*ve,s=qt.b.create();qt.b.rotateY(s,s,u*me),qt.b.rotateX(s,s,a*me),r=qt.e.transformMat4(qt.e.create(),[0,1,0],s)}return qt.b.invert(this.matrix,qt.b.lookAt(qt.b.create(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this}},{key:"setDistance",value:function(t){if(!(this.distance===t||t<0)){this.distance=t,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var e=qt.e.create();t=this.distance;var n=this.forward,r=this.focalPoint;return e[0]=t*n[0]+r[0],e[1]=t*n[1]+r[1],e[2]=t*n[2]+r[2],this._setPosition(e),this}}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this}},{key:"changeAzimuth",value:function(t){return this.setAzimuth(this.azimuth+t),this}},{key:"changeElevation",value:function(t){return this.setElevation(this.elevation+t),this}},{key:"changeRoll",value:function(t){return this.setRoll(this.roll+t),this}},{key:"setAzimuth",value:function(t){return this.azimuth=Kt(t),this.computeMatrix(),this._getAxes(),this.type===ie.ORBITING||this.type===ie.EXPLORING?this._getPosition():this.type===ie.TRACKING&&this._getFocalPoint(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(t){return this.elevation=Kt(t),this.computeMatrix(),this._getAxes(),this.type===ie.ORBITING||this.type===ie.EXPLORING?this._getPosition():this.type===ie.TRACKING&&this._getFocalPoint(),this}},{key:"setRoll",value:function(t){return this.roll=Kt(t),this.computeMatrix(),this._getAxes(),this.type===ie.ORBITING||this.type===ie.EXPLORING?this._getPosition():this.type===ie.TRACKING&&this._getFocalPoint(),this}},{key:"rotate",value:function(t,e,n){if(this.type===ie.EXPLORING){t=Kt(t),e=Kt(e),n=Kt(n);var r=qt.c.setAxisAngle(qt.c.create(),[1,0,0],(this.rotateWorld?1:-1)*e*me),i=qt.c.setAxisAngle(qt.c.create(),[0,1,0],(this.rotateWorld?1:-1)*t*me),o=qt.c.setAxisAngle(qt.c.create(),[0,0,1],n*me),a=qt.c.multiply(qt.c.create(),i,r);a=qt.c.multiply(qt.c.create(),a,o);var u=qt.b.fromQuat(qt.b.create(),a);qt.b.translate(this.matrix,this.matrix,[0,0,-this.distance]),qt.b.multiply(this.matrix,this.matrix,u),qt.b.translate(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation+e)>90)return;this.relElevation=Kt(e),this.relAzimuth=Kt(t),this.relRoll=Kt(n),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.computeMatrix()}return this._getAxes(),this.type===ie.ORBITING||this.type===ie.EXPLORING?this._getPosition():this.type===ie.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(t,e){var n=Qt(t,e,0),r=qt.e.clone(this.position);return qt.e.add(r,r,qt.e.scale(qt.e.create(),this.right,n[0])),qt.e.add(r,r,qt.e.scale(qt.e.create(),this.up,n[1])),this._setPosition(r),this}},{key:"dolly",value:function(t){var e=this.forward,n=qt.e.clone(this.position),r=this.dollyingStep,i=this.distance+t*this.dollyingStep;return r=Math.max(Math.min(i,this.maxDistance),this.minDistance)-this.distance,n[0]+=r*e[0],n[1]+=r*e[1],n[2]+=r*e[2],this._setPosition(n),this.type===ie.ORBITING||this.type===ie.EXPLORING?this._getDistance():this.type===ie.TRACKING&&qt.e.add(this.focalPoint,n,this.distanceVector),this}},{key:"createLandmark",value:function(t,e){var n=this.clone();n.setPosition(e.position),n.setFocalPoint(e.focalPoint),void 0!==e.roll&&n.setRoll(e.roll);var r=new ue(t,n);return this.landmarks.push(r),r}},{key:"setLandmark",value:function(t){var e=new ue(t,this);return this.landmarks.push(e),this}},{key:"gotoLandmark",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,r=this.landmarks.find((function(e){return e.name===t}));if(r){if(0===n)return void r.retrieve(this);void 0!==this.landmarkAnimationID&&window.cancelAnimationFrame(this.landmarkAnimationID),this.interactor.disconnect();var i,o=r.getPosition(),a=r.getFocalPoint(),u=r.getRoll(),s=function t(r){void 0===i&&(i=r);var s,c=r-i,f=(1-Math.cos(c/n*Math.PI))/2,l=qt.e.create(),h=qt.e.create();if(qt.e.lerp(l,e.focalPoint,a,f),qt.e.lerp(h,e.position,o,f),s=e.roll*(1-f)+u*f,e.setFocalPoint(l),e.setPosition(h),e.setRoll(s),e.computeMatrix(),!(qt.e.dist(l,a)+qt.e.dist(h,o)>.01))return e.setFocalPoint(l),e.setPosition(h),e.setRoll(s),e.computeMatrix(),void e.interactor.connect();c<n&&(e.landmarkAnimationID=window.requestAnimationFrame(t))};window.requestAnimationFrame(s)}}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles()}},{key:"computeMatrix",value:function(){var t,e,n=qt.c.setAxisAngle(qt.c.create(),[0,0,1],this.roll*me);qt.b.identity(this.matrix),t=qt.c.setAxisAngle(qt.c.create(),[1,0,0],(this.rotateWorld&&this.type!==ie.TRACKING||this.type===ie.TRACKING?1:-1)*this.elevation*me),e=qt.c.setAxisAngle(qt.c.create(),[0,1,0],(this.rotateWorld&&this.type!==ie.TRACKING||this.type===ie.TRACKING?1:-1)*this.azimuth*me);var r=qt.c.multiply(qt.c.create(),e,t);r=qt.c.multiply(qt.c.create(),r,n);var i=qt.b.fromQuat(qt.b.create(),r);this.type===ie.ORBITING||this.type===ie.EXPLORING?(qt.b.translate(this.matrix,this.matrix,this.focalPoint),qt.b.multiply(this.matrix,this.matrix,i),qt.b.translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===ie.TRACKING&&(qt.b.translate(this.matrix,this.matrix,this.position),qt.b.multiply(this.matrix,this.matrix,i))}},{key:"_setPosition",value:function(t,e,n){this.position=Qt(t,e,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1}},{key:"_getAxes",value:function(){qt.e.copy(this.right,Qt(qt.f.transformMat4(qt.f.create(),[1,0,0,0],this.matrix))),qt.e.copy(this.up,Qt(qt.f.transformMat4(qt.f.create(),[0,1,0,0],this.matrix))),qt.e.copy(this.forward,Qt(qt.f.transformMat4(qt.f.create(),[0,0,1,0],this.matrix))),qt.e.normalize(this.right,this.right),qt.e.normalize(this.up,this.up),qt.e.normalize(this.forward,this.forward)}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],r=qt.e.length(this.distanceVector);if(0===r)return this.elevation=0,void(this.azimuth=0);this.type===ie.TRACKING||this.rotateWorld?(this.elevation=Math.asin(e/r)*ve,this.azimuth=Math.atan2(-t,-n)*ve):(this.elevation=-Math.asin(e/r)*ve,this.azimuth=-Math.atan2(-t,-n)*ve)}},{key:"_getPosition",value:function(){qt.e.copy(this.position,Qt(qt.f.transformMat4(qt.f.create(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){qt.e.transformMat3(this.distanceVector,[0,0,-this.distance],qt.a.fromMat4(qt.a.create(),this.matrix)),qt.e.add(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=qt.e.subtract(qt.e.create(),this.focalPoint,this.position),this.distance=qt.e.length(this.distanceVector),this.dollyingStep=this.distance/100}}]),t}(),ne.ProjectionMode={ORTHOGRAPHIC:"ORTHOGRAPHIC",PERSPECTIVE:"PERSPECTIVE"},te=re,ee=Ht()(te.prototype,"interactor",[Jt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$t=te))||$t),ye=(se=Object(Xt.injectable)(),ce=Object(Xt.inject)(Wt.IDENTIFIER.GeometryComponentManager),se((pe=de=function(){function t(){Ut()(this,t),this.config=void 0,Bt()(this,"geometry",he,this),this.entity=void 0,this.component=void 0}return Vt()(t,[{key:"getEntity",value:function(){return this.entity}},{key:"getComponent",value:function(){return this.component}},{key:"setConfig",value:function(t){this.config=t}},{key:"setEntity",value:function(t){this.entity=t,this.component=this.geometry.create(t),this.component.entity=t,this.onEntityCreated()}},{key:"onEntityCreated",value:function(){}}]),t}(),de.BOX="box",de.SPHERE="sphere",de.PLANE="plane",de.MERGED="merged",le=pe,he=Ht()(le.prototype,"geometry",[ce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fe=le))||fe),be=n(587),Ee=n.n(be),_e=n(588),we=n.n(_e),xe=n(250),Te=n.n(xe),Se=n(725);function Ae(){if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}var Oe={}.toString,Re=function(t,e){return Oe.call(t)==="[object "+e+"]"},Ce=n(252),Me=n.n(Ce),Ie=9007199254740991,Ne={};Ne["[object Float32Array]"]=Ne["[object Float64Array]"]=Ne["[object Int8Array]"]=Ne["[object Int16Array]"]=Ne["[object Int32Array]"]=Ne["[object Uint8Array]"]=Ne["[object Uint8ClampedArray]"]=Ne["[object Uint16Array]"]=Ne["[object Uint32Array]"]=!0,Ne["[object Arguments]"]=Ne["[object Array]"]=Ne["[object ArrayBuffer]"]=Ne["[object Boolean]"]=Ne["[object DataView]"]=Ne["[object Date]"]=Ne["[object Error]"]=Ne["[object Function]"]=Ne["[object Map]"]=Ne["[object Number]"]=Ne["[object Object]"]=Ne["[object RegExp]"]=Ne["[object Set]"]=Ne["[object String]"]=Ne["[object WeakMap]"]=!1;var ke=Object.prototype.toString;var Pe,je,De,Le,Be,Fe,Ue,Ge,Ve=function(t){return function(t){return!!t&&"object"===Me()(t)}(t)&&function(t){return"number"===typeof t&&t>-1&&t%1===0&&t<=Ie}(t.length)&&!!Ne[ke.call(t)]};function ze(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function He(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ze(Object(n),!0).forEach((function(e){Te()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var We,qe,Xe,Ye,Ke,Qe,Ze,Je,$e,tn,en,nn,rn,on,an,un,sn,cn,fn,ln,hn,dn,pn,mn,vn,gn,yn,bn,En,_n,wn,xn,Tn,Sn,An,On=(Pe=Object(Xt.injectable)(),je=Object(Xt.inject)(Wt.IDENTIFIER.RenderEngine),De=Object(Xt.inject)(Wt.IDENTIFIER.ConfigService),Pe((Ge=function(){function t(){Ut()(this,t),Bt()(this,"engine",Fe,this),Bt()(this,"configService",Ue,this),this.entity=Object(Wt.createEntity)(),this.model=void 0,this.dirty=!0,this.compiledBundle=void 0,this.initPromise=void 0}return Vt()(t,[{key:"init",value:function(){var t=this.configService.get(),e=t.canvas,n=t.engineOptions;this.initPromise=this.engine.init(He({canvas:e||Ae(),swapChainFormat:Se.TextureFormat.BGRA8Unorm,antialiasing:!1},n))}},{key:"setBundle",value:function(t){this.compiledBundle=JSON.parse(JSON.stringify(t))}},{key:"setDispatch",value:function(t){return this.compiledBundle.context&&(this.compiledBundle.context.dispatch=t),this}},{key:"setMaxIteration",value:function(t){return this.compiledBundle.context&&(this.compiledBundle.context.maxIteration=t),this}},{key:"setBinding",value:function(t,e){var n,r=this;if("string"===typeof t){var i=Yt(e)||Ve(e)||(n=e,Array.isArray?Array.isArray(n):Re(n,"Array"));if(this.compiledBundle&&this.compiledBundle.context){var o=this.compiledBundle.context.defines.find((function(e){return e.name===t}));if(o)return o.value=e,this;var a=this.compiledBundle.context.uniforms.find((function(e){return e.name===t}));a&&(i?(a.data=e,a.isReferer=!1,a.storageClass===Wt.STORAGE_CLASS.Uniform?this.model&&this.model.updateUniform(t,e):this.model&&this.model.updateBuffer(t,e)):(a.isReferer=!0,a.data=e))}}else Object.keys(t).forEach((function(e){r.setBinding(e,t[e])}));return this}},{key:"execute",value:function(){var t=we()(Ee.a.mark((function t(){var e,n,r=this,i=arguments;return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=i.length>0&&void 0!==i[0]?i[0]:1,!this.dirty){t.next=6;break}return this.compiledBundle.context&&(e>1?this.compiledBundle.context.maxIteration=e:this.compiledBundle.context.maxIteration++),t.next=5,this.compile();case 5:this.dirty=!1;case 6:for(this.engine.beginFrame(),this.engine.clear({}),this.compiledBundle.context&&this.compiledBundle.context.uniforms.filter((function(t){return t.isReferer})).forEach((function(t){var e=t.data,n=t.name;r.model.confirmInput(e.model,n)})),n=0;n<e;n++)this.model.run();return this.engine.endFrame(),t.abrupt("return",this);case 12:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getOutput",value:function(){var t=we()(Ee.a.mark((function t(){return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.model.readData());case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"compile",value:function(){var t=we()(Ee.a.mark((function t(){var e,n,r;return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.initPromise;case 2:return e=He({},this.compiledBundle.context),n=this.engine.supportWebGPU?this.engine.useWGSL?Wt.Target.WGSL:Wt.Target.GLSL450:Wt.Target.GLSL100,r=this.compiledBundle.shaders[n],e.defines.filter((function(t){return t.runtime})).forEach((function(t){var e="".concat(Wt.DefineValuePlaceholder).concat(t.name);r=r.replace(e,"".concat(t.value))})),e.shader=r,e.uniforms.forEach((function(t){if(!t.data&&t.storageClass===Wt.STORAGE_CLASS.StorageBuffer){var n=1;t.type===Wt.AST_TOKEN_TYPES.FloatArray?n=1:t.type===Wt.AST_TOKEN_TYPES.Vector4FloatArray&&(n=4),t.data=new Float32Array(e.output.length*n).fill(0)}})),this.compiledBundle.context=e,t.next=11,this.engine.createComputeModel(this.compiledBundle.context);case 11:this.model=t.sent;case 12:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}(),Be=Ge,Fe=Ht()(Be.prototype,"engine",[je],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ue=Ht()(Be.prototype,"configService",[De],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Le=Be))||Le),Rn=(We=Object(Xt.injectable)(),qe=Object(Xt.inject)(Wt.IDENTIFIER.MaterialComponentManager),We((Ze=Qe=function(){function t(){Ut()(this,t),this.config=void 0,Bt()(this,"material",Ke,this),this.entity=void 0,this.component=void 0}return Vt()(t,[{key:"getEntity",value:function(){return this.entity}},{key:"getComponent",value:function(){return this.component}},{key:"setConfig",value:function(t){this.config=t}},{key:"setEntity",value:function(t,e){this.entity=t,this.component=this.material.create(t),this.component.entity=t,this.component.type=e,this.onEntityCreated()}},{key:"onEntityCreated",value:function(){}}]),t}(),Qe.BASIC="basic",Ye=Ze,Ke=Ht()(Ye.prototype,"material",[qe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xe=Ye))||Xe),Cn=(Je=Object(Xt.injectable)(),$e=Object(Xt.inject)(Wt.IDENTIFIER.MeshComponentManager),tn=Object(Xt.inject)(Wt.IDENTIFIER.CullableComponentManager),en=Object(Xt.inject)(Wt.IDENTIFIER.TransformComponentManager),nn=Object(Xt.inject)(Wt.IDENTIFIER.Systems),rn=Object(Xt.named)(Wt.IDENTIFIER.SceneGraphSystem),Je((hn=ln=function(){function t(){Ut()(this,t),this.attributes={},this.config=void 0,Bt()(this,"mesh",un,this),Bt()(this,"cullable",sn,this),Bt()(this,"transform",cn,this),Bt()(this,"sceneGraphSystem",fn,this),this.meshComponent=void 0,this.transformComponent=void 0,this.entity=void 0}return Vt()(t,[{key:"getEntity",value:function(){return this.entity}},{key:"getTransformComponent",value:function(){return this.transformComponent}},{key:"getMeshComponent",value:function(){return this.meshComponent}},{key:"setConfig",value:function(t){this.config=t}},{key:"setEntity",value:function(t){this.entity=t,this.cullable.create(t),this.meshComponent=this.mesh.create(t),this.transformComponent=this.transform.create(t),this.onEntityCreated()}},{key:"setMaterial",value:function(t){return this.meshComponent.material=t,this}},{key:"setGeometry",value:function(t){return this.meshComponent.geometry=t,this}},{key:"setAttributes",value:function(t){var e=this;Object.keys(t).forEach((function(n){void 0!==t[n]&&t[n]!==e.attributes[n]&&(e.onAttributeChanged({name:n,data:t[n]}),e.attributes[n]=t[n])}))}},{key:"setVisible",value:function(t){var e=this;return this.meshComponent.visible=t,this.meshComponent.children.forEach((function(n){var r=e.mesh.getComponentByEntity(n);r&&(r.visible=t)})),this}},{key:"isVisible",value:function(){return this.meshComponent.visible}},{key:"attach",value:function(t){return this.sceneGraphSystem.attach(this.entity,t.entity),this}},{key:"detach",value:function(){return this.sceneGraphSystem.detach(this.entity),this}},{key:"detachChildren",value:function(){return this.sceneGraphSystem.detachChildren(this.entity),this}},{key:"onEntityCreated",value:function(){}},{key:"onAttributeChanged",value:function(t){var e=t.name,n=t.data;this.meshComponent&&this.meshComponent.material&&this.meshComponent.material.setUniform(this.convertAttributeName2UniformName(e),n)}},{key:"convertAttributeName2UniformName",value:function(t){return t}}]),t}(),ln.POINT="point",ln.LINE="line",ln.GRID="grid",an=hn,un=Ht()(an.prototype,"mesh",[$e],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sn=Ht()(an.prototype,"cullable",[tn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cn=Ht()(an.prototype,"transform",[en],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fn=Ht()(an.prototype,"sceneGraphSystem",[nn,rn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),on=an))||on),Mn=n(2676),In=n.n(Mn),Nn=function(){function t(e,n){Ut()(this,t),this.attribute=void 0,this.buffer=void 0;var r=n.buffer,i=n.offset,o=n.stride,a=n.normalized,u=n.size,s=n.divisor;this.buffer=r,this.attribute={buffer:r.get(),offset:i||0,stride:o||0,normalized:a||!1,divisor:s||0},u&&(this.attribute.size=u)}return Vt()(t,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),t}(),kn=(dn={},Te()(dn,Wt.gl.POINTS,"points"),Te()(dn,Wt.gl.LINES,"lines"),Te()(dn,Wt.gl.LINE_LOOP,"line loop"),Te()(dn,Wt.gl.LINE_STRIP,"line strip"),Te()(dn,Wt.gl.TRIANGLES,"triangles"),Te()(dn,Wt.gl.TRIANGLE_FAN,"triangle fan"),Te()(dn,Wt.gl.TRIANGLE_STRIP,"triangle strip"),dn),Pn=(pn={},Te()(pn,Wt.gl.STATIC_DRAW,"static"),Te()(pn,Wt.gl.DYNAMIC_DRAW,"dynamic"),Te()(pn,Wt.gl.STREAM_DRAW,"stream"),pn),jn=(mn={},Te()(mn,Wt.gl.BYTE,"int8"),Te()(mn,Wt.gl.UNSIGNED_INT,"int16"),Te()(mn,Wt.gl.INT,"int32"),Te()(mn,Wt.gl.UNSIGNED_BYTE,"uint8"),Te()(mn,Wt.gl.UNSIGNED_SHORT,"uint16"),Te()(mn,Wt.gl.UNSIGNED_INT,"uint32"),Te()(mn,Wt.gl.FLOAT,"float"),mn),Dn=(vn={},Te()(vn,Wt.gl.ALPHA,"alpha"),Te()(vn,Wt.gl.LUMINANCE,"luminance"),Te()(vn,Wt.gl.LUMINANCE_ALPHA,"luminance alpha"),Te()(vn,Wt.gl.RGB,"rgb"),Te()(vn,Wt.gl.RGBA,"rgba"),Te()(vn,Wt.gl.RGBA4,"rgba4"),Te()(vn,Wt.gl.RGB5_A1,"rgb5 a1"),Te()(vn,Wt.gl.RGB565,"rgb565"),Te()(vn,Wt.gl.DEPTH_COMPONENT,"depth"),Te()(vn,Wt.gl.DEPTH_STENCIL,"depth stencil"),vn),Ln=(gn={},Te()(gn,Wt.gl.DONT_CARE,"dont care"),Te()(gn,Wt.gl.NICEST,"nice"),Te()(gn,Wt.gl.FASTEST,"fast"),gn),Bn=(yn={},Te()(yn,Wt.gl.NEAREST,"nearest"),Te()(yn,Wt.gl.LINEAR,"linear"),Te()(yn,Wt.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),Te()(yn,Wt.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),Te()(yn,Wt.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),Te()(yn,Wt.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),yn),Fn=(bn={},Te()(bn,Wt.gl.REPEAT,"repeat"),Te()(bn,Wt.gl.CLAMP_TO_EDGE,"clamp"),Te()(bn,Wt.gl.MIRRORED_REPEAT,"mirror"),bn),Un=(En={},Te()(En,Wt.gl.NONE,"none"),Te()(En,Wt.gl.BROWSER_DEFAULT_WEBGL,"browser"),En),Gn=(_n={},Te()(_n,Wt.gl.NEVER,"never"),Te()(_n,Wt.gl.ALWAYS,"always"),Te()(_n,Wt.gl.LESS,"less"),Te()(_n,Wt.gl.LEQUAL,"lequal"),Te()(_n,Wt.gl.GREATER,"greater"),Te()(_n,Wt.gl.GEQUAL,"gequal"),Te()(_n,Wt.gl.EQUAL,"equal"),Te()(_n,Wt.gl.NOTEQUAL,"notequal"),_n),Vn=(wn={},Te()(wn,Wt.gl.FUNC_ADD,"add"),Te()(wn,Wt.gl.MIN_EXT,"min"),Te()(wn,Wt.gl.MAX_EXT,"max"),Te()(wn,Wt.gl.FUNC_SUBTRACT,"subtract"),Te()(wn,Wt.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),wn),zn=(xn={},Te()(xn,Wt.gl.ZERO,"zero"),Te()(xn,Wt.gl.ONE,"one"),Te()(xn,Wt.gl.SRC_COLOR,"src color"),Te()(xn,Wt.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),Te()(xn,Wt.gl.SRC_ALPHA,"src alpha"),Te()(xn,Wt.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),Te()(xn,Wt.gl.DST_COLOR,"dst color"),Te()(xn,Wt.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),Te()(xn,Wt.gl.DST_ALPHA,"dst alpha"),Te()(xn,Wt.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),Te()(xn,Wt.gl.CONSTANT_COLOR,"constant color"),Te()(xn,Wt.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),Te()(xn,Wt.gl.CONSTANT_ALPHA,"constant alpha"),Te()(xn,Wt.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),Te()(xn,Wt.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),xn),Hn=(Tn={},Te()(Tn,Wt.gl.NEVER,"never"),Te()(Tn,Wt.gl.ALWAYS,"always"),Te()(Tn,Wt.gl.LESS,"less"),Te()(Tn,Wt.gl.LEQUAL,"lequal"),Te()(Tn,Wt.gl.GREATER,"greater"),Te()(Tn,Wt.gl.GEQUAL,"gequal"),Te()(Tn,Wt.gl.EQUAL,"equal"),Te()(Tn,Wt.gl.NOTEQUAL,"notequal"),Tn),Wn=(Sn={},Te()(Sn,Wt.gl.ZERO,"zero"),Te()(Sn,Wt.gl.KEEP,"keep"),Te()(Sn,Wt.gl.REPLACE,"replace"),Te()(Sn,Wt.gl.INVERT,"invert"),Te()(Sn,Wt.gl.INCR,"increment"),Te()(Sn,Wt.gl.DECR,"decrement"),Te()(Sn,Wt.gl.INCR_WRAP,"increment wrap"),Te()(Sn,Wt.gl.DECR_WRAP,"decrement wrap"),Sn),qn=(An={},Te()(An,Wt.gl.FRONT,"front"),Te()(An,Wt.gl.BACK,"back"),An),Xn=function(){function t(e,n){Ut()(this,t),this.buffer=void 0;var r=n.data,i=n.usage,o=n.type;this.buffer=e.buffer({data:r,usage:Pn[i||Wt.gl.STATIC_DRAW],type:jn[o||Wt.gl.UNSIGNED_BYTE]})}return Vt()(t,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){}},{key:"subData",value:function(t){var e=t.data,n=t.offset;this.buffer.subdata(e,n)}}]),t}(),Yn=n(779),Kn=n.n(Yn),Qn=9007199254740991,Zn={};Zn["[object Float32Array]"]=Zn["[object Float64Array]"]=Zn["[object Int8Array]"]=Zn["[object Int16Array]"]=Zn["[object Int32Array]"]=Zn["[object Uint8Array]"]=Zn["[object Uint8ClampedArray]"]=Zn["[object Uint16Array]"]=Zn["[object Uint32Array]"]=!0,Zn["[object Arguments]"]=Zn["[object Array]"]=Zn["[object ArrayBuffer]"]=Zn["[object Boolean]"]=Zn["[object DataView]"]=Zn["[object Date]"]=Zn["[object Error]"]=Zn["[object Function]"]=Zn["[object Map]"]=Zn["[object Number]"]=Zn["[object Object]"]=Zn["[object RegExp]"]=Zn["[object Set]"]=Zn["[object String]"]=Zn["[object WeakMap]"]=!1;var Jn=Object.prototype.toString;var $n=function(t){return function(t){return!!t&&"object"===Me()(t)}(t)&&function(t){return"number"===typeof t&&t>-1&&t%1===0&&t<=Qn}(t.length)&&!!Zn[Jn.call(t)]};function tr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function er(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?tr(Object(n),!0).forEach((function(e){Te()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var nr=0,rr=function(){function t(e,n){var r=this;Ut()(this,t),this.reGl=e,this.context=n,this.entity=Object(Wt.createEntity)(),this.texFBO=void 0,this.computeCommand=void 0,this.textureCache={},this.outputTextureName=void 0,this.swapOutputTextureName=void 0,this.compiledPingpong=void 0,this.dynamicPingpong=void 0;var i={};this.context.uniforms.forEach((function(t){var e=t.name,n=t.type,o=t.data,a=t.isReferer,u=t.storageClass;if(u===Wt.STORAGE_CLASS.StorageBuffer){if(a)r.textureCache[e]={data:void 0},i["".concat(e,"Size")]=function(){return o.compiledBundle.context.output.textureSize};else{r.textureCache[e]=r.calcDataTexture(e,n,o);var s=r.textureCache[e],c=s.textureWidth,f=s.isOutput;i["".concat(e,"Size")]=[c,c],f&&(r.outputTextureName=e,r.context.needPingpong&&(r.outputTextureName="".concat(e,"Output"),r.textureCache[r.outputTextureName]=r.calcDataTexture(e,n,o)))}i[e]=function(){return r.textureCache[e].texture}}else if(u===Wt.STORAGE_CLASS.Uniform){if(o&&(Array.isArray(o)||$n(o))&&o.length>16)throw new Error("invalid data type ".concat(n));i[e]=function(){return t.data}}}));var o=this.getOuputDataTexture(),a=o.textureWidth,u=o.texelCount;i.u_OutputTextureSize=[a,a],i.u_OutputTexelCount=u,this.context.output.textureSize=[a,a];var s={attributes:{a_Position:[[-1,1,0],[-1,-1,0],[1,1,0],[1,-1,0]],a_TexCoord:[[0,1],[0,0],[1,1],[1,0]]},frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n".concat(this.context.shader),uniforms:i,vert:"attribute vec3 a_Position;\nattribute vec2 a_TexCoord;\n\nvarying vec2 v_TexCoord;\n\nvoid main() {\n  gl_Position = vec4(a_Position, 1.0);\n  v_TexCoord = a_TexCoord;\n}",primitive:"triangle strip",count:4};this.computeCommand=this.reGl(s)}return Vt()(t,[{key:"run",value:function(){var t=this;this.context.maxIteration>1&&this.context.needPingpong&&(this.compiledPingpong=!0),(this.compiledPingpong||this.dynamicPingpong)&&this.swap(),this.texFBO=this.reGl.framebuffer({color:this.getOuputDataTexture().texture}),this.texFBO.use((function(){t.computeCommand()}))}},{key:"readData",value:function(){var t=we()(Ee.a.mark((function t(){var e,n,r,i,o,a,u,s,c=this;return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.reGl({framebuffer:this.texFBO})((function(){e=c.reGl.read()})),!e){t.next=6;break}if(n=this.getOuputDataTexture(),r=n.originalDataLength,i=n.elementsPerTexel,o=n.typedArrayConstructor,a=void 0===o?Float32Array:o,u=[],4!==i)for(s=0;s<e.length;s+=4)1===i?u.push(e[s]):2===i?u.push(e[s],e[s+1]):u.push(e[s],e[s+1],e[s+2]);else u=e;return t.abrupt("return",new a(u.slice(0,r)));case 6:return t.abrupt("return",new Float32Array);case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"confirmInput",value:function(t,e){var n;this.entity===t.entity?(this.dynamicPingpong=!0,n=this):n=t,this.textureCache[e].id=n.getOuputDataTexture().id,this.textureCache[e].texture=n.getOuputDataTexture().texture}},{key:"updateUniform",value:function(){}},{key:"updateBuffer",value:function(t,e){var n=this.context.uniforms.find((function(e){return e.name===t}));if(n){var r=this.calcDataTexture(t,n.type,e),i=r.texture,o=r.data;this.textureCache[t].data=o,this.textureCache[t].texture=i}}},{key:"destroy",value:function(){}},{key:"swap",value:function(){if(this.swapOutputTextureName||this.createSwapOutputDataTexture(),this.compiledPingpong){var t=this.context.output.name;this.textureCache[t].id=this.getOuputDataTexture().id,this.textureCache[t].texture=this.getOuputDataTexture().texture}var e=this.outputTextureName;this.outputTextureName=this.swapOutputTextureName,this.swapOutputTextureName=e}},{key:"getOuputDataTexture",value:function(){return this.textureCache[this.outputTextureName]}},{key:"createSwapOutputDataTexture",value:function(){var t=this.cloneDataTexture(this.getOuputDataTexture());this.swapOutputTextureName="".concat(this.entity,"-swap"),this.textureCache[this.swapOutputTextureName]=t}},{key:"cloneDataTexture",value:function(t){var e=t.data,n=t.textureWidth;return er(er({},t),{},{id:nr++,texture:this.reGl.texture({width:n,height:n,data:e,type:"float"})})}},{key:"calcDataTexture",value:function(t,e,n){var r=1;e===Wt.AST_TOKEN_TYPES.Vector4FloatArray&&(r=4);for(var i=[],o=0;o<n.length;o+=r)1===r?i.push(n[o],0,0,0):2===r?i.push(n[o],n[o+1],0,0):3===r?i.push(n[o],n[o+1],n[o+2],0):4===r&&i.push(n[o],n[o+1],n[o+2],n[o+3]);var a=n.length,u=Math.ceil(a/r),s=Math.ceil(Math.sqrt(u)),c=s*s;u<c&&i.push.apply(i,Kn()(new Array(4*(c-u)).fill(0)));var f=this.reGl.texture({width:s,height:s,data:i,type:"float"});return{id:nr++,data:i,originalDataLength:a,typedArrayConstructor:$n(n)?n.constructor:void 0,textureWidth:s,texture:f,texelCount:u,elementsPerTexel:r,isOutput:t===this.context.output.name}}}]),t}(),ir=function(){function t(e,n){Ut()(this,t),this.elements=void 0;var r=n.data,i=n.usage,o=n.type,a=n.count;this.elements=e.elements({data:r,usage:Pn[i||Wt.gl.STATIC_DRAW],type:jn[o||Wt.gl.UNSIGNED_BYTE],count:a})}return Vt()(t,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(t){var e=t.data;this.elements.subdata(e)}},{key:"destroy",value:function(){this.elements.destroy()}}]),t}(),or=function(){function t(e,n){Ut()(this,t),this.framebuffer=void 0;var r=n.width,i=n.height,o=n.color,a=n.colors,u=(n.depth,n.stencil,{width:r,height:i});Array.isArray(a)&&(u.colors=a.map((function(t){return t.get()}))),o&&"boolean"!==typeof o&&(u.color=o.get()),this.framebuffer=e.framebuffer(u)}return Vt()(t,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(t){var e=t.width,n=t.height;this.framebuffer.resize(e,n)}}]),t}();function ar(t){var e={};return Object.keys(t).forEach((function(n){ur(n,t[n],e,"")})),e}function ur(t,e,n,r){null===e||"number"===typeof e||"boolean"===typeof e||Array.isArray(e)&&"number"===typeof e[0]||$n(e)||""===e||void 0!==e.resize?n["".concat(r&&r+".").concat(t)]=e:(function(t){var e=Me()(t);return null!=t&&("object"===e||"function"===e)}(e)&&Object.keys(e).forEach((function(i){ur(i,e[i],n,"".concat(r&&r+".").concat(t))})),Array.isArray(e)&&e.forEach((function(e,i){Object.keys(e).forEach((function(o){ur(o,e[o],n,"".concat(r&&r+".").concat(t,"[").concat(i,"]"))}))})))}function sr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function cr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?sr(Object(n),!0).forEach((function(e){Te()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var fr,lr,hr,dr=function(){function t(e,n){Ut()(this,t),this.reGl=void 0,this.drawCommand=void 0,this.uniforms={},this.reGl=e;var r=n.vs,i=n.fs,o=n.defines,a=n.attributes,u=n.uniforms,s=n.primitive,c=n.count,f=n.elements,l=n.depth,h=n.blend,d=n.stencil,p=n.cull,m=n.instances,v=n.scissor,g=n.viewport,y={};u&&(this.uniforms=ar(u),Object.keys(u).forEach((function(t){y[t]=e.prop(t)})));var b={};Object.keys(a).forEach((function(t){b[t]=a[t].get()}));var E=o&&this.generateDefines(o)||"",_={attributes:b,frag:"#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n".concat(E,"\n").concat(i),uniforms:y,vert:"\n".concat(E,"\n").concat(r),primitive:kn[void 0===s?Wt.gl.TRIANGLES:s]};m&&(_.instances=m),c&&(_.count=c),f&&(_.elements=f.get()),v&&(_.scissor=v),g&&(_.viewport=g),this.initDepthDrawParams({depth:l},_),this.initBlendDrawParams({blend:h},_),this.initStencilDrawParams({stencil:d},_),this.initCullDrawParams({cull:p},_),this.drawCommand=e(_)}return Vt()(t,[{key:"addUniforms",value:function(t){this.uniforms=cr(cr({},this.uniforms),ar(t))}},{key:"draw",value:function(t){var e=cr(cr({},this.uniforms),ar(t.uniforms||{})),n={};Object.keys(e).forEach((function(t){var r=Me()(e[t]);"boolean"===r||"number"===r||Array.isArray(e[t])||e[t].BYTES_PER_ELEMENT?n[t]=e[t]:"string"===r||(n[t]=e[t].get())})),this.drawCommand(n)}},{key:"destroy",value:function(){}},{key:"initDepthDrawParams",value:function(t,e){var n=t.depth;n&&(e.depth={enable:void 0===n.enable||!!n.enable,mask:void 0===n.mask||!!n.mask,func:Gn[n.func||Wt.gl.LESS],range:n.range||[0,1]})}},{key:"initBlendDrawParams",value:function(t,e){var n=t.blend;if(n){var r=n.enable,i=n.func,o=n.equation,a=n.color,u=void 0===a?[0,0,0,0]:a;e.blend={enable:!!r,func:{srcRGB:zn[i&&i.srcRGB||Wt.gl.SRC_ALPHA],srcAlpha:zn[i&&i.srcAlpha||Wt.gl.SRC_ALPHA],dstRGB:zn[i&&i.dstRGB||Wt.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:zn[i&&i.dstAlpha||Wt.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:Vn[o&&o.rgb||Wt.gl.FUNC_ADD],alpha:Vn[o&&o.alpha||Wt.gl.FUNC_ADD]},color:u}}}},{key:"initStencilDrawParams",value:function(t,e){var n=t.stencil;if(n){var r=n.enable,i=n.mask,o=void 0===i?-1:i,a=n.func,u=void 0===a?{cmp:Wt.gl.ALWAYS,ref:0,mask:-1}:a,s=n.opFront,c=void 0===s?{fail:Wt.gl.KEEP,zfail:Wt.gl.KEEP,zpass:Wt.gl.KEEP}:s,f=n.opBack,l=void 0===f?{fail:Wt.gl.KEEP,zfail:Wt.gl.KEEP,zpass:Wt.gl.KEEP}:f;e.stencil={enable:!!r,mask:o,func:cr(cr({},u),{},{cmp:Hn[u.cmp]}),opFront:{fail:Wn[c.fail],zfail:Wn[c.zfail],zpass:Wn[c.zpass]},opBack:{fail:Wn[l.fail],zfail:Wn[l.zfail],zpass:Wn[l.zpass]}}}}},{key:"initCullDrawParams",value:function(t,e){var n=t.cull;if(n){var r=n.enable,i=n.face,o=void 0===i?Wt.gl.BACK:i;e.cull={enable:!!r,face:qn[o]}}}},{key:"generateDefines",value:function(t){return Object.keys(t).map((function(e){return"#define ".concat(e," ").concat(Number(t[e]))})).join("\n")}}]),t}(),pr=function(){function t(e,n){Ut()(this,t),this.texture=void 0,this.width=void 0,this.height=void 0;var r=n.data,i=n.type,o=void 0===i?Wt.gl.UNSIGNED_BYTE:i,a=n.width,u=n.height,s=n.flipY,c=void 0!==s&&s,f=n.format,l=void 0===f?Wt.gl.RGBA:f,h=n.mipmap,d=void 0!==h&&h,p=n.wrapS,m=void 0===p?Wt.gl.CLAMP_TO_EDGE:p,v=n.wrapT,g=void 0===v?Wt.gl.CLAMP_TO_EDGE:v,y=n.aniso,b=void 0===y?0:y,E=n.alignment,_=void 0===E?1:E,w=n.premultiplyAlpha,x=void 0!==w&&w,T=n.mag,S=void 0===T?Wt.gl.NEAREST:T,A=n.min,O=void 0===A?Wt.gl.NEAREST:A,R=n.colorSpace,C=void 0===R?Wt.gl.BROWSER_DEFAULT_WEBGL:R;this.width=a,this.height=u;var M={width:a,height:u,type:jn[o],format:Dn[l],wrapS:Fn[m],wrapT:Fn[g],mag:Bn[S],min:Bn[O],alignment:_,flipY:c,colorSpace:Un[C],premultiplyAlpha:x,aniso:b};r&&(M.data=r),"number"===typeof d?M.mipmap=Ln[d]:"boolean"===typeof d&&(M.mipmap=d),this.texture=e.texture(M)}return Vt()(t,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(t){var e=t.width,n=t.height;this.texture.resize(e,n),this.width=e,this.height=n}},{key:"destroy",value:function(){this.texture.destroy()}}]),t}(),mr=Object(Xt.injectable)()((lr=function(){function t(){var e=this;Ut()(this,t),this.supportWebGPU=!1,this.useWGSL=!1,this.$canvas=void 0,this.gl=void 0,this.inited=void 0,this.createModel=function(){var t=we()(Ee.a.mark((function t(n){return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.uniforms){t.next=3;break}return t.next=3,Promise.all(Object.keys(n.uniforms).map(function(){var t=we()(Ee.a.mark((function t(e){var r;return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.uniforms[e]||void 0===n.uniforms[e].load){t.next=5;break}return t.next=3,n.uniforms[e].load();case 3:r=t.sent,n.uniforms[e]=r;case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 3:return t.abrupt("return",new dr(e.gl,n));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.createAttribute=function(t){return new Nn(e.gl,t)},this.createBuffer=function(t){return new Xn(e.gl,t)},this.createElements=function(t){return new ir(e.gl,t)},this.createTexture2D=function(t){return new pr(e.gl,t)},this.createFramebuffer=function(t){return new or(e.gl,t)},this.useFramebuffer=function(t,n){e.gl({framebuffer:t?t.get():null})(n)},this.createComputeModel=function(){var t=we()(Ee.a.mark((function t(n){return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new rr(e.gl,n));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.clear=function(t){var n=t.color,r=t.depth,i=t.stencil,o=t.framebuffer,a=void 0===o?null:o,u={color:n,depth:r,stencil:i};u.framebuffer=null===a?a:a.get(),e.gl.clear(u)},this.setScissor=function(t){e.gl&&e.gl._gl&&(t.enable&&t.box?(e.gl._gl.enable(Wt.gl.SCISSOR_TEST),e.gl._gl.scissor(t.box.x,t.box.y,t.box.width,t.box.height)):e.gl._gl.disable(Wt.gl.SCISSOR_TEST),e.gl._refresh())},this.viewport=function(t){var n=t.x,r=t.y,i=t.width,o=t.height;e.gl&&e.gl._gl&&(e.gl._gl.viewport(n,r,i,o),e.gl._refresh())},this.readPixels=function(t){var n=t.framebuffer,r={x:t.x,y:t.y,width:t.width,height:t.height};return n&&(r.framebuffer=n.get()),e.gl.read(r)},this.getCanvas=function(){return e.$canvas},this.getGLContext=function(){return e.gl._gl},this.destroy=function(){e.gl&&(e.gl.destroy(),e.inited=!1)}}return Vt()(t,[{key:"init",value:function(){var t=we()(Ee.a.mark((function t(e){return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.inited){t.next=2;break}return t.abrupt("return");case 2:return this.$canvas=e.canvas,t.next=5,new Promise((function(t,n){In()({canvas:e.canvas,attributes:{alpha:!0,antialias:e.antialias,premultipliedAlpha:!0},pixelRatio:1,extensions:["OES_element_index_uint","OES_texture_float","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(e,r){!e&&r||n(e),t(r)}})}));case 5:this.gl=t.sent,this.inited=!0;case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"isFloatSupported",value:function(){return this.gl.limits.readFloat}},{key:"beginFrame",value:function(){}},{key:"endFrame",value:function(){}}]),t}(),fr=lr))||fr;function vr(t,e,n,r){if("undefined"!==typeof window){var i=document.getElementsByTagName("head")[0],o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src",t),r&&(o.id=r),o.onload=function(){e&&e()},o.onerror=function(e){n&&n("Unable to load script '".concat(t,"'"),e)},i.appendChild(o)}}function gr(t,e){return new Promise((function(e,n){vr(t,(function(){e()}),(function(t,e){n(e)}))}))}var yr=function(){return br.apply(this,arguments)};function br(){return(br=we()(Ee.a.mark((function t(){return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!hr){t.next=2;break}return t.abrupt("return",hr);case 2:return t.next=4,gr("https://preview.babylonjs.com/glslang/glslang.js");case 4:return hr=window.glslang("https://preview.babylonjs.com/glslang/glslang.wasm"),t.abrupt("return",hr);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Er=function(){function t(e,n){Ut()(this,t),this.engine=e,this.options=n,this.attribute=void 0,this.buffer=void 0;var r=n,i=r.buffer,o=r.offset,a=r.stride,u=r.normalized,s=r.size,c=r.divisor,f=r.arrayStride,l=r.attributes,h=r.stepMode;this.buffer=i,this.attribute={buffer:i.get(),offset:o||0,stride:a||0,normalized:u||!1,divisor:c||0,arrayStride:f||0,attributes:l,stepMode:h||"vertex"},s&&(this.attribute.size=s)}return Vt()(t,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),t}(),_r=function(){function t(e,n){Ut()(this,t),this.engine=e,this.options=n,this.buffer=void 0;var r=n,i=r.data,o=r.usage;r.type;this.buffer=this.createBuffer(i instanceof Array?new Float32Array(i):i,o||Se.BufferUsage.Vertex|Se.BufferUsage.CopyDst)}return Vt()(t,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(t){var e=t.data,n=t.offset;this.setSubData(this.buffer,n,e instanceof Array?new Float32Array(e):e)}},{key:"createBuffer",value:function(t,e){var n=t.byteLength%4,r={size:t.byteLength+n,usage:e},i=this.engine.device.createBuffer(r);return this.setSubData(i,0,t),i}},{key:"setSubData",value:function(t,e,n){(Wt.isSafari?this.engine.device.getQueue():this.engine.device.defaultQueue).writeBuffer(t,e,n)}}]),t}();var wr,xr,Tr,Sr,Ar,Or,Rr,Cr=function(){function t(e,n){Ut()(this,t),this.engine=e,this.context=n,this.entity=Object(Wt.createEntity)(),this.uniformGPUBufferLayout=[],this.uniformBuffer=void 0,this.vertexBuffers={},this.outputBuffer=void 0,this.bindGroupEntries=void 0,this.bindGroup=void 0,this.computePipeline=void 0}return Vt()(t,[{key:"init",value:function(){var t=we()(Ee.a.mark((function t(){var e,n,r,i,o,a,u,s=this;return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.compileComputePipelineStageDescriptor(this.context.shader);case 2:e=t.sent,n=e.computeStage,r=this.context.uniforms.filter((function(t){return t.storageClass===Wt.STORAGE_CLASS.StorageBuffer})),i=this.context.uniforms.filter((function(t){return t.storageClass===Wt.STORAGE_CLASS.Uniform})),o=i.length?1:0,this.bindGroupEntries=[],o&&(a=0,u=[],i.forEach((function(t){if("number"===typeof t.data)s.uniformGPUBufferLayout.push({name:t.name,offset:a}),a+=4,u.push(t.data);else{var e,n=(null===(e=t.data)||void 0===e?void 0:e.length)||1;3===n&&(n=4,t.data.push(0));var r=a/4%4;if(r>0){var i=4-r;if(n>1&&n<=i)2===n&&(3===i&&(a+=4,u.push(0)),u.push.apply(u,Kn()(t.data)),s.uniformGPUBufferLayout.push({name:t.name,offset:a}));else{for(var o=0;o<i;o++)a+=4,u.push(0);u.push.apply(u,Kn()(t.data)),s.uniformGPUBufferLayout.push({name:t.name,offset:a})}}a+=4*n}})),this.uniformBuffer=new _r(this.engine,{data:u instanceof Array?new Float32Array(u):u,usage:Se.BufferUsage.Uniform|Se.BufferUsage.CopyDst}),this.bindGroupEntries.push({binding:0,resource:{buffer:this.uniformBuffer.get()}})),r.forEach((function(t){var e;null!==t.data&&(t.type!==Wt.AST_TOKEN_TYPES.Vector4FloatArray&&t.type!==Wt.AST_TOKEN_TYPES.FloatArray||(t.name===s.context.output.name?(e=new _r(s.engine,{data:isFinite(Number(t.data))?[t.data]:t.data,usage:Se.BufferUsage.Storage|Se.BufferUsage.CopyDst|Se.BufferUsage.CopySrc}),s.outputBuffer=e,s.context.output={name:t.name,length:isFinite(Number(t.data))?1:t.data.length,typedArrayConstructor:Float32Array,gpuBuffer:e.get()}):t.isReferer?t.data.model&&t.data.model.outputBuffer&&(e=t.data.model.outputBuffer):e=new _r(s.engine,{data:isFinite(Number(t.data))?[t.data]:t.data,usage:Se.BufferUsage.Storage|Se.BufferUsage.CopyDst|Se.BufferUsage.CopySrc}),s.vertexBuffers[t.name]=e,s.bindGroupEntries.push({binding:o,resource:{name:t.name,refer:e?void 0:t.data,buffer:e?e.get():void 0}}),o++))})),this.computePipeline=this.engine.device.createComputePipeline({computeStage:n}),this.bindGroup=this.engine.device.createBindGroup({layout:this.computePipeline.getBindGroupLayout(0),entries:this.bindGroupEntries});case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"destroy",value:function(){var t=this;this.uniformBuffer&&this.uniformBuffer.destroy(),Object.keys(this.vertexBuffers).forEach((function(e){return t.vertexBuffers[e].destroy()}))}},{key:"readData",value:function(){var t=we()(Ee.a.mark((function t(){var e,n,r,i,o,a,u,s,c;return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=this.context.output)){t.next=16;break}if(n=e.length,r=e.typedArrayConstructor,!(i=e.gpuBuffer)){t.next=16;break}return o=n*r.BYTES_PER_ELEMENT,a=this.engine.device.createBuffer({size:o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),(u=this.engine.device.createCommandEncoder()).copyBufferToBuffer(i,0,a,0,o),(Wt.isSafari?this.engine.device.getQueue():this.engine.device.defaultQueue).submit([u.finish()]),t.next=12,a.mapAsync(Se.MapMode.Read);case 12:return s=a.getMappedRange(),c=new r(s.slice(0)),a.unmap(),t.abrupt("return",c);case 16:return t.abrupt("return",new Float32Array);case 17:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"run",value:function(){var t;this.engine.currentComputePass&&(this.engine.currentComputePass.setPipeline(this.computePipeline),this.engine.currentComputePass.setBindGroup(0,this.bindGroup),(t=this.engine.currentComputePass).dispatch.apply(t,Kn()(this.context.dispatch)))}},{key:"updateBuffer",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.vertexBuffers[t];r&&r.subData({data:e,offset:n})}},{key:"updateUniform",value:function(t,e){var n=this.uniformGPUBufferLayout.find((function(e){return e.name===t}));n&&this.uniformBuffer.subData({data:Number.isFinite(e)?new Float32Array([e]):new Float32Array(e),offset:n.offset})}},{key:"confirmInput",value:function(t,e){var n=this.vertexBuffers[e],r=t.outputBuffer;if(n&&r&&n!==r){var i=this.engine.device.createCommandEncoder(),o=t.context.output,a=o.length*o.typedArrayConstructor.BYTES_PER_ELEMENT;i.copyBufferToBuffer(r.get(),0,n.get(),0,a),(Wt.isSafari?this.engine.device.getQueue():this.engine.device.defaultQueue).submit([i.finish()])}}},{key:"compileShaderToSpirV",value:function(t,e,n){return this.compileRawShaderToSpirV(n+t,e)}},{key:"compileRawShaderToSpirV",value:function(t,e){return this.engine.glslang.compileGLSL(t,e)}},{key:"compileComputePipelineStageDescriptor",value:function(){var t=we()(Ee.a.mark((function t(e){var n;return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e,"#version 450\n",this.engine.options.useWGSL){t.next=6;break}return t.next=5,this.compileShaderToSpirV(e,"compute","#version 450\n");case 5:n=t.sent;case 6:return t.abrupt("return",{computeStage:{module:this.engine.device.createShaderModule({code:n,isWHLSL:Wt.isSafari}),entryPoint:"main"}});case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}(),Mr=function(){function t(e,n){Ut()(this,t),this.engine=e,this.options=n,this.indexCount=void 0,this.buffer=void 0;var r=n,i=r.data,o=(r.usage,r.type,r.count);this.indexCount=o||0,this.buffer=new _r(e,{data:i instanceof Array?new Uint16Array(i):i,usage:Se.BufferUsage.Index|Se.BufferUsage.CopyDst})}return Vt()(t,[{key:"get",value:function(){return this.buffer}},{key:"subData",value:function(t){this.buffer.subData(t)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),t}(),Ir=function(){function t(e,n){Ut()(this,t),this.engine=e,this.options=n,this.colorTexture=void 0,this.depthTexture=void 0,this.width=0,this.height=0;var r=n,i=(r.width,r.height,r.color),o=(r.colors,r.depth);r.stencil;i&&(this.colorTexture=i),o&&(this.depthTexture=o)}return Vt()(t,[{key:"get",value:function(){var t,e;return{color:null===(t=this.colorTexture)||void 0===t?void 0:t.get(),depth:null===(e=this.depthTexture)||void 0===e?void 0:e.get()}}},{key:"destroy",value:function(){var t,e;null===(t=this.colorTexture)||void 0===t||t.destroy(),null===(e=this.depthTexture)||void 0===e||e.destroy()}},{key:"resize",value:function(t){var e,n,r=t.width,i=t.height;r===this.width&&i===this.height||(null===(e=this.colorTexture)||void 0===e||e.resize({width:r,height:i}),null===(n=this.depthTexture)||void 0===n||n.resize({width:r,height:i}));this.width=r,this.height=i}}]),t}(),Nr=(wr={},Te()(wr,Wt.gl.POINTS,Se.PrimitiveTopology.PointList),Te()(wr,Wt.gl.LINES,Se.PrimitiveTopology.LineList),Te()(wr,Wt.gl.LINE_LOOP,Se.PrimitiveTopology.LineList),Te()(wr,Wt.gl.LINE_STRIP,Se.PrimitiveTopology.LineStrip),Te()(wr,Wt.gl.TRIANGLES,Se.PrimitiveTopology.TriangleList),Te()(wr,Wt.gl.TRIANGLE_FAN,Se.PrimitiveTopology.TriangleList),Te()(wr,Wt.gl.TRIANGLE_STRIP,Se.PrimitiveTopology.TriangleStrip),wr),kr=(xr={},Te()(xr,Wt.gl.NEVER,Se.CompareFunction.Never),Te()(xr,Wt.gl.ALWAYS,Se.CompareFunction.Always),Te()(xr,Wt.gl.LESS,Se.CompareFunction.Less),Te()(xr,Wt.gl.LEQUAL,Se.CompareFunction.LessEqual),Te()(xr,Wt.gl.GREATER,Se.CompareFunction.Greater),Te()(xr,Wt.gl.GEQUAL,Se.CompareFunction.GreaterEqual),Te()(xr,Wt.gl.EQUAL,Se.CompareFunction.Equal),Te()(xr,Wt.gl.NOTEQUAL,Se.CompareFunction.NotEqual),xr),Pr=(Tr={},Te()(Tr,Wt.gl.FUNC_ADD,Se.BlendOperation.Add),Te()(Tr,Wt.gl.MIN_EXT,Se.BlendOperation.Min),Te()(Tr,Wt.gl.MAX_EXT,Se.BlendOperation.Max),Te()(Tr,Wt.gl.FUNC_SUBTRACT,Se.BlendOperation.Subtract),Te()(Tr,Wt.gl.FUNC_REVERSE_SUBTRACT,Se.BlendOperation.ReverseSubtract),Tr),jr=(Sr={},Te()(Sr,Wt.gl.ZERO,Se.BlendFactor.Zero),Te()(Sr,Wt.gl.ONE,Se.BlendFactor.One),Te()(Sr,Wt.gl.SRC_COLOR,Se.BlendFactor.SrcColor),Te()(Sr,Wt.gl.ONE_MINUS_SRC_COLOR,Se.BlendFactor.OneMinusSrcColor),Te()(Sr,Wt.gl.SRC_ALPHA,Se.BlendFactor.SrcAlpha),Te()(Sr,Wt.gl.ONE_MINUS_SRC_ALPHA,Se.BlendFactor.OneMinusSrcAlpha),Te()(Sr,Wt.gl.DST_COLOR,Se.BlendFactor.DstColor),Te()(Sr,Wt.gl.ONE_MINUS_DST_COLOR,Se.BlendFactor.OneMinusDstColor),Te()(Sr,Wt.gl.DST_ALPHA,Se.BlendFactor.DstAlpha),Te()(Sr,Wt.gl.ONE_MINUS_DST_ALPHA,Se.BlendFactor.OneMinusDstAlpha),Te()(Sr,Wt.gl.CONSTANT_COLOR,Se.BlendFactor.BlendColor),Te()(Sr,Wt.gl.ONE_MINUS_CONSTANT_COLOR,Se.BlendFactor.OneMinusBlendColor),Te()(Sr,Wt.gl.SRC_ALPHA_SATURATE,Se.BlendFactor.SrcAlphaSaturated),Sr),Dr=(Ar={},Te()(Ar,Wt.gl.ALPHA,"r8unorm"),Te()(Ar,Wt.gl.RGBA,"rgba8unorm"),Te()(Ar,Wt.gl.DEPTH_COMPONENT,"depth32float"),Te()(Ar,Wt.gl.DEPTH_STENCIL,"depth24plus-stencil8"),Ar),Lr=(Or={},Te()(Or,Wt.gl.NEAREST,"nearest"),Te()(Or,Wt.gl.LINEAR,"linear"),Or),Br=(Rr={},Te()(Rr,Wt.gl.REPEAT,"repeat"),Te()(Rr,Wt.gl.CLAMP_TO_EDGE,"clamp-to-edge"),Te()(Rr,Wt.gl.MIRRORED_REPEAT,"mirror-repeat"),Rr);function Fr(t){var e=t.cull;return e&&e.enable?e.face?e.face===Wt.gl.FRONT?Se.CullMode.Front:Se.CullMode.Back:void 0:Se.CullMode.None}function Ur(t){var e=t.depth,n=(t.stencil,{compare:Se.CompareFunction.Always,depthFailOp:Se.StencilOperation.Keep,failOp:Se.StencilOperation.Keep,passOp:Se.StencilOperation.Keep});return{depthWriteEnabled:e&&e.enable,depthCompare:kr[(null===e||void 0===e?void 0:e.func)||Wt.gl.ALWAYS],format:Se.TextureFormat.Depth24PlusStencil8,stencilFront:n,stencilBack:n,stencilReadMask:4294967295,stencilWriteMask:4294967295}}function Gr(t,e){var n=t.blend;return[{format:e,alphaBlend:{srcFactor:jr[n&&n.func&&n.func.srcAlpha||Wt.gl.ONE],dstFactor:jr[n&&n.func&&n.func.dstAlpha||Wt.gl.ZERO],operation:Pr[n&&n.equation&&n.equation.alpha||Wt.gl.FUNC_ADD]},colorBlend:{srcFactor:jr[n&&n.func&&n.func.srcRGB||Wt.gl.ONE],dstFactor:jr[n&&n.func&&n.func.dstRGB||Wt.gl.ZERO],operation:Pr[n&&n.equation&&n.equation.rgb||Wt.gl.FUNC_ADD]},writeMask:Se.ColorWrite.All}]}function Vr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function zr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Vr(Object(n),!0).forEach((function(e){Te()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Hr(t){for(var e=0,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var o=0,a=r;o<a.length;o++){var u=a[o];e+=u.length}for(var s=new t(e),c=0,f=0,l=r;f<l.length;f++){var h=l[f];s.set(h,c),c+=h.length}return s}var Wr,qr,Xr,Yr=function(){function t(e,n){Ut()(this,t),this.engine=e,this.options=n,this.pipelineLayout=void 0,this.renderPipeline=void 0,this.uniformsBindGroupLayout=void 0,this.uniformBindGroup=void 0,this.uniformBuffer=void 0,this.uniforms={},this.uniformGPUBufferLayout=[],this.attributeCache={},this.indexBuffer=void 0,this.indexCount=void 0}return Vt()(t,[{key:"init",value:function(){var t=we()(Ee.a.mark((function t(){var e,n,r,i,o,a,u,s,c,f,l,h,d,p,m,v,g=this;return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.options,n=e.vs,r=e.fs,i=e.attributes,o=e.uniforms,a=e.primitive,e.count,u=e.elements,s=e.depth,c=e.blend,f=e.stencil,l=e.cull,e.instances,t.next=3,this.compilePipelineStageDescriptor(n,r,null);case 3:h=t.sent,d=h.vertexStage,p=h.fragmentStage,o&&this.buildUniformBindGroup(o),u&&(this.indexBuffer=u.get(),this.indexCount=u.indexCount),m={vertexBuffers:Object.keys(i).map((function(t,e){var n=i[t],r=n.get(),o=r.arrayStride,a=r.stepMode,u=r.attributes;return g.attributeCache[t]=n,{arrayStride:o,stepMode:a,attributes:u}}))},v={sampleCount:this.engine.mainPassSampleCount,primitiveTopology:Nr[a||Wt.gl.TRIANGLES],rasterizationState:zr(zr({},this.getDefaultRasterizationStateDescriptor()),{},{cullMode:Fr({cull:l})}),depthStencilState:Ur({depth:s,stencil:f}),colorStates:Gr({blend:c},this.engine.options.swapChainFormat),layout:this.pipelineLayout,vertexStage:d,fragmentStage:p,vertexState:m},this.renderPipeline=this.engine.device.createRenderPipeline(v);case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"addUniforms",value:function(t){this.uniforms=zr(zr({},this.uniforms),ar(t))}},{key:"draw",value:function(t){var e=this,n=this.engine.getCurrentRenderPass(),r=zr(zr({},this.uniforms),ar(t.uniforms||{})),i=[];Object.keys(r).forEach((function(t){var n=Me()(r[t]);if("boolean"===n||"number"===n||Array.isArray(r[t])||r[t].BYTES_PER_ELEMENT){var o,a=null===(o=e.uniformGPUBufferLayout.find((function(e){return e.name===t})))||void 0===o?void 0:o.offset;null!==a&&e.uniformBuffer.subData({data:r[t],offset:a})}else{var u,s=null===(u=e.uniformGPUBufferLayout.find((function(e){return e.name===t})))||void 0===u?void 0:u.offset;if(null!==s){var c=r[t].get(),f=c.color||c,l=f.texture,h=f.sampler;h&&(i.push({binding:s,resource:h}),s++),i.push({binding:s,resource:l.createView()})}}})),this.uniformBuffer&&(i[0]={binding:0,resource:{buffer:this.uniformBuffer.get()}}),this.uniformBindGroup=this.engine.device.createBindGroup({layout:this.uniformsBindGroupLayout,entries:i}),this.renderPipeline&&n.setPipeline(this.renderPipeline),n.setBindGroup(0,this.uniformBindGroup),this.indexBuffer&&n.setIndexBuffer(this.indexBuffer.get(),Se.IndexFormat.Uint32,0),Object.keys(this.attributeCache).forEach((function(t,r){n.setVertexBuffer(0+r,e.attributeCache[t].get().buffer,0)})),this.indexBuffer?n.drawIndexed(this.indexCount,this.options.instances||1,0,0,0):n.draw(this.options.count||0,this.options.instances||0,0,0)}},{key:"destroy",value:function(){throw new Error("Method not implemented.")}},{key:"compilePipelineStageDescriptor",value:function(){var t=we()(Ee.a.mark((function t(e,n,r){var i,o,a;return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i="#version 450\n",o=e,a=n,this.engine.options.useWGSL){t.next=10;break}return t.next=6,this.compileShaderToSpirV(e,"vertex",i);case 6:return o=t.sent,t.next=9,this.compileShaderToSpirV(n,"fragment",i);case 9:a=t.sent;case 10:return t.abrupt("return",this.createPipelineStageDescriptor(o,a));case 11:case"end":return t.stop()}}),t,this)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"compileShaderToSpirV",value:function(t,e,n){return this.compileRawShaderToSpirV(n+t,e)}},{key:"compileRawShaderToSpirV",value:function(t,e){return this.engine.glslang.compileGLSL(t,e)}},{key:"createPipelineStageDescriptor",value:function(t,e){return{vertexStage:{module:this.engine.device.createShaderModule({code:t,isWHLSL:Wt.isSafari}),entryPoint:"main"},fragmentStage:{module:this.engine.device.createShaderModule({code:e,isWHLSL:Wt.isSafari}),entryPoint:"main"}}}},{key:"getDefaultRasterizationStateDescriptor",value:function(){return{frontFace:Se.FrontFace.CCW,cullMode:Se.CullMode.None,depthBias:0,depthBiasSlopeScale:0,depthBiasClamp:0}}},{key:"buildUniformBindGroup",value:function(t){var e=this,n=0,r=Hr.apply(void 0,[Float32Array].concat(Kn()(Object.keys(t).map((function(r){return t[r]?(e.uniformGPUBufferLayout.push({name:r,offset:n}),n+=4*(t[r].length||1),t[r]):[]}))))),i=[],o=!1;r.length&&(o=!0,i.push({binding:0,visibility:Se.ShaderStage.Fragment|Se.ShaderStage.Vertex,type:Se.BindingType.UniformBuffer})),Object.keys(t).filter((function(e){return null===t[e]})).forEach((function(t,n){e.uniformGPUBufferLayout.push({name:t,offset:2*n+(o?1:0)}),i.push({binding:2*n+(o?1:0),visibility:Se.ShaderStage.Fragment,type:Se.BindingType.Sampler},{binding:2*n+(o?1:0)+1,visibility:Se.ShaderStage.Fragment,type:Se.BindingType.SampledTexture})})),this.uniformsBindGroupLayout=this.engine.device.createBindGroupLayout({entries:i}),this.pipelineLayout=this.engine.device.createPipelineLayout({bindGroupLayouts:[this.uniformsBindGroupLayout]}),o&&(this.uniformBuffer=new _r(this.engine,{data:r instanceof Array?new Float32Array(r):r,usage:Se.BufferUsage.Uniform|Se.BufferUsage.CopyDst}))}}]),t}(),Kr=function(){function t(e,n){Ut()(this,t),this.engine=e,this.options=n,this.texture=void 0,this.sampler=void 0,this.width=void 0,this.height=void 0,this.createTexture()}return Vt()(t,[{key:"get",value:function(){return{texture:this.texture,sampler:this.sampler}}},{key:"update",value:function(){}},{key:"resize",value:function(t){var e=t.width,n=t.height;e===this.width&&n===this.height||(this.destroy(),this.createTexture()),this.width=e,this.height=n}},{key:"destroy",value:function(){this.texture&&this.texture.destroy()}},{key:"createTexture",value:function(){var t=this.options,e=(t.data,t.type),n=(void 0===e&&Wt.gl.UNSIGNED_BYTE,t.width),r=t.height,i=(t.flipY,t.format),o=void 0===i?Wt.gl.RGBA:i,a=(t.mipmap,t.wrapS),u=void 0===a?Wt.gl.CLAMP_TO_EDGE:a,s=t.wrapT,c=void 0===s?Wt.gl.CLAMP_TO_EDGE:s,f=t.aniso,l=void 0===f?0:f,h=(t.alignment,t.premultiplyAlpha,t.mag),d=void 0===h?Wt.gl.NEAREST:h,p=t.min,m=void 0===p?Wt.gl.NEAREST:p,v=t.colorSpace,g=(void 0===v&&Wt.gl.BROWSER_DEFAULT_WEBGL,t.usage);this.width=n,this.height=r,this.texture=this.engine.device.createTexture({size:[n,r,1],mipLevelCount:1,sampleCount:1,dimension:Se.TextureDimension.E2d,format:Dr[o],usage:g||Se.TextureUsage.Sampled|Se.TextureUsage.CopyDst}),(!g||g&Se.TextureUsage.Sampled)&&(this.sampler=this.engine.device.createSampler({addressModeU:Br[u],addressModeV:Br[c],addressModeW:Br[u],magFilter:Lr[d],minFilter:Lr[m],maxAnisotropy:l}))}}]),t}(),Qr=Object(Xt.injectable)()((qr=function(){function t(){var e=this;Ut()(this,t),this.supportWebGPU=!0,this.useWGSL=!1,this.options=void 0,this.canvas=void 0,this.context=void 0,this.glslang=void 0,this.adapter=void 0,this.device=void 0,this.swapChain=void 0,this.mainPassSampleCount=void 0,this.mainTexture=void 0,this.depthTexture=void 0,this.mainColorAttachments=void 0,this.mainTextureExtends=void 0,this.mainDepthAttachment=void 0,this.uploadEncoder=void 0,this.renderEncoder=void 0,this.computeEncoder=void 0,this.renderTargetEncoder=void 0,this.commandBuffers=new Array(4).fill(void 0),this.currentRenderPass=null,this.mainRenderPass=null,this.currentRenderTargetViewDescriptor=void 0,this.currentComputePass=null,this.bundleEncoder=void 0,this.tempBuffers=[],this.currentRenderTarget=null,this.uploadEncoderDescriptor={label:"upload"},this.renderEncoderDescriptor={label:"render"},this.renderTargetEncoderDescriptor={label:"renderTarget"},this.computeEncoderDescriptor={label:"compute"},this.pipelines={},this.computePipelines={},this.defaultSampleCount=4,this.clearDepthValue=1,this.clearStencilValue=0,this.transientViewport={x:1/0,y:0,width:0,height:0},this.cachedViewport={x:0,y:0,width:0,height:0},this.clear=function(t){t.framebuffer;var n=t.color,r=t.depth,i=t.stencil;e.options.supportCompute&&e.startComputePass(),e.currentRenderTarget?(e.currentRenderPass&&e.endRenderTargetRenderPass(),e.startRenderTargetRenderPass(e.currentRenderTarget,n||null,!!r,!!i)):(e.mainColorAttachments[0].loadValue=n||Se.LoadOp.Load,e.mainDepthAttachment.depthLoadValue=r||Se.LoadOp.Load,e.mainDepthAttachment.stencilLoadValue=i?e.clearStencilValue:Se.LoadOp.Load,e.mainRenderPass&&e.endMainRenderPass(),e.startMainRenderPass())},this.createModel=function(){var t=we()(Ee.a.mark((function t(n){var r;return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new Yr(e,n),t.next=3,r.init();case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.createAttribute=function(t){return new Er(e,t)},this.createBuffer=function(t){return new _r(e,t)},this.createElements=function(t){return new Mr(e,t)},this.createTexture2D=function(t){return new Kr(e,t)},this.createFramebuffer=function(t){return new Ir(e,t)},this.useFramebuffer=function(t,n){e.currentRenderTarget&&e.unbindFramebuffer(e.currentRenderTarget),e.currentRenderTarget=t,e.currentRenderTargetViewDescriptor={dimension:Se.TextureViewDimension.E2d,arrayLayerCount:1,aspect:Se.TextureAspect.All},e.currentRenderPass=null,n()},this.createComputeModel=function(){var t=we()(Ee.a.mark((function t(n){var r;return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new Cr(e,n),t.next=3,r.init();case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.getCanvas=function(){return e.canvas},this.getGLContext=function(){throw new Error("Method not implemented.")},this.viewport=function(t){var n=t.x,r=t.y,i=t.width,o=t.height;if(e.currentRenderPass){if(e.transientViewport.x!==1/0){e.getCurrentRenderPass().setViewport(e.transientViewport.x,e.transientViewport.y,e.transientViewport.width,e.transientViewport.height,0,1)}else if(n!==e.cachedViewport.x||r!==e.cachedViewport.y||i!==e.cachedViewport.width||o!==e.cachedViewport.height){e.cachedViewport={x:n,y:r,width:i,height:o},e.getCurrentRenderPass().setViewport(n,r,i,o,0,1)}}else e.transientViewport={x:n,y:r,width:i,height:o}},this.readPixels=function(t){throw new Error("Method not implemented.")}}return Vt()(t,[{key:"isFloatSupported",value:function(){return!0}},{key:"init",value:function(){var t=we()(Ee.a.mark((function t(e){return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.canvas=e.canvas,this.options=e,this.useWGSL=!!e.useWGSL,this.mainPassSampleCount=e.antialiasing?this.defaultSampleCount:1,t.next=6,this.initGlslang();case 6:this.initContextAndSwapChain(),this.initMainAttachments();case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"setScissor",value:function(t){throw new Error("Method not implemented.")}},{key:"destroy",value:function(){this.mainTexture&&this.mainTexture.destroy(),this.depthTexture&&this.depthTexture.destroy(),this.tempBuffers.forEach((function(t){return t.destroy()})),this.tempBuffers=[]}},{key:"beginFrame",value:function(){this.uploadEncoder=this.device.createCommandEncoder(this.uploadEncoderDescriptor),this.renderEncoder=this.device.createCommandEncoder(this.renderEncoderDescriptor),this.renderTargetEncoder=this.device.createCommandEncoder(this.renderTargetEncoderDescriptor),this.options.supportCompute&&(this.computeEncoder=this.device.createCommandEncoder(this.computeEncoderDescriptor))}},{key:"endFrame",value:function(){this.options.supportCompute&&this.endComputePass(),this.endMainRenderPass(),this.commandBuffers[0]=this.uploadEncoder.finish(),this.commandBuffers[1]=this.renderEncoder.finish(),this.options.supportCompute&&(this.commandBuffers[2]=this.computeEncoder.finish()),this.commandBuffers[3]=this.renderTargetEncoder.finish(),Wt.isSafari?this.device.getQueue().submit(this.commandBuffers.filter((function(t){return t}))):this.device.defaultQueue.submit(this.commandBuffers.filter((function(t){return t})))}},{key:"getCurrentRenderPass",value:function(){return this.currentRenderTarget&&!this.currentRenderPass?this.startRenderTargetRenderPass(this.currentRenderTarget,null,!1,!1):this.currentRenderPass||this.startMainRenderPass(),this.currentRenderPass}},{key:"initGlslang",value:function(){var t=we()(Ee.a.mark((function t(){var e,n;return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,yr();case 2:return this.glslang=t.sent,t.next=5,null===(e=navigator)||void 0===e||null===(n=e.gpu)||void 0===n?void 0:n.requestAdapter();case 5:return this.adapter=t.sent,t.next=8,this.adapter.requestDevice();case 8:this.device=t.sent;case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"initContextAndSwapChain",value:function(){this.context=this.canvas.getContext(Wt.isSafari?"gpu":"gpupresent"),this.swapChain=this.context.configureSwapChain({device:this.device,format:this.options.swapChainFormat,usage:Se.TextureUsage.OutputAttachment|Se.TextureUsage.CopySrc})}},{key:"initMainAttachments",value:function(){if(this.mainTextureExtends={width:this.canvas.width,height:this.canvas.height,depth:1},this.options.antialiasing){var t={size:this.mainTextureExtends,mipLevelCount:1,sampleCount:this.mainPassSampleCount,dimension:Se.TextureDimension.E2d,format:Se.TextureFormat.BGRA8Unorm,usage:Se.TextureUsage.OutputAttachment};this.mainTexture&&this.mainTexture.destroy(),this.mainTexture=this.device.createTexture(t),this.mainColorAttachments=[{attachment:Wt.isSafari?this.mainTexture.createDefaultView():this.mainTexture.createView(),loadValue:[0,0,0,1],storeOp:Se.StoreOp.Store}]}else this.mainColorAttachments=[{attachment:Wt.isSafari?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView(),loadValue:[0,0,0,1],storeOp:Se.StoreOp.Store}];var e={size:this.mainTextureExtends,mipLevelCount:1,sampleCount:this.mainPassSampleCount,dimension:Se.TextureDimension.E2d,format:Wt.isSafari?"depth32float-stencil8":Se.TextureFormat.Depth24PlusStencil8,usage:Se.TextureUsage.OutputAttachment};this.depthTexture&&this.depthTexture.destroy(),this.depthTexture=this.device.createTexture(e),this.mainDepthAttachment={attachment:Wt.isSafari?this.depthTexture.createDefaultView():this.depthTexture.createView(),depthLoadValue:this.clearDepthValue,depthStoreOp:Se.StoreOp.Store,stencilLoadValue:this.clearStencilValue,stencilStoreOp:Se.StoreOp.Store}}},{key:"startComputePass",value:function(){this.currentComputePass&&this.endComputePass(),this.currentComputePass=this.computeEncoder.beginComputePass()}},{key:"startMainRenderPass",value:function(){this.currentRenderPass&&!this.currentRenderTarget&&this.endMainRenderPass(),this.options.antialiasing?this.mainColorAttachments[0].resolveTarget=Wt.isSafari?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView():this.mainColorAttachments[0].attachment=Wt.isSafari?this.swapChain.getCurrentTexture().createDefaultView():this.swapChain.getCurrentTexture().createView(),this.currentRenderPass=this.renderEncoder.beginRenderPass({colorAttachments:this.mainColorAttachments,depthStencilAttachment:this.mainDepthAttachment}),this.mainRenderPass=this.currentRenderPass,this.cachedViewport&&this.viewport(this.cachedViewport)}},{key:"startRenderTargetRenderPass",value:function(t,e,n){var r,i,o,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=null===(r=t.get().color)||void 0===r?void 0:r.texture;u&&(o=u.createView(this.currentRenderTargetViewDescriptor));var s,c=null===(i=t.get().depth)||void 0===i?void 0:i.texture;c&&(s=c.createView());var f=this.renderTargetEncoder.beginRenderPass({colorAttachments:[{attachment:o,loadValue:null!==e?e:Se.LoadOp.Load,storeOp:Se.StoreOp.Store}],depthStencilAttachment:c&&s?{attachment:s,depthLoadValue:n?this.clearDepthValue:Se.LoadOp.Load,depthStoreOp:Se.StoreOp.Store,stencilLoadValue:a?this.clearStencilValue:Se.LoadOp.Load,stencilStoreOp:Se.StoreOp.Store}:void 0});this.currentRenderPass=f,this.cachedViewport&&this.viewport(this.cachedViewport)}},{key:"endMainRenderPass",value:function(){this.currentRenderPass===this.mainRenderPass&&null!==this.currentRenderPass&&(this.currentRenderPass.endPass(),this.resetCachedViewport(),this.currentRenderPass=null,this.mainRenderPass=null)}},{key:"endComputePass",value:function(){this.currentComputePass&&(this.currentComputePass.endPass(),this.currentComputePass=null)}},{key:"endRenderTargetRenderPass",value:function(){this.currentRenderPass&&(this.currentRenderPass.endPass(),this.resetCachedViewport())}},{key:"resetCachedViewport",value:function(){this.cachedViewport={x:0,y:0,width:0,height:0}}},{key:"unbindFramebuffer",value:function(t){this.currentRenderPass&&this.currentRenderPass!==this.mainRenderPass&&this.endRenderTargetRenderPass(),this.transientViewport.x=1/0,this.currentRenderTarget=null,this.currentRenderPass=this.mainRenderPass}}]),t}(),Wr=qr))||Wr,Zr=n(948),Jr=n.n(Zr),$r=n(616),ti=n.n($r),ei=n(617),ni=n.n(ei),ri=n(618),ii=n.n(ri);function oi(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ii()(t);if(e){var i=ii()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ni()(this,n)}}var ai,ui=4/64,si=Object(Xt.injectable)()(Xr=function(t){ti()(n,t);var e=oi(n);function n(){return Ut()(this,n),e.apply(this,arguments)}return Vt()(n,[{key:"onEntityCreated",value:function(){var t=this.config,e=t.widthSegments,n=void 0===e?1:e,r=t.heightSegments,i=void 0===r?1:r,o=t.depthSegments,a=void 0===o?1:o,u=t.halfExtents,s=void 0===u?qt.e.fromValues(.5,.5,.5):u,c=n,f=i,l=a,h=Jr()(s,3),d=h[0],p=h[1],m=h[2],v=[qt.e.fromValues(-d,-p,m),qt.e.fromValues(d,-p,m),qt.e.fromValues(d,p,m),qt.e.fromValues(-d,p,m),qt.e.fromValues(d,-p,-m),qt.e.fromValues(-d,-p,-m),qt.e.fromValues(-d,p,-m),qt.e.fromValues(d,p,-m)],g=[[0,1,3],[4,5,7],[3,2,6],[1,0,4],[1,4,2],[5,0,6]],y=[[0,0,1],[0,0,-1],[0,1,0],[0,-1,0],[1,0,0],[-1,0,0]],b=1,E=2,_=3,w=4,x=5,T=[],S=[],A=[],O=[],R=[],C=0,M=function(t,e,n){var r,i,o,a;for(o=0;o<=e;o++)for(a=0;a<=n;a++){var u=qt.e.create(),s=qt.e.create(),c=qt.e.create(),f=qt.e.create();qt.e.lerp(u,v[g[t][0]],v[g[t][1]],o/e),qt.e.lerp(s,v[g[t][0]],v[g[t][2]],a/n),qt.e.sub(c,s,v[g[t][0]]),qt.e.add(f,u,c),r=o/e,i=a/n,T.push(f[0],f[1],f[2]),S.push(y[t][0],y[t][1],y[t][2]),A.push(r,i),r=.875*(r/=3)+ui,i=.875*(i/=3)+ui,r+=t%3/3,i+=Math.floor(t/3)/3,O.push(r,i),o<e&&a<n&&(R.push(C+n+1,C+1,C),R.push(C+n+1,C+n+2,C+1)),C++}};M(0,c,f),M(b,c,f),M(E,c,l),M(_,c,l),M(w,l,f),M(x,l,f);var I=Object(Wt.generateAABBFromVertices)(T),N=this.getComponent();N.indices=Uint32Array.from(R),N.aabb=I,N.vertexCount=C,N.attributes=[{dirty:!0,name:"position",data:Float32Array.from(T),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(S),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(A),arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),n}(ye))||Xr;function ci(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ii()(t);if(e){var i=ii()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ni()(this,n)}}var fi,li=Object(Xt.injectable)()(ai=function(t){ti()(n,t);var e=ci(n);function n(){return Ut()(this,n),e.apply(this,arguments)}return Vt()(n,[{key:"onEntityCreated",value:function(){var t=this.config.geometries,e=void 0===t?[]:t,n=this.getComponent();n.aabb=new Wt.AABB;var r=[],i=[],o=0;e.forEach((function(t){var e=t.aabb,a=t.indices,u=t.vertexCount,s=t.attributes;n.aabb.add(e),n.vertexCount+=u,a&&i.push.apply(i,Kn()(a.map((function(t){return t+o})))),o+=u,s.forEach((function(t,e){r[e]?t.data&&(Yt(t.data)?r[e].push(t.data):Ve(t.data)?r[e].data=function(t,e){if(!t&&!e)throw new Error("Please specify valid arguments for parameters a and b.");if(!e||0===e.length)return t;if(!t||0===t.length)return e;if(Object.prototype.toString.call(t)!==Object.prototype.toString.call(e))throw new Error("The types of the two arguments passed for parameters a and b do not match.");var n=new t.constructor(t.length+e.length);return n.set(t),n.set(e,t.length),n}(r[e].data,t.data):r[e].data=r[e].data.concat(t.data)):(r[e]=t,r[e].dirty=!0)}))})),n.attributes=r,n.indices=Uint32Array.from(i),n.dirty=!0}}]),n}(ye))||ai;function hi(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ii()(t);if(e){var i=ii()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ni()(this,n)}}var di,pi=Object(Xt.injectable)()(fi=function(t){ti()(n,t);var e=hi(n);function n(){return Ut()(this,n),e.apply(this,arguments)}return Vt()(n,[{key:"onEntityCreated",value:function(){for(var t=this.config,e=t.halfExtents,n=void 0===e?[.5,.5]:e,r=t.widthSegments,i=void 0===r?5:r,o=t.lengthSegments,a=void 0===o?5:o,u=[],s=[],c=[],f=[],l=0,h=0;h<=i;h++)for(var d=0;d<=a;d++){var p=-n[0]+2*n[0]*h/i,m=-(-n[1]+2*n[1]*d/a),v=h/i,g=d/a;u.push(p,0,m),s.push(0,1,0),c.push(v,g),h<i&&d<a&&(f.push(l+a+1,l+1,l),f.push(l+a+1,l+a+2,l+1)),l++}var y=Object(Wt.generateAABBFromVertices)(u),b=this.getComponent();b.indices=Uint32Array.from(f),b.aabb=y,b.vertexCount=l,b.attributes=[{dirty:!0,name:"position",data:Float32Array.from(u),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(s),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(c),arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),n}(ye))||fi;function mi(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ii()(t);if(e){var i=ii()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ni()(this,n)}}var vi,gi,yi,bi,Ei,_i,wi,xi,Ti=Object(Xt.injectable)()(di=function(t){ti()(n,t);var e=mi(n);function n(){return Ut()(this,n),e.apply(this,arguments)}return Vt()(n,[{key:"onEntityCreated",value:function(){for(var t=this.config,e=t.radius,n=void 0===e?.5:e,r=t.latitudeBands,i=void 0===r?16:r,o=t.longitudeBands,a=void 0===o?16:o,u=[],s=[],c=[],f=[],l=0;l<=i;l++)for(var h=l*Math.PI/i,d=Math.sin(h),p=Math.cos(h),m=0;m<=a;m++){var v=2*m*Math.PI/a-Math.PI/2,g=Math.sin(v),y=Math.cos(v)*d,b=p,E=g*d,_=1-m/a,w=1-l/i;u.push(y*n,b*n,E*n),s.push(y,b,E),c.push(_,w)}for(var x=0;x<i;++x)for(var T=0;T<a;++T){var S=x*(a+1)+T,A=S+a+1;f.push(S+1,A,S),f.push(S+1,A+1,A)}var O=Object(Wt.generateAABBFromVertices)(u),R=this.getComponent();R.indices=Uint32Array.from(f),R.aabb=O,R.vertexCount=u.length/3,R.attributes=[{dirty:!0,name:"position",data:Float32Array.from(u),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float3"}]},{dirty:!0,name:"normal",data:Float32Array.from(s),arrayStride:12,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float3"}]},{dirty:!0,name:"uv",data:Float32Array.from(c),arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float2"}]}]}}]),n}(ye))||di,Si=n(691),Ai=n.n(Si);function Oi(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ii()(t);if(e){var i=ii()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ni()(this,n)}}var Ri,Ci,Mi,Ii,Ni,ki,Pi,ji,Di,Li,Bi,Fi,Ui=(vi=Object(Xt.injectable)(),gi=Object(Xt.inject)(Wt.IDENTIFIER.RenderEngine),yi=Object(Xt.inject)(Wt.IDENTIFIER.ShaderModuleService),vi((xi=function(t){ti()(n,t);var e=Oi(n);function n(){var t;Ut()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),Bt()(t,"engine",_i,Ai()(t)),Bt()(t,"shaderModuleService",wi,Ai()(t)),t}return Vt()(n,[{key:"onEntityCreated",value:function(){var t=this.getComponent(),e=this.engine.supportWebGPU?"layout(set = 0, binding = 0) uniform Uniforms {\n  vec4 color;\n  mat4 projectionMatrix;\n  mat4 modelViewMatrix;\n} uniforms;\n\nlayout(location = 0) in vec3 position;\n// layout(location = 1) in vec3 barycentric;\n\nlayout(location = 0) out vec4 fragColor;\n// layout(location = 1) out vec3 v_Barycentric;\n\nvoid main() {\n  gl_Position = uniforms.projectionMatrix * uniforms.modelViewMatrix * vec4(position, 1.0);\n  fragColor = uniforms.color;\n  // v_Barycentric = barycentric;\n}":'attribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform vec4 color;\n\nvarying vec4 fragColor;\n\n#pragma include "uv.vert.declaration"\n\nvoid main() {\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n  fragColor = color;\n\n  #pragma include "uv.vert.main"\n}',n=this.engine.supportWebGPU?"// layout(set = 0, binding = 1) uniform WireframeUniforms {\n//   float lineWidth;\n//   vec4 lineColor;\n// } wireframe;\n\nlayout(location = 0) in vec4 fragColor;\n// layout(location = 1) in vec3 v_Barycentric;\n\nlayout(location = 0) out vec4 outColor;\n\n// wireframe\n// float edgeFactor() {\n//   vec3 d = fwidth(v_Barycentric);\n//   vec3 a3 = smoothstep(vec3(0.0), d * wireframe.lineWidth, v_Barycentric);\n//   return min(min(a3.x, a3.y), a3.z);\n// }\n\nvoid main() {\n  // outColor = mix(fragColor, wireframe.lineColor, (1.0 - edgeFactor()));\n  outColor = fragColor;\n}":'varying vec4 fragColor;\n\n#pragma include "uv.frag.declaration"\n#pragma include "map.frag.declaration"\n\nvoid main() {\n  vec4 diffuseColor = fragColor;\n\n  #pragma include "map.frag.main"\n\n  gl_FragColor = diffuseColor;\n}';this.shaderModuleService.registerModule("material-basic",{vs:e,fs:n});var r=this.shaderModuleService.getModule("material-basic"),i=r.vs,o=r.fs,a=r.uniforms;t.vertexShaderGLSL=i,t.fragmentShaderGLSL=o,t.setUniform(a),this.config.map&&(t.setDefines({USE_UV:1,USE_MAP:1}),t.setUniform({map:this.config.map,uvTransform:qt.a.create()}))}}]),n}(Rn),Ei=xi,_i=Ht()(Ei.prototype,"engine",[gi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wi=Ht()(Ei.prototype,"shaderModuleService",[yi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bi=Ei))||bi);function Gi(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ii()(t);if(e){var i=ii()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ni()(this,n)}}var Vi=(Ri=Object(Xt.injectable)(),Ci=Object(Xt.inject)(Wt.IDENTIFIER.Systems),Mi=Object(Xt.named)(Wt.IDENTIFIER.MaterialSystem),Ii=Object(Xt.inject)(Wt.IDENTIFIER.Systems),Ni=Object(Xt.named)(Wt.IDENTIFIER.GeometrySystem),ki=Object(Xt.inject)(Wt.IDENTIFIER.ShaderModuleService),Ri((Fi=function(t){ti()(n,t);var e=Gi(n);function n(){var t;Ut()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),Bt()(t,"materialSystem",Di,Ai()(t)),Bt()(t,"geometrySystem",Li,Ai()(t)),Bt()(t,"shaderModuleService",Bi,Ai()(t)),t}return Vt()(n,[{key:"onAttributeChanged",value:function(t){var e=t.name,n=t.data,r=this.getMeshComponent();r&&r.material&&("gridColor"===e?(r.material.setUniform("u_GridColor",n),r.material.setUniform("u_GridColor2",n)):"gridSize"===e&&(r.material.setUniform("u_GridSize",n),r.material.setUniform("u_GridSize2",n)))}},{key:"onEntityCreated",value:function(){this.shaderModuleService.registerModule("grid",{vs:"attribute vec3 a_Position;\n\nvarying vec3 v_Position;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n\nvoid main() {\n  v_Position = a_Position;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_Position, 1.);\n}",fs:"// generate grid, borrow from clay.gl viewer\n// @see https://github.com/pissang/clay-viewer/blob/master/src/graphic/ground.glsl\n#extension GL_OES_standard_derivatives : enable\n\nvarying vec3 v_Position;\n// varying vec3 v_Normal;\n\nuniform float u_GridSize : 5;\nuniform float u_GridSize2 : .5;\nuniform vec4 u_GridColor : [0, 0, 0, 1];\nuniform vec4 u_GridColor2 : [0.3, 0.3, 0.3, 1];\nuniform bool u_GridEnabled : true;\n\n// uniform vec3 u_LightDirection;\n// uniform vec3 u_LightColor;\n// uniform vec3 u_Camera;\n\nvoid main() {\n  // vec3 n = v_Normal;\n  // vec3 l = normalize(u_LightDirection);\n  // float NdotL = clamp(dot(n, l), 0.001, 1.0);\n\n  gl_FragColor = vec4(1.);\n\n  if (u_GridEnabled) {\n    float wx = v_Position.x;\n    float wz = v_Position.z;\n    // float x0 = abs(fract(wx / u_GridSize - 0.5) - 0.5) / fwidth(wx) * u_GridSize / 2.0;\n    // float z0 = abs(fract(wz / u_GridSize - 0.5) - 0.5) / fwidth(wz) * u_GridSize / 2.0;\n\n    float x1 = abs(fract(wx / u_GridSize2 - 0.5) - 0.5) / fwidth(wx) * u_GridSize2;\n    float z1 = abs(fract(wz / u_GridSize2 - 0.5) - 0.5) / fwidth(wz) * u_GridSize2;\n\n    // float v0 = 1.0 - clamp(min(x0, z0), 0.0, 1.0);\n    float v1 = 1.0 - clamp(min(x1, z1), 0.0, 1.0);\n    // if (v0 > 0.1) {\n        // gl_FragColor = mix(gl_FragColor, u_GridColor, v0);\n    // }\n    // else {\n        gl_FragColor = mix(gl_FragColor, u_GridColor2, v1);\n    // }\n  }\n\n  // float shadowFactor = calcShadow(u_ShadowMap, v_PositionFromLight, l, n);\n  // vec3 diffuseColor = u_LightColor * NdotL * shadowFactor;\n\n  // gl_FragColor.rgb *= diffuseColor;\n}"});var t=this.shaderModuleService.getModule("grid"),e=t.vs,n=t.fs,r=t.uniforms,i=this.materialSystem.createShaderMaterial({vertexShader:e,fragmentShader:n});this.setMaterial(i);var o=this.geometrySystem.createBufferGeometry({vertexCount:4});this.setGeometry(o),i.setCull({enable:!1,face:Wt.gl.BACK}).setDepth({enable:!0,func:Wt.gl.LESS}),i.setUniform(r),this.setAttributes({gridColor:this.config.gridColor,gridSize:this.config.gridSize}),o.setIndex([0,3,2,2,1,0]),o.setAttribute("a_Position",Float32Array.from([-4,-1,-4,4,-1,-4,4,-1,4,-4,-1,4]),{arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]})}}]),n}(Cn),ji=Fi,Di=Ht()(ji.prototype,"materialSystem",[Ci,Mi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Li=Ht()(ji.prototype,"geometrySystem",[Ii,Ni],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bi=Ht()(ji.prototype,"shaderModuleService",[ki],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pi=ji))||Pi),zi=n(2677),Hi=n(2709);function Wi(t,e,n,r,i){qi(e,r,-i),qi(e,r,i),t.push(n),t.push(n)}function qi(t,e,n){t.push([[e[0],e[1]],n])}var Xi,Yi,Ki,Qi,Zi,Ji,$i,to,eo,no,ro,io;function oo(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ii()(t);if(e){var i=ii()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ni()(this,n)}}var ao,uo,so,co,fo,lo,ho,po,mo,vo,go,yo,bo=(Xi=Object(Xt.injectable)(),Yi=Object(Xt.inject)(Wt.IDENTIFIER.Systems),Ki=Object(Xt.named)(Wt.IDENTIFIER.MaterialSystem),Qi=Object(Xt.inject)(Wt.IDENTIFIER.Systems),Zi=Object(Xt.named)(Wt.IDENTIFIER.GeometrySystem),Ji=Object(Xt.inject)(Wt.IDENTIFIER.ShaderModuleService),Xi((io=function(t){ti()(n,t);var e=oo(n);function n(){var t;Ut()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),Bt()(t,"materialSystem",eo,Ai()(t)),Bt()(t,"geometrySystem",no,Ai()(t)),Bt()(t,"shaderModuleService",ro,Ai()(t)),t.vertexCount=void 0,t}return Vt()(n,[{key:"onAttributeChanged",value:function(t){var e=t.name,n=t.data,r=this.getMeshComponent();if(r&&r.material)switch(e){case"dashArray":r.material.setUniform("u_dash_array",n);break;case"dashOffset":r.material.setUniform("u_dash_offset",n);break;case"dashRatio":r.material.setUniform("u_dash_ratio",n);break;case"thickness":r.material.setUniform("u_thickness",n);break;case"color":var i=new Array(this.vertexCount).fill(void 0).map((function(){return n})).reduce((function(t,e){return[].concat(Kn()(t),Kn()(e))}),[]);r.geometry.setAttribute("a_color",Float32Array.from(i),{arrayStride:16,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float4"}]})}}},{key:"onEntityCreated",value:function(){var t=this;this.shaderModuleService.registerModule("line",{vs:"attribute vec2 a_pos;\nattribute vec4 a_color;\nattribute float a_line_miter;\nattribute vec2 a_line_normal;\nattribute float a_counters;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform float u_thickness : 0.02;\nuniform vec2 u_viewport;\n\nvarying vec4 v_color;\nvarying vec2 v_normal;\nvarying float v_counters;\n\nvoid main() {\n  v_color = a_color;\n  v_counters = a_counters;\n\n  vec3 normal = normalize(vec3(a_line_normal, 0.0));\n\n  vec4 offset = vec4(normal * u_thickness / 2.0 * a_line_miter, 0.0);\n\n  v_normal = vec2(normal * sign(a_line_miter));\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(a_pos, 0.0, 1.0) + offset;\n}\n",fs:"uniform float u_dash_array : 0.02;\nuniform float u_dash_offset : 0;\nuniform float u_dash_ratio : 0;\nuniform float u_thickness : 0.02;\n\nvarying vec4 v_color;\nvarying vec2 v_normal;\nvarying float v_counters;\n\nvoid main() {\n    float blur = 1. - smoothstep(0.98, 1., length(v_normal));\n\n    gl_FragColor = v_color;\n    gl_FragColor.a *= blur * ceil(mod(v_counters + u_dash_offset, u_dash_array) - (u_dash_array * u_dash_ratio));\n}"});var e=this.shaderModuleService.getModule("line"),n=e.vs,r=e.fs,i=e.uniforms,o=this.materialSystem.createShaderMaterial({vertexShader:n,fragmentShader:r}),a=function(t,e,n){var r=[0,0],i=[0,0],o=[0,0],a=[0,0],u=-1,s=!1,c=null,f=Object(zi.create)(),l=n||0,h=[],d=[],p=[],m=[0,0];e&&(t=t.slice()).push(t[0]);for(var v=t.length,g=1;g<v;g++){var y=l,b=t[g-1],E=t[g],_=g<t.length-1?t[g+1]:null;if(m.push(g/v,g/v),Object(Hi.direction)(r,E,b),c||(c=[0,0],Object(Hi.normal)(c,r)),s||(s=!0,Wi(d,h,b,c,1)),p.push([y+0,y+1,y+2]),_){Object(Hi.direction)(i,_,E);var w=Object(Hi.computeMiter)(o,a,r,i,1),x=Object(zi.dot)(o,c)<0?-1:1,T=w>3;if(!isFinite(w)){Object(Hi.normal)(c,r),Wi(d,h,E,c,1),p.push(1===u?[y,y+2,y+3]:[y+2,y+1,y+3]),l+=2,u=x;continue}T?(w=3,m.push(g/v),qi(h,c,-x),d.push(E),qi(h,a,w*x),d.push(E),p.push(u!==-x?[y,y+2,y+3]:[y+2,y+1,y+3]),p.push([y+2,y+3,y+4]),Object(Hi.normal)(f,i),Object(zi.copy)(c,f),qi(h,c,-x),d.push(E),l+=3):(Wi(d,h,E,a,w),p.push(1===u?[y,y+2,y+3]:[y+2,y+1,y+3]),x=-1,Object(zi.copy)(c,a),l+=2),u=x}else Object(Hi.normal)(c,r),Wi(d,h,E,c,1),p.push(1===u?[y,y+2,y+3]:[y+2,y+1,y+3]),l+=2}return{normals:h,attrIndex:p,attrPos:d,attrCounters:m}}(this.config.points,!1),u=a.normals,s=a.attrIndex,c=a.attrPos,f=a.attrCounters,l=c.length;this.vertexCount=l;var h=this.geometrySystem.createBufferGeometry({vertexCount:l});this.setMaterial(o),this.setGeometry(h),o.setCull({enable:!1,face:Wt.gl.BACK}).setUniform(i),this.setAttributes({dashArray:this.config.dashArray,dashOffset:this.config.dashOffset,dashRatio:this.config.dashRatio,thickness:this.config.thickness});var d=[],p=[];u.forEach((function(t){var e=t[0],n=t[1];d.push([e[0],e[1]]),p.push(n)})),h.setIndex(s.reduce((function(t,e){return[].concat(Kn()(t),Kn()(e))}),[])),h.setAttribute("a_pos",Float32Array.from(c.reduce((function(t,e){return[].concat(Kn()(t),Kn()(e))}),[])),{arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]});var m=new Array(l).fill(void 0).map((function(){return Kn()(t.config.color)})).reduce((function(t,e){return[].concat(Kn()(t),Kn()(e))}),[]);h.setAttribute("a_color",Float32Array.from(m),{arrayStride:16,stepMode:"vertex",attributes:[{shaderLocation:1,offset:0,format:"float4"}]}),h.setAttribute("a_line_miter",Float32Array.from(p),{arrayStride:4,stepMode:"vertex",attributes:[{shaderLocation:2,offset:0,format:"float"}]}),h.setAttribute("a_line_normal",Float32Array.from(d.reduce((function(t,e){return[].concat(Kn()(t),Kn()(e))}),[])),{arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:3,offset:0,format:"float2"}]}),h.setAttribute("a_counters",Float32Array.from(f),{arrayStride:4,stepMode:"vertex",attributes:[{shaderLocation:4,offset:0,format:"float"}]})}}]),n}(Cn),to=io,eo=Ht()(to.prototype,"materialSystem",[Yi,Ki],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),no=Ht()(to.prototype,"geometrySystem",[Qi,Zi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ro=Ht()(to.prototype,"shaderModuleService",[Ji],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$i=to))||$i);function Eo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _o(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ii()(t);if(e){var i=ii()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ni()(this,n)}}var wo,xo,To,So,Ao,Oo,Ro,Co,Mo,Io,No=["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],ko=(ao=Object(Xt.injectable)(),uo=Object(Xt.inject)(Wt.IDENTIFIER.Systems),so=Object(Xt.named)(Wt.IDENTIFIER.MaterialSystem),co=Object(Xt.inject)(Wt.IDENTIFIER.Systems),fo=Object(Xt.named)(Wt.IDENTIFIER.GeometrySystem),lo=Object(Xt.inject)(Wt.IDENTIFIER.ShaderModuleService),ao((yo=function(t){ti()(n,t);var e=_o(n);function n(){var t;Ut()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),Bt()(t,"materialSystem",mo,Ai()(t)),Bt()(t,"geometrySystem",vo,Ai()(t)),Bt()(t,"shaderModuleService",go,Ai()(t)),t}return Vt()(n,[{key:"onAttributeChanged",value:function(t){var e=t.name,n=t.data,r=this.getMeshComponent();r&&r.material&&("strokeWidth"===e?r.material.setUniform("u_stroke_width",n):"strokeColor"===e?r.material.setUniform("u_stroke_color",n):"strokeOpacity"===e?r.material.setUniform("u_stroke_opacity",n):"opacity"===e?r.material.setUniform("u_opacity",n):"blur"===e&&r.material.setUniform("u_blur",n))}},{key:"onEntityCreated",value:function(){this.shaderModuleService.registerModule("grid",{vs:'attribute vec2 position;\nattribute vec4 color;\nattribute float shape;\nattribute vec2 offset;\nattribute float size;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\n\nuniform float u_stroke_width : 0.01;\nuniform float u_device_pixel_ratio;\nuniform vec2 u_viewport;\n\nvarying vec4 v_color;\nvarying vec4 v_data;\nvarying float v_radius;\n\n#pragma include "picking"\n\nvoid main() {\n  v_color = color;\n  v_radius = size;\n\n  lowp float antialiasblur = 1.0 / u_device_pixel_ratio * (size + u_stroke_width);\n\n  // construct point coords\n  v_data = vec4(position, antialiasblur, shape);\n\n  gl_Position = projectionMatrix * modelViewMatrix\n    * vec4(position * size + offset, 0.0, 1.0);\n\n  setPickingColor(a_PickingColor);\n}',fs:"uniform float u_blur : 0.05;\nuniform float u_opacity : 0.7;\nuniform float u_stroke_width : 0.01;\nuniform vec4 u_stroke_color : [0, 0, 0, 0];\nuniform float u_stroke_opacity : 1;\n\nvarying vec4 v_color;\nvarying vec4 v_data;\nvarying float v_radius;\n\n#pragma include \"sdf2d\"\n#pragma include \"picking\"\n\nvoid main() {\n  int shape = int(floor(v_data.w + 0.5));\n\n  float antialiasblur = v_data.z;\n  float antialiased_blur = -max(u_blur, antialiasblur);\n  float r = v_radius / (v_radius + u_stroke_width);\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'\n  // if (shape == 0) {\n    outer_df = sdCircle(v_data.xy, 1.0);\n    inner_df = sdCircle(v_data.xy, r);\n  // } else if (shape == 1) {\n  //   outer_df = sdEquilateralTriangle(1.1 * v_data.xy);\n  //   inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);\n  // } else if (shape == 2) {\n  //   outer_df = sdBox(v_data.xy, vec2(1.));\n  //   inner_df = sdBox(v_data.xy, vec2(r));\n  // } else if (shape == 3) {\n  //   outer_df = sdPentagon(v_data.xy, 0.8);\n  //   inner_df = sdPentagon(v_data.xy, r * 0.8);\n  // } else if (shape == 4) {\n  //   outer_df = sdHexagon(v_data.xy, 0.8);\n  //   inner_df = sdHexagon(v_data.xy, r * 0.8);\n  // } else if (shape == 5) {\n  //   outer_df = sdOctogon(v_data.xy, 1.0);\n  //   inner_df = sdOctogon(v_data.xy, r);\n  // } else if (shape == 6) {\n  //   outer_df = sdHexagram(v_data.xy, 0.52);\n  //   inner_df = sdHexagram(v_data.xy, r * 0.52);\n  // } else if (shape == 7) {\n  //   outer_df = sdRhombus(v_data.xy, vec2(1.0));\n  //   inner_df = sdRhombus(v_data.xy, vec2(r));\n  // } else if (shape == 8) {\n  //   outer_df = sdVesica(v_data.xy, 1.1, 0.8);\n  //   inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);\n  // }\n\n  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);\n\n  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(\n    antialiased_blur,\n    0.0,\n    inner_df\n  );\n  vec4 strokeColor = u_stroke_color == vec4(0) ? v_color : u_stroke_color;\n\n  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);\n  gl_FragColor.a = gl_FragColor.a * opacity_t;\n\n  gl_FragColor = filterColor(gl_FragColor);\n}"});var t=this.shaderModuleService.getModule("grid"),e=t.vs,n=t.fs,r=t.uniforms,i=this.materialSystem.createShaderMaterial({vertexShader:e,fragmentShader:n,cull:{enable:!1},depth:{enable:!1},blend:{enable:!0,func:{srcRGB:Wt.gl.SRC_ALPHA,dstRGB:Wt.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}});i.setUniform(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Eo(Object(n),!0).forEach((function(e){Te()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Eo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({u_device_pixel_ratio:window.devicePixelRatio},r));var o=this.buildAttributes(),a=this.geometrySystem.createInstancedBufferGeometry({maxInstancedCount:o.instancedOffsets.length/2,vertexCount:6});a.setIndex([0,2,1,0,3,2]),a.setAttribute("position",Float32Array.from(o.positions),{arrayStride:8,stepMode:"vertex",attributes:[{shaderLocation:0,offset:0,format:"float2"}]}),a.setAttribute("offset",Float32Array.from(o.instancedOffsets),{arrayStride:8,stepMode:"instance",attributes:[{shaderLocation:1,offset:0,format:"float2"}]}),a.setAttribute("color",Float32Array.from(o.instancedColors),{arrayStride:16,stepMode:"instance",attributes:[{shaderLocation:2,offset:0,format:"float4"}]}),a.setAttribute("size",Float32Array.from(o.instancedSizes),{arrayStride:4,stepMode:"instance",attributes:[{shaderLocation:3,offset:0,format:"float"}]}),a.setAttribute("shape",Float32Array.from(o.instancedShapes),{arrayStride:4,stepMode:"instance",attributes:[{shaderLocation:4,offset:0,format:"float"}]}),a.setAttribute("a_PickingColor",Float32Array.from(o.instancedPickingColors),{arrayStride:12,stepMode:"instance",attributes:[{shaderLocation:6,offset:0,format:"float3"}]}),this.setMaterial(i),this.setGeometry(a)}},{key:"buildAttribute",value:function(t,e,n){var r,i,o,a,u;(r=e.instancedPickingColors).push.apply(r,Kn()([(u=t.id||n)+1&255,u+1>>8&255,u+1>>8>>8&255])),e.instancedShapes.push(No.indexOf(t.shape||"circle")),(i=e.instancedColors).push.apply(i,Kn()(t.color||[1,0,0,1])),(o=e.instancedOffsets).push.apply(o,Kn()(t.position||[0,0])),(a=e.instancedSizes).push.apply(a,Kn()(t.size||[.2,.2]))}},{key:"buildAttributes",value:function(){var t=this,e={positions:[1,1,1,-1,-1,-1,-1,1],instancedOffsets:[],instancedColors:[],instancedSizes:[],instancedShapes:[],instancedPickingColors:[]};return Array.isArray(this.config)?this.config.forEach((function(n,r){t.buildAttribute(n,e,r)})):this.buildAttribute(this.config,e,0),e}}]),n}(Cn),po=yo,mo=Ht()(po.prototype,"materialSystem",[uo,so],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vo=Ht()(po.prototype,"geometrySystem",[co,fo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),go=Ht()(po.prototype,"shaderModuleService",[lo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ho=po))||ho);function Po(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return jo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jo(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function jo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Do,Lo,Bo,Fo,Uo,Go,Vo,zo,Ho,Wo,qo=(wo=Object(Xt.injectable)(),xo=Object(Xt.inject)(Wt.IDENTIFIER.RenderEngine),To=Object(Xt.inject)(Wt.IDENTIFIER.ShaderModuleService),So=Object(Xt.inject)(Wt.IDENTIFIER.ConfigService),wo((Io=function(){function t(){Ut()(this,t),this.container=void 0,Bt()(this,"engine",Ro,this),Bt()(this,"shaderModule",Co,this),Bt()(this,"configService",Mo,this),this.inited=!1,this.rendering=!1,this.pendings=[],this.views=[],this.size=void 0}return Vt()(t,[{key:"init",value:function(){var t=we()(Ee.a.mark((function t(){var e,n,r,i,o;return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.shaderModule.registerBuiltinModules(),this.shaderModule.registerModule("uv.vert.declaration",{vs:"#ifdef USE_UV\n  attribute vec2 uv;\n\t#ifdef UVS_VERTEX_ONLY\n    vec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif"}),this.shaderModule.registerModule("uv.vert.main",{vs:"#ifdef USE_UV\n  vUv = (uvTransform * vec3(uv, 1)).xy;\n#endif"}),this.shaderModule.registerModule("uv.frag.declaration",{fs:"#if (defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ))\n  varying vec2 vUv;\n#endif"}),this.shaderModule.registerModule("map.frag.declaration",{fs:"#ifdef USE_MAP\n  uniform sampler2D map;\n#endif"}),this.shaderModule.registerModule("map.frag.main",{fs:"#ifdef USE_MAP\n  vec4 texelColor = texture2D(map, vUv);\n  // texelColor = mapTexelToLinear(texelColor);\n  diffuseColor *= texelColor;\n#endif"}),e=this.container.getAll(Wt.IDENTIFIER.Systems),!(n=this.configService.get()).canvas){t.next=30;break}return t.next=11,this.engine.init({canvas:n.canvas,swapChainFormat:Se.TextureFormat.BGRA8Unorm,antialiasing:!1});case 11:r=Po(e),t.prev=12,r.s();case 14:if((i=r.n()).done){t.next=21;break}if(!(o=i.value).initialize){t.next=19;break}return t.next=19,o.initialize();case 19:t.next=14;break;case 21:t.next=26;break;case 23:t.prev=23,t.t0=t.catch(12),r.e(t.t0);case 26:return t.prev=26,r.f(),t.finish(26);case 29:this.inited=!0;case 30:case"end":return t.stop()}}),t,this,[[12,23,26,29]])})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=we()(Ee.a.mark((function t(){var e,n,r,i,o,a,u,s=arguments;return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.inited&&!this.rendering){t.next=2;break}return t.abrupt("return");case 2:for(this.pendings.length&&this.pendings.forEach((function(t){t()})),this.rendering=!0,this.engine.beginFrame(),e=this.container.getAll(Wt.IDENTIFIER.Systems),n=s.length,r=new Array(n),i=0;i<n;i++)r[i]=s[i];o=Po(e),t.prev=8,o.s();case 10:if((a=o.n()).done){t.next=17;break}if(!(u=a.value).execute){t.next=15;break}return t.next=15,u.execute(r);case 15:t.next=10;break;case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(8),o.e(t.t0);case 22:return t.prev=22,o.f(),t.finish(22);case 25:this.engine.endFrame(),this.rendering=!1;case 27:case"end":return t.stop()}}),t,this,[[8,19,22,25]])})));return function(){return t.apply(this,arguments)}}()},{key:"clear",value:function(t){var e=this;return this.inited?this.engine.clear(t):this.pendings.unshift((function(){e.engine.clear(t),e.pendings.shift()})),this}},{key:"setSize",value:function(t){var e=t.width,n=t.height,r=this.engine.getCanvas();return this.size={width:e,height:n},r.width=e,r.height=n,this}},{key:"getSize",value:function(){return this.size}}]),t}(),Oo=Io,Ro=Ht()(Oo.prototype,"engine",[xo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Co=Ht()(Oo.prototype,"shaderModule",[To],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mo=Ht()(Oo.prototype,"configService",[So],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ao=Oo))||Ao),Xo=Object(Xt.injectable)()(Do=function(){function t(){Ut()(this,t),this.entities=[]}return Vt()(t,[{key:"getEntities",value:function(){return this.entities}},{key:"addRenderable",value:function(t){return this.addEntity(t.getEntity()),this}},{key:"removeRenderable",value:function(t){return this.removeEntity(t.getEntity()),this}},{key:"addLight",value:function(){}},{key:"addEntity",value:function(t){return-1===this.entities.indexOf(t)&&this.entities.push(t),this}},{key:"removeEntity",value:function(t){var e=this.entities.indexOf(t);return this.entities.splice(e,1),this}}]),t}())||Do,Yo=Object(Xt.injectable)()(Lo=function(){function t(){Ut()(this,t),this.cache={}}return Vt()(t,[{key:"get",value:function(t){return this.cache[t]}},{key:"set",value:function(t,e){this.cache[t]=e}}]),t}())||Lo;function Ko(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Qo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ko(Object(n),!0).forEach((function(e){Te()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ko(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Zo,Jo,$o,ta,ea,na,ra,ia,oa,aa,ua,sa,ca=(Bo=Object(Xt.injectable)(),Fo=Object(Xt.inject)(Yo),Uo=Object(Xt.inject)(Wt.IDENTIFIER.RenderEngine),Bo((Wo=function(){function t(){Ut()(this,t),Bt()(this,"textureCache",zo,this),Bt()(this,"engine",Ho,this),this.config=void 0,this.loaded=!1,this.texture=void 0}return Vt()(t,[{key:"setConfig",value:function(t){this.config=t}},{key:"isLoaded",value:function(){return this.loaded}},{key:"load",value:function(){var t=we()(Ee.a.mark((function t(){var e=this;return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.config.url){t.next=4;break}return t.abrupt("return",new Promise((function(t,n){var r=e.textureCache.get(e.config.url);if(r)t(r);else{var i=new Image;i.crossOrigin="Anonymous",i.src=e.config.url,i.onload=function(){var n=e.engine.createTexture2D(Qo(Qo({},e.config),{},{data:i,width:i.width,height:i.height,flipY:!0}));e.textureCache.set(e.config.url,n),e.texture=n,e.loaded=!0,t(n)},i.onerror=function(){n()}}})));case 4:return this.loaded=!0,this.texture=this.engine.createTexture2D(this.config),t.abrupt("return",this.texture);case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}(),Vo=Wo,zo=Ht()(Vo.prototype,"textureCache",[Fo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ho=Ht()(Vo.prototype,"engine",[Uo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Go=Vo))||Go),fa=(Zo=Object(Xt.injectable)(),Jo=Object(Xt.inject)(Wt.IDENTIFIER.Systems),$o=Object(Xt.named)(Wt.IDENTIFIER.RendererSystem),Zo((ea=function(){function t(){Ut()(this,t),Bt()(this,"rendererSystem",na,this),this.camera=void 0,this.scene=void 0,this.viewport={x:0,y:0,width:0,height:0},this.clearColor=[1,1,1,1]}return Vt()(t,[{key:"getCamera",value:function(){return this.camera}},{key:"getScene",value:function(){return this.scene}},{key:"getViewport",value:function(){return this.viewport}},{key:"getClearColor",value:function(){return this.clearColor}},{key:"setCamera",value:function(t){return this.camera=t,this}},{key:"setScene",value:function(t){return this.scene=t,this}},{key:"setViewport",value:function(t){return this.viewport=t,this}},{key:"setClearColor",value:function(t){return this.clearColor=t,this}},{key:"pick",value:function(t){return this.rendererSystem.pick(t,this)}}]),t}(),na=Ht()(ea.prototype,"rendererSystem",[Jo,$o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ta=ea))||ta);function la(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ha(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?la(Object(n),!0).forEach((function(e){Te()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):la(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}ra=Object(Xt.injectable)(),ia=Object(Xt.inject)(Wt.IDENTIFIER.ConfigService),ra((sa=function(){function t(){Ut()(this,t),Bt()(this,"configService",ua,this),this.container=void 0}return Vt()(t,[{key:"getEngine",value:function(){var t=we()(Ee.a.mark((function t(){var e,n,r,i;return Ee.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.container.get(Wt.IDENTIFIER.RenderEngine),n=this.configService.get(),r=n.canvas,i=n.engineOptions,t.next=4,e.init(ha({canvas:r||Ae(),swapChainFormat:Se.TextureFormat.BGRA8Unorm,antialiasing:!1},i));case 4:return t.abrupt("return",e);case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getTransformComponent",value:function(t){return this.container.get(Wt.IDENTIFIER.TransformComponentManager).getComponentByEntity(t)}},{key:"getMeshComponent",value:function(t){return this.container.get(Wt.IDENTIFIER.MeshComponentManager).getComponentByEntity(t)}},{key:"setConfig",value:function(t){this.configService.set(t)}},{key:"setContainer",value:function(t){this.container=t}},{key:"getContainer",value:function(){return this.container}},{key:"createEntity",value:function(){return Object(Wt.createEntity)()}},{key:"createScene",value:function(){return this.container.get(Xo)}},{key:"createCamera",value:function(){return this.container.get(ge)}},{key:"createView",value:function(){return this.container.get(fa)}},{key:"createRenderable",value:function(t,e){var n=t?this.container.getNamed(Wt.IDENTIFIER.Renderable,t):this.container.get(Cn),r=Object(Wt.createEntity)();return n.setConfig(e||{}),n.setEntity(r),n}},{key:"createGeometry",value:function(t,e){var n=this.container.getNamed(Wt.IDENTIFIER.Geometry,t),r=Object(Wt.createEntity)();return n.setConfig(e||{}),n.setEntity(r),n.getComponent()}},{key:"createMaterial",value:function(t,e){var n=this.container.getNamed(Wt.IDENTIFIER.Material,t),r=Object(Wt.createEntity)();return n.setConfig(e||{}),n.setEntity(r,t),n.getComponent()}},{key:"createTexture2D",value:function(t){var e=this.container.get(ca);return e.setConfig(t),e}},{key:"createBufferGeometry",value:function(t){return this.container.getNamed(Wt.IDENTIFIER.Systems,Wt.IDENTIFIER.GeometrySystem).createBufferGeometry(t)}},{key:"createInstancedBufferGeometry",value:function(t){return this.container.getNamed(Wt.IDENTIFIER.Systems,Wt.IDENTIFIER.GeometrySystem).createInstancedBufferGeometry(t)}},{key:"createShaderMaterial",value:function(t){return this.container.getNamed(Wt.IDENTIFIER.Systems,Wt.IDENTIFIER.MaterialSystem).createShaderMaterial(t)}},{key:"createKernel",value:function(t){var e=this.container.get(On);return"string"===typeof t?e.setBundle(JSON.parse(t)):e.setBundle(t),e.init(),e}},{key:"createRenderer",value:function(){var t=this.container.get(qo);return t.container=this.container,t.init(),t}},{key:"destroy",value:function(){this.container.getAll(Wt.IDENTIFIER.Systems).forEach((function(t){t.tearDown&&t.tearDown()})),this.container.get(Wt.IDENTIFIER.RenderEngine).destroy(),this.container.get(Wt.IDENTIFIER.InteractorService).destroy()}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object(Wt.createWorldContainer)(),r=navigator.gpu?Qr:mr;n.isBound(Wt.IDENTIFIER.RenderEngine)||n.bind(Wt.IDENTIFIER.RenderEngine).to(r).inSingletonScope(),n.bind(qo).toSelf(),n.bind(On).toSelf(),n.bind(Cn).toSelf(),n.bind(fa).toSelf(),n.bind(ge).toSelf(),n.bind(Xo).toSelf(),n.bind(t).toSelf(),n.bind(Yo).toSelf(),n.bind(ca).toSelf(),n.bind(Wt.IDENTIFIER.Geometry).to(si).whenTargetNamed(ye.BOX),n.bind(Wt.IDENTIFIER.Geometry).to(Ti).whenTargetNamed(ye.SPHERE),n.bind(Wt.IDENTIFIER.Geometry).to(pi).whenTargetNamed(ye.PLANE),n.bind(Wt.IDENTIFIER.Geometry).to(li).whenTargetNamed(ye.MERGED),n.bind(Wt.IDENTIFIER.Material).to(Ui).whenTargetNamed(Rn.BASIC),n.bind(Wt.IDENTIFIER.Renderable).to(ko).whenTargetNamed(Cn.POINT),n.bind(Wt.IDENTIFIER.Renderable).to(bo).whenTargetNamed(Cn.LINE),n.bind(Wt.IDENTIFIER.Renderable).to(Vi).whenTargetNamed(Cn.GRID);var i=n.get(t);return i.setContainer(n),i.setConfig(e),i}}]),t}(),aa=sa,ua=Ht()(aa.prototype,"configService",[ia],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oa=aa));var da=function(){function t(){Object(r.a)(this,t),this.cells=[],this.columnNum=0,this.rowNum=0,this.additionColumn=[],this.additionRow=[]}return Object(u.a)(t,[{key:"init",value:function(e,n,r){this.cells=[],this.CELL_W=r.CELL_W||t.DEFAULT_CELL_W,this.CELL_H=r.CELL_H||t.DEFAULT_CELL_H,this.columnNum=Math.ceil(e/this.CELL_W),this.rowNum=Math.ceil(n/this.CELL_H),t.MIN_DIST=Math.pow(e,2)+Math.pow(n,2);for(var i=0;i<this.columnNum;i++){for(var o=[],a=0;a<this.rowNum;a++){var u={dx:i,dy:a,x:i*this.CELL_W,y:a*this.CELL_H,occupied:!1};o.push(u)}this.cells.push(o)}}},{key:"findGridByNodeId",value:function(t){for(var e,n,r=0;r<this.columnNum;r++)for(var i=0;i<this.rowNum;i++)if(this.cells[r][i].node&&(null===(n=null===(e=this.cells[r][i])||void 0===e?void 0:e.node)||void 0===n?void 0:n.id)===t)return{column:r,row:i};return null}},{key:"sqdist",value:function(t,e){return Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)}},{key:"occupyNearest",value:function(e){for(var n,r=t.MIN_DIST,i=null,o=0;o<this.columnNum;o++)for(var a=0;a<this.rowNum;a++)!this.cells[o][a].occupied&&(n=this.sqdist(e,this.cells[o][a]))<r&&(r=n,i=this.cells[o][a]);return i&&(i.occupied=!0),i}},{key:"insertColumn",value:function(t,e){if(!(e<=0)){for(var n=0;n<e;n++){this.cells[n+this.columnNum]=[];for(var r=0;r<this.rowNum;r++)this.cells[n+this.columnNum][r]={dx:n,dy:r,x:n*this.CELL_W,y:r*this.CELL_H,occupied:!1,node:null}}for(var i=this.columnNum-1;i>t;i--)for(var o=0;o<this.rowNum;o++)this.cells[i+e][o]=Object.assign(Object.assign({},this.cells[i][o]),{x:(i+e)*this.CELL_W,y:o*this.CELL_H}),this.cells[i][o]={x:i*this.CELL_W,y:o*this.CELL_H,occupied:!0,node:null};for(var a=0;a<this.additionColumn.length;a++)this.additionColumn[a]>=t&&(this.additionColumn[a]+=e);for(var u=0;u<e;u++)this.additionColumn.push(t+u+1);this.columnNum+=e}}},{key:"insertRow",value:function(t,e){if(!(e<=0)){for(var n=0;n<e;n++)for(var r=0;r<this.columnNum;r++)this.cells[r][n+this.rowNum]={dx:r,dy:n,x:r*this.CELL_W,y:n*this.CELL_H,occupied:!1,node:null};for(var i=0;i<this.columnNum;i++)for(var o=this.rowNum-1;o>t;o--)this.cells[i][o+e]=Object.assign(Object.assign({},this.cells[i][o]),{dx:i,dy:o+e,x:i*this.CELL_W,y:(o+e)*this.CELL_H}),this.cells[i][o]={dx:i,dy:o,x:i*this.CELL_W,y:o*this.CELL_H,occupied:!1,node:null};for(var a=0;a<this.additionRow.length;a++)this.additionRow[a]>=t&&(this.additionRow[a]+=e);for(var u=0;u<e;u++)this.additionRow.push(t+u+1);this.rowNum+=e}}},{key:"getNodes",value:function(){for(var t=[],e=0;e<this.columnNum;e++)for(var n=0;n<this.rowNum;n++)this.cells[e][n].node&&t.push(this.cells[e][n]);return t}}]),t}();da.MIN_DIST=50,da.DEFAULT_CELL_W=80,da.DEFAULT_CELL_H=80;new Map},3052:function(t,e,n){"use strict";var r=n(79);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(80)),o=n(0),a=(0,i.default)((0,o.jsx)("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm-7 7H3v4c0 1.1.9 2 2 2h4v-2H5v-4zM5 5h4V3H5c-1.1 0-2 .9-2 2v4h2V5zm14-2h-4v2h4v4h2V5c0-1.1-.9-2-2-2zm0 16h-4v2h4c1.1 0 2-.9 2-2v-4h-2v4z"}),"CenterFocusStrong");e.default=a},3053:function(t,e,n){"use strict";var r=n(79);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(80)),o=n(0),a=(0,i.default)((0,o.jsx)("path",{d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"}),"Undo");e.default=a},3054:function(t,e,n){"use strict";var r=n(79);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(80)),o=n(0),a=(0,i.default)((0,o.jsx)("path",{d:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"}),"Redo");e.default=a},3055:function(t,e,n){"use strict";var r=n(79);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(80)),o=n(0),a=(0,i.default)((0,o.jsx)("path",{d:"M20 10V8h-4V4h-2v4h-4V4H8v4H4v2h4v4H4v2h4v4h2v-4h4v4h2v-4h4v-2h-4v-4h4zm-6 4h-4v-4h4v4z"}),"Grid3x3");e.default=a},3572:function(t,e,n){"use strict";var r=n(79);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(80)),o=n(0),a=(0,i.default)((0,o.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-4.86 8.86-3 3.87L9 13.14 6 17h12l-3.86-5.14z"}),"ImageOutlined");e.default=a},530:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.multiBindToService=e.getServiceIdentifierAsString=e.typeConstraint=e.namedConstraint=e.taggedConstraint=e.traverseAncerstors=e.decorate=e.id=e.MetadataReader=e.postConstruct=e.targetName=e.multiInject=e.unmanaged=e.optional=e.LazyServiceIdentifer=e.inject=e.named=e.tagged=e.injectable=e.ContainerModule=e.AsyncContainerModule=e.TargetTypeEnum=e.BindingTypeEnum=e.BindingScopeEnum=e.Container=e.METADATA_KEY=void 0;var r=n(601);e.METADATA_KEY=r;var i=n(2647);Object.defineProperty(e,"Container",{enumerable:!0,get:function(){return i.Container}});var o=n(758);Object.defineProperty(e,"BindingScopeEnum",{enumerable:!0,get:function(){return o.BindingScopeEnum}}),Object.defineProperty(e,"BindingTypeEnum",{enumerable:!0,get:function(){return o.BindingTypeEnum}}),Object.defineProperty(e,"TargetTypeEnum",{enumerable:!0,get:function(){return o.TargetTypeEnum}});var a=n(2663);Object.defineProperty(e,"AsyncContainerModule",{enumerable:!0,get:function(){return a.AsyncContainerModule}}),Object.defineProperty(e,"ContainerModule",{enumerable:!0,get:function(){return a.ContainerModule}});var u=n(2664);Object.defineProperty(e,"injectable",{enumerable:!0,get:function(){return u.injectable}});var s=n(2665);Object.defineProperty(e,"tagged",{enumerable:!0,get:function(){return s.tagged}});var c=n(2666);Object.defineProperty(e,"named",{enumerable:!0,get:function(){return c.named}});var f=n(1914);Object.defineProperty(e,"inject",{enumerable:!0,get:function(){return f.inject}}),Object.defineProperty(e,"LazyServiceIdentifer",{enumerable:!0,get:function(){return f.LazyServiceIdentifer}});var l=n(2667);Object.defineProperty(e,"optional",{enumerable:!0,get:function(){return l.optional}});var h=n(2668);Object.defineProperty(e,"unmanaged",{enumerable:!0,get:function(){return h.unmanaged}});var d=n(2669);Object.defineProperty(e,"multiInject",{enumerable:!0,get:function(){return d.multiInject}});var p=n(2670);Object.defineProperty(e,"targetName",{enumerable:!0,get:function(){return p.targetName}});var m=n(2671);Object.defineProperty(e,"postConstruct",{enumerable:!0,get:function(){return m.postConstruct}});var v=n(1912);Object.defineProperty(e,"MetadataReader",{enumerable:!0,get:function(){return v.MetadataReader}});var g=n(829);Object.defineProperty(e,"id",{enumerable:!0,get:function(){return g.id}});var y=n(781);Object.defineProperty(e,"decorate",{enumerable:!0,get:function(){return y.decorate}});var b=n(1917);Object.defineProperty(e,"traverseAncerstors",{enumerable:!0,get:function(){return b.traverseAncerstors}}),Object.defineProperty(e,"taggedConstraint",{enumerable:!0,get:function(){return b.taggedConstraint}}),Object.defineProperty(e,"namedConstraint",{enumerable:!0,get:function(){return b.namedConstraint}}),Object.defineProperty(e,"typeConstraint",{enumerable:!0,get:function(){return b.typeConstraint}});var E=n(986);Object.defineProperty(e,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return E.getServiceIdentifierAsString}});var _=n(2672);Object.defineProperty(e,"multiBindToService",{enumerable:!0,get:function(){return _.multiBindToService}})},533:function(t,e,n){"use strict";var r=n(79);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(80)),o=n(0),a=(0,i.default)((0,o.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");e.default=a},534:function(t,e,n){"use strict";n.d(e,"AST_TOKEN_TYPES",(function(){return l})),n.d(e,"STORAGE_CLASS",(function(){return d})),n.d(e,"Target",(function(){return p})),n.d(e,"DefineValuePlaceholder",(function(){return v}));n(1911),n(651),n(1523),n(1532),n(1449),n(1450),n(1451),n(1452),n(1453),n(1454),n(1300),n(1457),n(1458),n(1459),n(1460);var r=n(1446);n.d(e,"createEntity",(function(){return r.b}));var i=n(653);n.d(e,"IDENTIFIER",(function(){return i.a}));var o=n(998);n.d(e,"createWorldContainer",(function(){return o.a}));var a=n(1919);n.d(e,"generateAABBFromVertices",(function(){return a.a}));var u=n(1920);n.d(e,"isSafari",(function(){return u.a}));n(1961);var s=n(1965);n.d(e,"AABB",(function(){return s.a})),n.d(e,"Frustum",(function(){return s.b}));var c=n(1302);n.o(c,"gl")&&n.d(e,"gl",(function(){return c.gl}));var f=n(1932);n.o(f,"gl")&&n.d(e,"gl",(function(){return f.gl}));var l,h,d,p,m=n(1933);n.o(m,"gl")&&n.d(e,"gl",(function(){return m.gl})),n.o(c,"gl")&&n.d(e,"gl",(function(){return c.gl})),function(t){t.Void="Void",t.Boolean="Boolean",t.Float="Float",t.Uint32="Uint32",t.Int32="Int32",t.Vector="Vector",t.Vector2Float="vec2<f32>",t.Vector3Float="vec3<f32>",t.Vector4Float="vec4<f32>",t.Vector2Boolean="vec2<bool>",t.Vector3Boolean="vec3<bool>",t.Vector4Boolean="vec4<bool>",t.Vector2Uint="vec2<u32>",t.Vector3Uint="vec3<u32>",t.Vector4Uint="vec4<u32>",t.Vector2Int="vec2<i32>",t.Vector3Int="vec3<i32>",t.Vector4Int="vec4<i32>",t.Matrix="Matrix",t.Matrix3x3Float="mat3x3<f32>",t.Matrix4x4Float="mat4x4<i32>",t.Struct="Struct",t.FloatArray="Float[]",t.Vector4FloatArray="vec4<f32>[]"}(l||(l={})),function(t){t.Program="Program",t.Identifier="Identifier",t.VariableDeclaration="VariableDeclaration",t.BlockStatement="BlockStatement",t.ReturnStatement="ReturnStatement",t.FunctionDeclaration="FunctionDeclaration",t.VariableDeclarator="VariableDeclarator",t.AssignmentExpression="AssignmentExpression",t.LogicalExpression="LogicalExpression",t.BinaryExpression="BinaryExpression",t.ArrayExpression="ArrayExpression",t.UnaryExpression="UnaryExpression",t.UpdateExpression="UpdateExpression",t.FunctionExpression="FunctionExpression",t.MemberExpression="MemberExpression",t.ConditionalExpression="ConditionalExpression",t.ExpressionStatement="ExpressionStatement",t.CallExpression="CallExpression",t.NumThreadStatement="NumThreadStatement",t.StorageStatement="StorageStatement",t.DoWhileStatement="DoWhileStatement",t.WhileStatement="WhileStatement",t.ForStatement="ForStatement",t.BreakStatement="BreakStatement",t.ContinueStatement="ContinueStatement",t.IfStatement="IfStatement",t.ImportedFunctionStatement="ImportedFunctionStatement"}(h||(h={})),function(t){t.Input="Input",t.Output="Output",t.Uniform="Uniform",t.Workgroup="Workgroup",t.UniformConstant="UniformConstant",t.Image="Image",t.StorageBuffer="StorageBuffer",t.Private="Private",t.Function="Function"}(d||(d={})),function(t){t.GLSL100="GLSL100",t.GLSL450="GLSL450",t.WGSL="WGSL"}(p||(p={}));var v="__DefineValuePlaceholder__"},556:function(t,e,n){var r;try{r={cloneDeep:n(1331),constant:n(1444),defaults:n(2594),each:n(1888),filter:n(1891),find:n(2595),flatten:n(1906),forEach:n(1889),forIn:n(2599),has:n(1004),isUndefined:n(1892),last:n(2120),map:n(1893),mapValues:n(1341),max:n(2600),merge:n(2602),min:n(2607),minBy:n(2608),now:n(1406),pick:n(2609),range:n(2612),reduce:n(1895),sortBy:n(2615),uniqueId:n(2620),values:n(1899),zipObject:n(2621)}}catch(i){}r||(r=window._),t.exports=r},558:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return ln})),n.d(e,"e",(function(){return Lt})),n.d(e,"f",(function(){return o}));var r={};n.r(r),n.d(r,"create",(function(){return s})),n.d(r,"fromMat4",(function(){return c})),n.d(r,"clone",(function(){return f})),n.d(r,"copy",(function(){return l})),n.d(r,"fromValues",(function(){return h})),n.d(r,"set",(function(){return d})),n.d(r,"identity",(function(){return p})),n.d(r,"transpose",(function(){return m})),n.d(r,"invert",(function(){return v})),n.d(r,"adjoint",(function(){return g})),n.d(r,"determinant",(function(){return y})),n.d(r,"multiply",(function(){return b})),n.d(r,"translate",(function(){return E})),n.d(r,"rotate",(function(){return _})),n.d(r,"scale",(function(){return w})),n.d(r,"fromTranslation",(function(){return x})),n.d(r,"fromRotation",(function(){return T})),n.d(r,"fromScaling",(function(){return S})),n.d(r,"fromMat2d",(function(){return A})),n.d(r,"fromQuat",(function(){return O})),n.d(r,"normalFromMat4",(function(){return R})),n.d(r,"projection",(function(){return C})),n.d(r,"str",(function(){return M})),n.d(r,"frob",(function(){return I})),n.d(r,"add",(function(){return N})),n.d(r,"subtract",(function(){return k})),n.d(r,"multiplyScalar",(function(){return P})),n.d(r,"multiplyScalarAndAdd",(function(){return j})),n.d(r,"exactEquals",(function(){return D})),n.d(r,"equals",(function(){return L})),n.d(r,"mul",(function(){return B})),n.d(r,"sub",(function(){return F}));var i={};n.r(i),n.d(i,"create",(function(){return U})),n.d(i,"clone",(function(){return G})),n.d(i,"copy",(function(){return V})),n.d(i,"fromValues",(function(){return z})),n.d(i,"set",(function(){return H})),n.d(i,"identity",(function(){return W})),n.d(i,"transpose",(function(){return q})),n.d(i,"invert",(function(){return X})),n.d(i,"adjoint",(function(){return Y})),n.d(i,"determinant",(function(){return K})),n.d(i,"multiply",(function(){return Q})),n.d(i,"translate",(function(){return Z})),n.d(i,"scale",(function(){return J})),n.d(i,"rotate",(function(){return $})),n.d(i,"rotateX",(function(){return tt})),n.d(i,"rotateY",(function(){return et})),n.d(i,"rotateZ",(function(){return nt})),n.d(i,"fromTranslation",(function(){return rt})),n.d(i,"fromScaling",(function(){return it})),n.d(i,"fromRotation",(function(){return ot})),n.d(i,"fromXRotation",(function(){return at})),n.d(i,"fromYRotation",(function(){return ut})),n.d(i,"fromZRotation",(function(){return st})),n.d(i,"fromRotationTranslation",(function(){return ct})),n.d(i,"fromQuat2",(function(){return ft})),n.d(i,"getTranslation",(function(){return lt})),n.d(i,"getScaling",(function(){return ht})),n.d(i,"getRotation",(function(){return dt})),n.d(i,"fromRotationTranslationScale",(function(){return pt})),n.d(i,"fromRotationTranslationScaleOrigin",(function(){return mt})),n.d(i,"fromQuat",(function(){return vt})),n.d(i,"frustum",(function(){return gt})),n.d(i,"perspectiveNO",(function(){return yt})),n.d(i,"perspective",(function(){return bt})),n.d(i,"perspectiveZO",(function(){return Et})),n.d(i,"perspectiveFromFieldOfView",(function(){return _t})),n.d(i,"orthoNO",(function(){return wt})),n.d(i,"ortho",(function(){return xt})),n.d(i,"orthoZO",(function(){return Tt})),n.d(i,"lookAt",(function(){return St})),n.d(i,"targetTo",(function(){return At})),n.d(i,"str",(function(){return Ot})),n.d(i,"frob",(function(){return Rt})),n.d(i,"add",(function(){return Ct})),n.d(i,"subtract",(function(){return Mt})),n.d(i,"multiplyScalar",(function(){return It})),n.d(i,"multiplyScalarAndAdd",(function(){return Nt})),n.d(i,"exactEquals",(function(){return kt})),n.d(i,"equals",(function(){return Pt})),n.d(i,"mul",(function(){return jt})),n.d(i,"sub",(function(){return Dt}));var o={};n.r(o),n.d(o,"create",(function(){return Bt})),n.d(o,"clone",(function(){return Ft})),n.d(o,"fromValues",(function(){return Ut})),n.d(o,"copy",(function(){return Gt})),n.d(o,"set",(function(){return Vt})),n.d(o,"add",(function(){return zt})),n.d(o,"subtract",(function(){return Ht})),n.d(o,"multiply",(function(){return Wt})),n.d(o,"divide",(function(){return qt})),n.d(o,"ceil",(function(){return Xt})),n.d(o,"floor",(function(){return Yt})),n.d(o,"min",(function(){return Kt})),n.d(o,"max",(function(){return Qt})),n.d(o,"round",(function(){return Zt})),n.d(o,"scale",(function(){return Jt})),n.d(o,"scaleAndAdd",(function(){return $t})),n.d(o,"distance",(function(){return te})),n.d(o,"squaredDistance",(function(){return ee})),n.d(o,"length",(function(){return ne})),n.d(o,"squaredLength",(function(){return re})),n.d(o,"negate",(function(){return ie})),n.d(o,"inverse",(function(){return oe})),n.d(o,"normalize",(function(){return ae})),n.d(o,"dot",(function(){return ue})),n.d(o,"cross",(function(){return se})),n.d(o,"lerp",(function(){return ce})),n.d(o,"random",(function(){return fe})),n.d(o,"transformMat4",(function(){return le})),n.d(o,"transformQuat",(function(){return he})),n.d(o,"zero",(function(){return de})),n.d(o,"str",(function(){return pe})),n.d(o,"exactEquals",(function(){return me})),n.d(o,"equals",(function(){return ve})),n.d(o,"sub",(function(){return ge})),n.d(o,"mul",(function(){return ye})),n.d(o,"div",(function(){return be})),n.d(o,"dist",(function(){return Ee})),n.d(o,"sqrDist",(function(){return _e})),n.d(o,"len",(function(){return we})),n.d(o,"sqrLen",(function(){return xe})),n.d(o,"forEach",(function(){return Te}));var a={};n.r(a),n.d(a,"create",(function(){return Se})),n.d(a,"identity",(function(){return Ae})),n.d(a,"setAxisAngle",(function(){return Oe})),n.d(a,"getAxisAngle",(function(){return Re})),n.d(a,"getAngle",(function(){return Ce})),n.d(a,"multiply",(function(){return Me})),n.d(a,"rotateX",(function(){return Ie})),n.d(a,"rotateY",(function(){return Ne})),n.d(a,"rotateZ",(function(){return ke})),n.d(a,"calculateW",(function(){return Pe})),n.d(a,"exp",(function(){return je})),n.d(a,"ln",(function(){return De})),n.d(a,"pow",(function(){return Le})),n.d(a,"slerp",(function(){return Be})),n.d(a,"random",(function(){return Fe})),n.d(a,"invert",(function(){return Ue})),n.d(a,"conjugate",(function(){return Ge})),n.d(a,"fromMat3",(function(){return Ve})),n.d(a,"fromEuler",(function(){return ze})),n.d(a,"str",(function(){return He})),n.d(a,"clone",(function(){return We})),n.d(a,"fromValues",(function(){return qe})),n.d(a,"copy",(function(){return Xe})),n.d(a,"set",(function(){return Ye})),n.d(a,"add",(function(){return Ke})),n.d(a,"mul",(function(){return Qe})),n.d(a,"scale",(function(){return Ze})),n.d(a,"dot",(function(){return Je})),n.d(a,"lerp",(function(){return $e})),n.d(a,"length",(function(){return tn})),n.d(a,"len",(function(){return en})),n.d(a,"squaredLength",(function(){return nn})),n.d(a,"sqrLen",(function(){return rn})),n.d(a,"normalize",(function(){return on})),n.d(a,"exactEquals",(function(){return an})),n.d(a,"equals",(function(){return un})),n.d(a,"rotationTo",(function(){return sn})),n.d(a,"sqlerp",(function(){return cn})),n.d(a,"setAxes",(function(){return fn}));var u=n(644);function s(){var t=new u.a(9);return u.a!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function c(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function f(t){var e=new u.a(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function l(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function h(t,e,n,r,i,o,a,s,c){var f=new u.a(9);return f[0]=t,f[1]=e,f[2]=n,f[3]=r,f[4]=i,f[5]=o,f[6]=a,f[7]=s,f[8]=c,f}function d(t,e,n,r,i,o,a,u,s,c){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=u,t[7]=s,t[8]=c,t}function p(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function m(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function v(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8],l=f*a-u*c,h=-f*o+u*s,d=c*o-a*s,p=n*l+r*h+i*d;return p?(p=1/p,t[0]=l*p,t[1]=(-f*r+i*c)*p,t[2]=(u*r-i*a)*p,t[3]=h*p,t[4]=(f*n-i*s)*p,t[5]=(-u*n+i*o)*p,t[6]=d*p,t[7]=(-c*n+r*s)*p,t[8]=(a*n-r*o)*p,t):null}function g(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8];return t[0]=a*f-u*c,t[1]=i*c-r*f,t[2]=r*u-i*a,t[3]=u*s-o*f,t[4]=n*f-i*s,t[5]=i*o-n*u,t[6]=o*c-a*s,t[7]=r*s-n*c,t[8]=n*a-r*o,t}function y(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],u=t[6],s=t[7],c=t[8];return e*(c*o-a*s)+n*(-c*i+a*u)+r*(s*i-o*u)}function b(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=e[8],h=n[0],d=n[1],p=n[2],m=n[3],v=n[4],g=n[5],y=n[6],b=n[7],E=n[8];return t[0]=h*r+d*a+p*c,t[1]=h*i+d*u+p*f,t[2]=h*o+d*s+p*l,t[3]=m*r+v*a+g*c,t[4]=m*i+v*u+g*f,t[5]=m*o+v*s+g*l,t[6]=y*r+b*a+E*c,t[7]=y*i+b*u+E*f,t[8]=y*o+b*s+E*l,t}function E(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=e[8],h=n[0],d=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=u,t[5]=s,t[6]=h*r+d*a+c,t[7]=h*i+d*u+f,t[8]=h*o+d*s+l,t}function _(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=e[8],h=Math.sin(n),d=Math.cos(n);return t[0]=d*r+h*a,t[1]=d*i+h*u,t[2]=d*o+h*s,t[3]=d*a-h*r,t[4]=d*u-h*i,t[5]=d*s-h*o,t[6]=c,t[7]=f,t[8]=l,t}function w(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function x(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function T(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function S(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function A(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function O(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,u=r+r,s=i+i,c=n*a,f=r*a,l=r*u,h=i*a,d=i*u,p=i*s,m=o*a,v=o*u,g=o*s;return t[0]=1-l-p,t[3]=f-g,t[6]=h+v,t[1]=f+g,t[4]=1-c-p,t[7]=d-m,t[2]=h-v,t[5]=d+m,t[8]=1-c-l,t}function R(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8],l=e[9],h=e[10],d=e[11],p=e[12],m=e[13],v=e[14],g=e[15],y=n*u-r*a,b=n*s-i*a,E=n*c-o*a,_=r*s-i*u,w=r*c-o*u,x=i*c-o*s,T=f*m-l*p,S=f*v-h*p,A=f*g-d*p,O=l*v-h*m,R=l*g-d*m,C=h*g-d*v,M=y*C-b*R+E*O+_*A-w*S+x*T;return M?(M=1/M,t[0]=(u*C-s*R+c*O)*M,t[1]=(s*A-a*C-c*S)*M,t[2]=(a*R-u*A+c*T)*M,t[3]=(i*R-r*C-o*O)*M,t[4]=(n*C-i*A+o*S)*M,t[5]=(r*A-n*R-o*T)*M,t[6]=(m*x-v*w+g*_)*M,t[7]=(v*E-p*x-g*b)*M,t[8]=(p*w-m*E+g*y)*M,t):null}function C(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function M(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function I(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function N(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function k(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function P(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function j(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function D(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function L(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],c=t[6],f=t[7],l=t[8],h=e[0],d=e[1],p=e[2],m=e[3],v=e[4],g=e[5],y=e[6],b=e[7],E=e[8];return Math.abs(n-h)<=u.b*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(r-d)<=u.b*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(i-p)<=u.b*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(o-m)<=u.b*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-v)<=u.b*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(s-g)<=u.b*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(c-y)<=u.b*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(f-b)<=u.b*Math.max(1,Math.abs(f),Math.abs(b))&&Math.abs(l-E)<=u.b*Math.max(1,Math.abs(l),Math.abs(E))}var B=b,F=k;function U(){var t=new u.a(16);return u.a!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function G(t){var e=new u.a(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function V(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function z(t,e,n,r,i,o,a,s,c,f,l,h,d,p,m,v){var g=new u.a(16);return g[0]=t,g[1]=e,g[2]=n,g[3]=r,g[4]=i,g[5]=o,g[6]=a,g[7]=s,g[8]=c,g[9]=f,g[10]=l,g[11]=h,g[12]=d,g[13]=p,g[14]=m,g[15]=v,g}function H(t,e,n,r,i,o,a,u,s,c,f,l,h,d,p,m,v){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=u,t[7]=s,t[8]=c,t[9]=f,t[10]=l,t[11]=h,t[12]=d,t[13]=p,t[14]=m,t[15]=v,t}function W(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function q(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function X(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8],l=e[9],h=e[10],d=e[11],p=e[12],m=e[13],v=e[14],g=e[15],y=n*u-r*a,b=n*s-i*a,E=n*c-o*a,_=r*s-i*u,w=r*c-o*u,x=i*c-o*s,T=f*m-l*p,S=f*v-h*p,A=f*g-d*p,O=l*v-h*m,R=l*g-d*m,C=h*g-d*v,M=y*C-b*R+E*O+_*A-w*S+x*T;return M?(M=1/M,t[0]=(u*C-s*R+c*O)*M,t[1]=(i*R-r*C-o*O)*M,t[2]=(m*x-v*w+g*_)*M,t[3]=(h*w-l*x-d*_)*M,t[4]=(s*A-a*C-c*S)*M,t[5]=(n*C-i*A+o*S)*M,t[6]=(v*E-p*x-g*b)*M,t[7]=(f*x-h*E+d*b)*M,t[8]=(a*R-u*A+c*T)*M,t[9]=(r*A-n*R-o*T)*M,t[10]=(p*w-m*E+g*y)*M,t[11]=(l*E-f*w-d*y)*M,t[12]=(u*S-a*O-s*T)*M,t[13]=(n*O-r*S+i*T)*M,t[14]=(m*b-p*_-v*y)*M,t[15]=(f*_-l*b+h*y)*M,t):null}function Y(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],u=e[5],s=e[6],c=e[7],f=e[8],l=e[9],h=e[10],d=e[11],p=e[12],m=e[13],v=e[14],g=e[15];return t[0]=u*(h*g-d*v)-l*(s*g-c*v)+m*(s*d-c*h),t[1]=-(r*(h*g-d*v)-l*(i*g-o*v)+m*(i*d-o*h)),t[2]=r*(s*g-c*v)-u*(i*g-o*v)+m*(i*c-o*s),t[3]=-(r*(s*d-c*h)-u*(i*d-o*h)+l*(i*c-o*s)),t[4]=-(a*(h*g-d*v)-f*(s*g-c*v)+p*(s*d-c*h)),t[5]=n*(h*g-d*v)-f*(i*g-o*v)+p*(i*d-o*h),t[6]=-(n*(s*g-c*v)-a*(i*g-o*v)+p*(i*c-o*s)),t[7]=n*(s*d-c*h)-a*(i*d-o*h)+f*(i*c-o*s),t[8]=a*(l*g-d*m)-f*(u*g-c*m)+p*(u*d-c*l),t[9]=-(n*(l*g-d*m)-f*(r*g-o*m)+p*(r*d-o*l)),t[10]=n*(u*g-c*m)-a*(r*g-o*m)+p*(r*c-o*u),t[11]=-(n*(u*d-c*l)-a*(r*d-o*l)+f*(r*c-o*u)),t[12]=-(a*(l*v-h*m)-f*(u*v-s*m)+p*(u*h-s*l)),t[13]=n*(l*v-h*m)-f*(r*v-i*m)+p*(r*h-i*l),t[14]=-(n*(u*v-s*m)-a*(r*v-i*m)+p*(r*s-i*u)),t[15]=n*(u*h-s*l)-a*(r*h-i*l)+f*(r*s-i*u),t}function K(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],u=t[6],s=t[7],c=t[8],f=t[9],l=t[10],h=t[11],d=t[12],p=t[13],m=t[14],v=t[15];return(e*a-n*o)*(l*v-h*m)-(e*u-r*o)*(f*v-h*p)+(e*s-i*o)*(f*m-l*p)+(n*u-r*a)*(c*v-h*d)-(n*s-i*a)*(c*m-l*d)+(r*s-i*u)*(c*p-f*d)}function Q(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=e[8],h=e[9],d=e[10],p=e[11],m=e[12],v=e[13],g=e[14],y=e[15],b=n[0],E=n[1],_=n[2],w=n[3];return t[0]=b*r+E*u+_*l+w*m,t[1]=b*i+E*s+_*h+w*v,t[2]=b*o+E*c+_*d+w*g,t[3]=b*a+E*f+_*p+w*y,b=n[4],E=n[5],_=n[6],w=n[7],t[4]=b*r+E*u+_*l+w*m,t[5]=b*i+E*s+_*h+w*v,t[6]=b*o+E*c+_*d+w*g,t[7]=b*a+E*f+_*p+w*y,b=n[8],E=n[9],_=n[10],w=n[11],t[8]=b*r+E*u+_*l+w*m,t[9]=b*i+E*s+_*h+w*v,t[10]=b*o+E*c+_*d+w*g,t[11]=b*a+E*f+_*p+w*y,b=n[12],E=n[13],_=n[14],w=n[15],t[12]=b*r+E*u+_*l+w*m,t[13]=b*i+E*s+_*h+w*v,t[14]=b*o+E*c+_*d+w*g,t[15]=b*a+E*f+_*p+w*y,t}function Z(t,e,n){var r,i,o,a,u,s,c,f,l,h,d,p,m=n[0],v=n[1],g=n[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*g+e[12],t[13]=e[1]*m+e[5]*v+e[9]*g+e[13],t[14]=e[2]*m+e[6]*v+e[10]*g+e[14],t[15]=e[3]*m+e[7]*v+e[11]*g+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],u=e[4],s=e[5],c=e[6],f=e[7],l=e[8],h=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=u,t[5]=s,t[6]=c,t[7]=f,t[8]=l,t[9]=h,t[10]=d,t[11]=p,t[12]=r*m+u*v+l*g+e[12],t[13]=i*m+s*v+h*g+e[13],t[14]=o*m+c*v+d*g+e[14],t[15]=a*m+f*v+p*g+e[15]),t}function J(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function $(t,e,n,r){var i,o,a,s,c,f,l,h,d,p,m,v,g,y,b,E,_,w,x,T,S,A,O,R,C=r[0],M=r[1],I=r[2],N=Math.hypot(C,M,I);return N<u.b?null:(C*=N=1/N,M*=N,I*=N,i=Math.sin(n),a=1-(o=Math.cos(n)),s=e[0],c=e[1],f=e[2],l=e[3],h=e[4],d=e[5],p=e[6],m=e[7],v=e[8],g=e[9],y=e[10],b=e[11],E=C*C*a+o,_=M*C*a+I*i,w=I*C*a-M*i,x=C*M*a-I*i,T=M*M*a+o,S=I*M*a+C*i,A=C*I*a+M*i,O=M*I*a-C*i,R=I*I*a+o,t[0]=s*E+h*_+v*w,t[1]=c*E+d*_+g*w,t[2]=f*E+p*_+y*w,t[3]=l*E+m*_+b*w,t[4]=s*x+h*T+v*S,t[5]=c*x+d*T+g*S,t[6]=f*x+p*T+y*S,t[7]=l*x+m*T+b*S,t[8]=s*A+h*O+v*R,t[9]=c*A+d*O+g*R,t[10]=f*A+p*O+y*R,t[11]=l*A+m*O+b*R,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function tt(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],u=e[6],s=e[7],c=e[8],f=e[9],l=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+f*r,t[6]=u*i+l*r,t[7]=s*i+h*r,t[8]=c*i-o*r,t[9]=f*i-a*r,t[10]=l*i-u*r,t[11]=h*i-s*r,t}function et(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],u=e[2],s=e[3],c=e[8],f=e[9],l=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-f*r,t[2]=u*i-l*r,t[3]=s*i-h*r,t[8]=o*r+c*i,t[9]=a*r+f*i,t[10]=u*r+l*i,t[11]=s*r+h*i,t}function nt(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],u=e[2],s=e[3],c=e[4],f=e[5],l=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+f*r,t[2]=u*i+l*r,t[3]=s*i+h*r,t[4]=c*i-o*r,t[5]=f*i-a*r,t[6]=l*i-u*r,t[7]=h*i-s*r,t}function rt(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function it(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ot(t,e,n){var r,i,o,a=n[0],s=n[1],c=n[2],f=Math.hypot(a,s,c);return f<u.b?null:(a*=f=1/f,s*=f,c*=f,r=Math.sin(e),o=1-(i=Math.cos(e)),t[0]=a*a*o+i,t[1]=s*a*o+c*r,t[2]=c*a*o-s*r,t[3]=0,t[4]=a*s*o-c*r,t[5]=s*s*o+i,t[6]=c*s*o+a*r,t[7]=0,t[8]=a*c*o+s*r,t[9]=s*c*o-a*r,t[10]=c*c*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function at(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ut(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function st(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ct(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=r+r,s=i+i,c=o+o,f=r*u,l=r*s,h=r*c,d=i*s,p=i*c,m=o*c,v=a*u,g=a*s,y=a*c;return t[0]=1-(d+m),t[1]=l+y,t[2]=h-g,t[3]=0,t[4]=l-y,t[5]=1-(f+m),t[6]=p+v,t[7]=0,t[8]=h+g,t[9]=p-v,t[10]=1-(f+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function ft(t,e){var n=new u.a(3),r=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],c=e[5],f=e[6],l=e[7],h=r*r+i*i+o*o+a*a;return h>0?(n[0]=2*(s*a+l*r+c*o-f*i)/h,n[1]=2*(c*a+l*i+f*r-s*o)/h,n[2]=2*(f*a+l*o+s*i-c*r)/h):(n[0]=2*(s*a+l*r+c*o-f*i),n[1]=2*(c*a+l*i+f*r-s*o),n[2]=2*(f*a+l*o+s*i-c*r)),ct(t,e,n),t}function lt(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function ht(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],a=e[5],u=e[6],s=e[8],c=e[9],f=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(o,a,u),t[2]=Math.hypot(s,c,f),t}function dt(t,e){var n=new u.a(3);ht(n,e);var r=1/n[0],i=1/n[1],o=1/n[2],a=e[0]*r,s=e[1]*i,c=e[2]*o,f=e[4]*r,l=e[5]*i,h=e[6]*o,d=e[8]*r,p=e[9]*i,m=e[10]*o,v=a+l+m,g=0;return v>0?(g=2*Math.sqrt(v+1),t[3]=.25*g,t[0]=(h-p)/g,t[1]=(d-c)/g,t[2]=(s-f)/g):a>l&&a>m?(g=2*Math.sqrt(1+a-l-m),t[3]=(h-p)/g,t[0]=.25*g,t[1]=(s+f)/g,t[2]=(d+c)/g):l>m?(g=2*Math.sqrt(1+l-a-m),t[3]=(d-c)/g,t[0]=(s+f)/g,t[1]=.25*g,t[2]=(h+p)/g):(g=2*Math.sqrt(1+m-a-l),t[3]=(s-f)/g,t[0]=(d+c)/g,t[1]=(h+p)/g,t[2]=.25*g),t}function pt(t,e,n,r){var i=e[0],o=e[1],a=e[2],u=e[3],s=i+i,c=o+o,f=a+a,l=i*s,h=i*c,d=i*f,p=o*c,m=o*f,v=a*f,g=u*s,y=u*c,b=u*f,E=r[0],_=r[1],w=r[2];return t[0]=(1-(p+v))*E,t[1]=(h+b)*E,t[2]=(d-y)*E,t[3]=0,t[4]=(h-b)*_,t[5]=(1-(l+v))*_,t[6]=(m+g)*_,t[7]=0,t[8]=(d+y)*w,t[9]=(m-g)*w,t[10]=(1-(l+p))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function mt(t,e,n,r,i){var o=e[0],a=e[1],u=e[2],s=e[3],c=o+o,f=a+a,l=u+u,h=o*c,d=o*f,p=o*l,m=a*f,v=a*l,g=u*l,y=s*c,b=s*f,E=s*l,_=r[0],w=r[1],x=r[2],T=i[0],S=i[1],A=i[2],O=(1-(m+g))*_,R=(d+E)*_,C=(p-b)*_,M=(d-E)*w,I=(1-(h+g))*w,N=(v+y)*w,k=(p+b)*x,P=(v-y)*x,j=(1-(h+m))*x;return t[0]=O,t[1]=R,t[2]=C,t[3]=0,t[4]=M,t[5]=I,t[6]=N,t[7]=0,t[8]=k,t[9]=P,t[10]=j,t[11]=0,t[12]=n[0]+T-(O*T+M*S+k*A),t[13]=n[1]+S-(R*T+I*S+P*A),t[14]=n[2]+A-(C*T+N*S+j*A),t[15]=1,t}function vt(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,u=r+r,s=i+i,c=n*a,f=r*a,l=r*u,h=i*a,d=i*u,p=i*s,m=o*a,v=o*u,g=o*s;return t[0]=1-l-p,t[1]=f+g,t[2]=h-v,t[3]=0,t[4]=f-g,t[5]=1-c-p,t[6]=d+m,t[7]=0,t[8]=h+v,t[9]=d-m,t[10]=1-c-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function gt(t,e,n,r,i,o,a){var u=1/(n-e),s=1/(i-r),c=1/(o-a);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*s,t[6]=0,t[7]=0,t[8]=(n+e)*u,t[9]=(i+r)*s,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t}function yt(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}var bt=yt;function Et(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=i*o,t[14]=i*r*o):(t[10]=-1,t[14]=-r),t}function _t(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),s=2/(a+u),c=2/(i+o);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(a-u)*s*.5,t[9]=(i-o)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function wt(t,e,n,r,i,o,a){var u=1/(e-n),s=1/(r-i),c=1/(o-a);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*u,t[13]=(i+r)*s,t[14]=(a+o)*c,t[15]=1,t}var xt=wt;function Tt(t,e,n,r,i,o,a){var u=1/(e-n),s=1/(r-i),c=1/(o-a);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+n)*u,t[13]=(i+r)*s,t[14]=o*c,t[15]=1,t}function St(t,e,n,r){var i,o,a,s,c,f,l,h,d,p,m=e[0],v=e[1],g=e[2],y=r[0],b=r[1],E=r[2],_=n[0],w=n[1],x=n[2];return Math.abs(m-_)<u.b&&Math.abs(v-w)<u.b&&Math.abs(g-x)<u.b?W(t):(l=m-_,h=v-w,d=g-x,i=b*(d*=p=1/Math.hypot(l,h,d))-E*(h*=p),o=E*(l*=p)-y*d,a=y*h-b*l,(p=Math.hypot(i,o,a))?(i*=p=1/p,o*=p,a*=p):(i=0,o=0,a=0),s=h*a-d*o,c=d*i-l*a,f=l*o-h*i,(p=Math.hypot(s,c,f))?(s*=p=1/p,c*=p,f*=p):(s=0,c=0,f=0),t[0]=i,t[1]=s,t[2]=l,t[3]=0,t[4]=o,t[5]=c,t[6]=h,t[7]=0,t[8]=a,t[9]=f,t[10]=d,t[11]=0,t[12]=-(i*m+o*v+a*g),t[13]=-(s*m+c*v+f*g),t[14]=-(l*m+h*v+d*g),t[15]=1,t)}function At(t,e,n,r){var i=e[0],o=e[1],a=e[2],u=r[0],s=r[1],c=r[2],f=i-n[0],l=o-n[1],h=a-n[2],d=f*f+l*l+h*h;d>0&&(f*=d=1/Math.sqrt(d),l*=d,h*=d);var p=s*h-c*l,m=c*f-u*h,v=u*l-s*f;return(d=p*p+m*m+v*v)>0&&(p*=d=1/Math.sqrt(d),m*=d,v*=d),t[0]=p,t[1]=m,t[2]=v,t[3]=0,t[4]=l*v-h*m,t[5]=h*p-f*v,t[6]=f*m-l*p,t[7]=0,t[8]=f,t[9]=l,t[10]=h,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t}function Ot(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Rt(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Ct(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function Mt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function It(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function Nt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function kt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Pt(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],c=t[6],f=t[7],l=t[8],h=t[9],d=t[10],p=t[11],m=t[12],v=t[13],g=t[14],y=t[15],b=e[0],E=e[1],_=e[2],w=e[3],x=e[4],T=e[5],S=e[6],A=e[7],O=e[8],R=e[9],C=e[10],M=e[11],I=e[12],N=e[13],k=e[14],P=e[15];return Math.abs(n-b)<=u.b*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(r-E)<=u.b*Math.max(1,Math.abs(r),Math.abs(E))&&Math.abs(i-_)<=u.b*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-w)<=u.b*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(a-x)<=u.b*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(s-T)<=u.b*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(c-S)<=u.b*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(f-A)<=u.b*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(l-O)<=u.b*Math.max(1,Math.abs(l),Math.abs(O))&&Math.abs(h-R)<=u.b*Math.max(1,Math.abs(h),Math.abs(R))&&Math.abs(d-C)<=u.b*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(p-M)<=u.b*Math.max(1,Math.abs(p),Math.abs(M))&&Math.abs(m-I)<=u.b*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(v-N)<=u.b*Math.max(1,Math.abs(v),Math.abs(N))&&Math.abs(g-k)<=u.b*Math.max(1,Math.abs(g),Math.abs(k))&&Math.abs(y-P)<=u.b*Math.max(1,Math.abs(y),Math.abs(P))}var jt=Q,Dt=Mt,Lt=n(860);function Bt(){var t=new u.a(4);return u.a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Ft(t){var e=new u.a(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Ut(t,e,n,r){var i=new u.a(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function Gt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Vt(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function zt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function Ht(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function Wt(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function qt(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function Xt(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Yt(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Kt(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function Qt(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function Zt(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Jt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function $t(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}function te(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.hypot(n,r,i,o)}function ee(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o}function ne(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function re(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function ie(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function oe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function ae(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a,t}function ue(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function se(t,e,n,r){var i=n[0]*r[1]-n[1]*r[0],o=n[0]*r[2]-n[2]*r[0],a=n[0]*r[3]-n[3]*r[0],u=n[1]*r[2]-n[2]*r[1],s=n[1]*r[3]-n[3]*r[1],c=n[2]*r[3]-n[3]*r[2],f=e[0],l=e[1],h=e[2],d=e[3];return t[0]=l*c-h*s+d*u,t[1]=-f*c+h*a-d*o,t[2]=f*s-l*a+d*i,t[3]=-f*u+l*o-h*i,t}function ce(t,e,n,r){var i=e[0],o=e[1],a=e[2],u=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t[3]=u+r*(n[3]-u),t}function fe(t,e){var n,r,i,o,a,s;e=e||1;do{a=(n=2*u.c()-1)*n+(r=2*u.c()-1)*r}while(a>=1);do{s=(i=2*u.c()-1)*i+(o=2*u.c()-1)*o}while(s>=1);var c=Math.sqrt((1-a)/s);return t[0]=e*n,t[1]=e*r,t[2]=e*i*c,t[3]=e*o*c,t}function le(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}function he(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],u=n[1],s=n[2],c=n[3],f=c*r+u*o-s*i,l=c*i+s*r-a*o,h=c*o+a*i-u*r,d=-a*r-u*i-s*o;return t[0]=f*c+d*-a+l*-s-h*-u,t[1]=l*c+d*-u+h*-a-f*-s,t[2]=h*c+d*-s+f*-u-l*-a,t[3]=e[3],t}function de(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function pe(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function me(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function ve(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=e[0],s=e[1],c=e[2],f=e[3];return Math.abs(n-a)<=u.b*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-s)<=u.b*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-c)<=u.b*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(o-f)<=u.b*Math.max(1,Math.abs(o),Math.abs(f))}var ge=Ht,ye=Wt,be=qt,Ee=te,_e=ee,we=ne,xe=re,Te=function(){var t=Bt();return function(e,n,r,i,o,a){var u,s;for(n||(n=4),r||(r=0),s=i?Math.min(i*n+r,e.length):e.length,u=r;u<s;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],o(t,t,a),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}();function Se(){var t=new u.a(4);return u.a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Ae(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Oe(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Re(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>u.b?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function Ce(t,e){var n=Je(t,e);return Math.acos(2*n*n-1)}function Me(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],u=n[0],s=n[1],c=n[2],f=n[3];return t[0]=r*f+a*u+i*c-o*s,t[1]=i*f+a*s+o*u-r*c,t[2]=o*f+a*c+r*s-i*u,t[3]=a*f-r*u-i*s-o*c,t}function Ie(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=r*s+a*u,t[1]=i*s+o*u,t[2]=o*s-i*u,t[3]=a*s-r*u,t}function Ne(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=r*s-o*u,t[1]=i*s+a*u,t[2]=o*s+r*u,t[3]=a*s-i*u,t}function ke(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],u=Math.sin(n),s=Math.cos(n);return t[0]=r*s+i*u,t[1]=i*s-r*u,t[2]=o*s+a*u,t[3]=a*s-o*u,t}function Pe(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function je(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=Math.sqrt(n*n+r*r+i*i),u=Math.exp(o),s=a>0?u*Math.sin(a)/a:0;return t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=u*Math.cos(a),t}function De(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=Math.sqrt(n*n+r*r+i*i),u=a>0?Math.atan2(a,o)/a:0;return t[0]=n*u,t[1]=r*u,t[2]=i*u,t[3]=.5*Math.log(n*n+r*r+i*i+o*o),t}function Le(t,e,n){return De(t,e),Ze(t,t,n),je(t,t),t}function Be(t,e,n,r){var i,o,a,s,c,f=e[0],l=e[1],h=e[2],d=e[3],p=n[0],m=n[1],v=n[2],g=n[3];return(o=f*p+l*m+h*v+d*g)<0&&(o=-o,p=-p,m=-m,v=-v,g=-g),1-o>u.b?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,c=Math.sin(r*i)/a):(s=1-r,c=r),t[0]=s*f+c*p,t[1]=s*l+c*m,t[2]=s*h+c*v,t[3]=s*d+c*g,t}function Fe(t){var e=u.c(),n=u.c(),r=u.c(),i=Math.sqrt(1-e),o=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=o*Math.sin(2*Math.PI*r),t[3]=o*Math.cos(2*Math.PI*r),t}function Ue(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o,u=a?1/a:0;return t[0]=-n*u,t[1]=-r*u,t[2]=-i*u,t[3]=o*u,t}function Ge(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Ve(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*a+a]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+a]-e[3*a+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[a]=(e[3*a+i]+e[3*i+a])*n}return t}function ze(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var o=Math.sin(e),a=Math.cos(e),u=Math.sin(n),s=Math.cos(n),c=Math.sin(r),f=Math.cos(r);return t[0]=o*s*f-a*u*c,t[1]=a*u*f+o*s*c,t[2]=a*s*c-o*u*f,t[3]=a*s*f+o*u*c,t}function He(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var We=Ft,qe=Ut,Xe=Gt,Ye=Vt,Ke=zt,Qe=Me,Ze=Jt,Je=ue,$e=ce,tn=ne,en=tn,nn=re,rn=nn,on=ae,an=me,un=ve,sn=function(){var t=Lt.create(),e=Lt.fromValues(1,0,0),n=Lt.fromValues(0,1,0);return function(r,i,o){var a=Lt.dot(i,o);return a<-.999999?(Lt.cross(t,e,i),Lt.len(t)<1e-6&&Lt.cross(t,n,i),Lt.normalize(t,t),Oe(r,t,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Lt.cross(t,i,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+a,on(r,r))}}(),cn=function(){var t=Se(),e=Se();return function(n,r,i,o,a,u){return Be(t,r,a,u),Be(e,i,o,u),Be(n,t,e,2*u*(1-u)),n}}(),fn=function(){var t=s();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],on(e,Ve(e,t))}}(),ln=n(1006)},562:function(t,e){t.exports=function(t,e,n,r){n&&Object.defineProperty(t,e,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})},t.exports.default=t.exports,t.exports.__esModule=!0},563:function(t,e){t.exports=function(t,e,n,r,i){var o={};return Object.keys(r).forEach((function(t){o[t]=r[t]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(t,e,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(t,e,o),o=null),o},t.exports.default=t.exports,t.exports.__esModule=!0},564:function(t,e){t.exports=function(t,e){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")},t.exports.default=t.exports,t.exports.__esModule=!0},587:function(t,e,n){t.exports=n(330)},588:function(t,e){function n(t,e,n,r,i,o,a){try{var u=t[o](a),s=u.value}catch(c){return void n(c)}u.done?e(s):Promise.resolve(s).then(r,i)}t.exports=function(t){return function(){var e=this,r=arguments;return new Promise((function(i,o){var a=t.apply(e,r);function u(t){n(a,i,o,u,s,"next",t)}function s(t){n(a,i,o,u,s,"throw",t)}u(void 0)}))}},t.exports.default=t.exports,t.exports.__esModule=!0},601:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NON_CUSTOM_TAG_KEYS=e.POST_CONSTRUCT=e.DESIGN_PARAM_TYPES=e.PARAM_TYPES=e.TAGGED_PROP=e.TAGGED=e.MULTI_INJECT_TAG=e.INJECT_TAG=e.OPTIONAL_TAG=e.UNMANAGED_TAG=e.NAME_TAG=e.NAMED_TAG=void 0,e.NAMED_TAG="named",e.NAME_TAG="name",e.UNMANAGED_TAG="unmanaged",e.OPTIONAL_TAG="optional",e.INJECT_TAG="inject",e.MULTI_INJECT_TAG="multi_inject",e.TAGGED="inversify:tagged",e.TAGGED_PROP="inversify:tagged_props",e.PARAM_TYPES="inversify:paramtypes",e.DESIGN_PARAM_TYPES="design:paramtypes",e.POST_CONSTRUCT="post_construct",e.NON_CUSTOM_TAG_KEYS=[e.INJECT_TAG,e.MULTI_INJECT_TAG,e.NAME_TAG,e.UNMANAGED_TAG,e.NAMED_TAG,e.OPTIONAL_TAG]},616:function(t,e,n){var r=n(2673);t.exports=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)},t.exports.default=t.exports,t.exports.__esModule=!0},617:function(t,e,n){var r=n(252).default,i=n(691);t.exports=function(t,e){if(e&&("object"===r(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return i(t)},t.exports.default=t.exports,t.exports.__esModule=!0},618:function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.default=t.exports,t.exports.__esModule=!0,n(e)}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},643:function(t,e,n){"use strict";var r=n(556),i=n(689).Graph;function o(t,e,n,i){var o;do{o=r.uniqueId(i)}while(t.hasNode(o));return n.dummy=e,t.setNode(o,n),o}function a(t){return r.max(r.map(t.nodes(),(function(e){var n=t.node(e).rank;if(!r.isUndefined(n))return n})))}t.exports={addDummyNode:o,simplify:function(t){var e=(new i).setGraph(t.graph());return r.forEach(t.nodes(),(function(n){e.setNode(n,t.node(n))})),r.forEach(t.edges(),(function(n){var r=e.edge(n.v,n.w)||{weight:0,minlen:1},i=t.edge(n);e.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})})),e},asNonCompoundGraph:function(t){var e=new i({multigraph:t.isMultigraph()}).setGraph(t.graph());return r.forEach(t.nodes(),(function(n){t.children(n).length||e.setNode(n,t.node(n))})),r.forEach(t.edges(),(function(n){e.setEdge(n,t.edge(n))})),e},successorWeights:function(t){var e=r.map(t.nodes(),(function(e){var n={};return r.forEach(t.outEdges(e),(function(e){n[e.w]=(n[e.w]||0)+t.edge(e).weight})),n}));return r.zipObject(t.nodes(),e)},predecessorWeights:function(t){var e=r.map(t.nodes(),(function(e){var n={};return r.forEach(t.inEdges(e),(function(e){n[e.v]=(n[e.v]||0)+t.edge(e).weight})),n}));return r.zipObject(t.nodes(),e)},intersectRect:function(t,e){var n,r,i=t.x,o=t.y,a=e.x-i,u=e.y-o,s=t.width/2,c=t.height/2;if(!a&&!u)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(u)*s>Math.abs(a)*c?(u<0&&(c=-c),n=c*a/u,r=c):(a<0&&(s=-s),n=s,r=s*u/a);return{x:i+n,y:o+r}},buildLayerMatrix:function(t){var e=r.map(r.range(a(t)+1),(function(){return[]}));return r.forEach(t.nodes(),(function(n){var i=t.node(n),o=i.rank;r.isUndefined(o)||(e[o][i.order]=n)})),e},normalizeRanks:function(t){var e=r.min(r.map(t.nodes(),(function(e){return t.node(e).rank})));r.forEach(t.nodes(),(function(n){var i=t.node(n);r.has(i,"rank")&&(i.rank-=e)}))},removeEmptyRanks:function(t){var e=r.min(r.map(t.nodes(),(function(e){return t.node(e).rank}))),n=[];r.forEach(t.nodes(),(function(r){var i=t.node(r).rank-e;n[i]||(n[i]=[]),n[i].push(r)}));var i=0,o=t.graph().nodeRankFactor;r.forEach(n,(function(e,n){r.isUndefined(e)&&n%o!==0?--i:i&&r.forEach(e,(function(e){t.node(e).rank+=i}))}))},addBorderNode:function(t,e,n,r){var i={width:0,height:0};arguments.length>=4&&(i.rank=n,i.order=r);return o(t,"border",i,e)},maxRank:a,partition:function(t,e){var n={lhs:[],rhs:[]};return r.forEach(t,(function(t){e(t)?n.lhs.push(t):n.rhs.push(t)})),n},time:function(t,e){r.now();try{return e()}finally{}},notime:function(t,e){return e()}}},644:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o}));var r=1e-6,i="undefined"!==typeof Float32Array?Float32Array:Array,o=Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},651:function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return d}));var r=n(587),i=n.n(r),o=n(588),a=n.n(o),u=n(245),s=n.n(u),c=n(244),f=n.n(c),l=n(1446),h=function t(e){f()(this,t)},d=function(){function t(e){f()(this,t),this.clazz=void 0,this.components=[],this.entities=[],this.lookup={},this.clazz=e}return s()(t,[{key:"clear",value:function(){this.components=[],this.entities=[],this.lookup={}}},{key:"contains",value:function(t){return this.lookup[t]>-1}},{key:"create",value:function(t,e){this.lookup[t]=this.components.length;var n=new this.clazz(e||{});return this.components.push(n),this.entities.push(t),n}},{key:"remove",value:function(t){var e=this.lookup[t];e>-1&&e<this.components.length-1&&(this.components[e]=this.components[this.components.length-1],this.entities[e]=this.entities[this.entities.length-1],this.lookup[this.entities[e]]=e),this.components.pop(),this.entities.pop(),delete this.lookup[t]}},{key:"removeKeepSorted",value:function(t){var e=this.lookup[t];if(e>-1){var n=this.entities[e];if(e<this.components.length-1){for(var r=e+1;r<this.components.length;++r)this.components[r-1]=this.components[r];for(var i=e+1;i<this.entities.length;++i)this.entities[i-1]=this.entities[i],this.lookup[this.entities[i-1]]=i-1}this.components.pop(),this.entities.pop(),delete this.lookup[n]}}},{key:"moveItem",value:function(t,e){if(t!==e){for(var n=this.components[t],r=this.entities[t],i=t<e?1:-1,o=t;o!==e;o+=i){var a=o+i;this.components[o]=this.components[a],this.entities[o]=this.entities[a],this.lookup[this.entities[o]]=o}this.components[e]=n,this.entities[e]=r,this.lookup[r]=e}}},{key:"getEntity",value:function(t){return this.entities[t]}},{key:"getComponent",value:function(t){return this.components[t]}},{key:"getComponentByEntity",value:function(t){var e=this.lookup[t];return e>-1?this.components[e]:null}},{key:"getCount",value:function(){return this.components.length}},{key:"getEntityByComponentIndex",value:function(t){for(var e=0,n=Object.keys(this.lookup);e<n.length;e++){var r=n[e],i=Number(r);if(this.lookup[i]===t)return i}return l.a}},{key:"find",value:function(t){for(var e=0;e<this.getCount();e++){var n=this.getComponent(e);if(t(n,e))return n}return null}},{key:"findIndex",value:function(t){for(var e=0;e<this.getCount();e++){if(t(this.getComponent(e),e))return e}return-1}},{key:"forEach",value:function(t){for(var e=0,n=Object.keys(this.lookup);e<n.length;e++){var r=n[e],i=Number(r),o=this.lookup[i];t(i,this.getComponent(o))}}},{key:"forEachAsync",value:function(){var t=a()(i.a.mark((function t(e){var n,r,o,a,u;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0,r=Object.keys(this.lookup);case 1:if(!(n<r.length)){t.next=10;break}return o=r[n],a=Number(o),u=this.lookup[a],t.next=7,e(a,this.getComponent(u));case 7:n++,t.next=1;break;case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"map",value:function(t){for(var e=[],n=0,r=Object.keys(this.lookup);n<r.length;n++){var i=r[n],o=Number(i),a=this.lookup[o];e.push(t(o,this.getComponent(a)))}return e}}]),t}()},652:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.STACK_OVERFLOW=e.CIRCULAR_DEPENDENCY_IN_FACTORY=e.POST_CONSTRUCT_ERROR=e.MULTIPLE_POST_CONSTRUCT_METHODS=e.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=e.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=e.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=e.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=e.ARGUMENTS_LENGTH_MISMATCH=e.INVALID_DECORATOR_OPERATION=e.INVALID_TO_SELF_VALUE=e.INVALID_FUNCTION_BINDING=e.INVALID_MIDDLEWARE_RETURN=e.NO_MORE_SNAPSHOTS_AVAILABLE=e.INVALID_BINDING_TYPE=e.NOT_IMPLEMENTED=e.CIRCULAR_DEPENDENCY=e.UNDEFINED_INJECT_ANNOTATION=e.MISSING_INJECT_ANNOTATION=e.MISSING_INJECTABLE_ANNOTATION=e.NOT_REGISTERED=e.CANNOT_UNBIND=e.AMBIGUOUS_MATCH=e.KEY_NOT_FOUND=e.NULL_ARGUMENT=e.DUPLICATED_METADATA=e.DUPLICATED_INJECTABLE_DECORATOR=void 0,e.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",e.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",e.NULL_ARGUMENT="NULL argument",e.KEY_NOT_FOUND="Key Not Found",e.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",e.CANNOT_UNBIND="Could not unbind serviceIdentifier:",e.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",e.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",e.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";e.UNDEFINED_INJECT_ANNOTATION=function(t){return"@inject called with undefined this could mean that the class "+t+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},e.CIRCULAR_DEPENDENCY="Circular dependency found:",e.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",e.INVALID_BINDING_TYPE="Invalid binding type:",e.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",e.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",e.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",e.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",e.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";e.ARGUMENTS_LENGTH_MISMATCH=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"The number of constructor arguments in the derived class "+t[0]+" must be >= than the number of constructor arguments of its base class."},e.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",e.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",e.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",e.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",e.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";e.POST_CONSTRUCT_ERROR=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"@postConstruct error in class "+t[0]+": "+t[1]};e.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"It looks like there is a circular dependency in one of the '"+t[0]+"' bindings. Please investigate bindings withservice identifier '"+t[1]+"'."},e.STACK_OVERFLOW="Maximum call stack size exceeded"},653:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r={HierarchyComponentManager:Symbol("HierarchyComponentManager"),TransformComponentManager:Symbol("TransformComponentManager"),NameComponentManager:Symbol("NameComponentManager"),SceneGraphSystem:Symbol("SceneGraphSystem"),FrameGraphSystem:Symbol("FrameGraphSystem"),ResourcePool:Symbol("ResourcePool"),ResourceHandleComponentManager:Symbol("ResourceHandleComponentManager"),PassNodeComponentManager:Symbol("PassNodeComponentManager"),RendererSystem:Symbol("RendererSystem"),RenderPass:Symbol("RenderPass"),RenderPassFactory:Symbol("Factory<IRenderPass>"),Renderable:Symbol("Factory<IRenderPass>"),MeshSystem:Symbol("MeshSystem"),MeshComponentManager:Symbol("MeshComponentManager"),CullableComponentManager:Symbol("CullableComponentManager"),Geometry:Symbol("Geometry"),GeometrySystem:Symbol("GeometrySystem"),GeometryComponentManager:Symbol("GeometryComponentManager"),Material:Symbol("Material"),MaterialSystem:Symbol("MaterialSystem"),MaterialComponentManager:Symbol("MaterialComponentManager"),ForwardRenderPath:Symbol("ForwardRenderPath"),ComputeSystem:Symbol("ComputeSystem"),ComputeComponentManager:Symbol("ComputeComponentManager"),ComputeStrategy:Symbol("ComputeStrategy"),Systems:Symbol("Systems"),World:Symbol("World"),RenderEngine:Symbol("RenderEngine"),WebGPUEngine:Symbol("WebGPUEngine"),WebGLEngine:Symbol("WebGLEngine"),ShaderModuleService:Symbol("ShaderModuleService"),ConfigService:Symbol("ConfigService"),InteractorService:Symbol("InteractorService"),IEventEmitter:Symbol("IEventEmitter"),Light:Symbol("Light")}},679:function(t,e,n){var r;try{r={clone:n(1775),constant:n(1444),each:n(1888),filter:n(1891),has:n(1004),isArray:n(585),isEmpty:n(1433),isFunction:n(1414),isUndefined:n(1892),keys:n(723),map:n(1893),reduce:n(1895),size:n(2566),transform:n(2571),union:n(2572),values:n(1899)}}catch(i){}r||(r=window._),t.exports=r},686:function(t,e,n){var r=n(1998),i=n(1417),o=n(728);t.exports=function(t){return o(t)?r(t,!0):i(t)}},689:function(t,e,n){var r;try{r=n(2561)}catch(i){}r||(r=window.graphlib),t.exports=r},690:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var r=n(601),i=function(){function t(t,e){this.key=t,this.value=e}return t.prototype.toString=function(){return this.key===r.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},t}();e.Metadata=i},691:function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.default=t.exports,t.exports.__esModule=!0},706:function(t,e,n){"use strict";var r=n(79);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(80)),o=n(0),a=(0,i.default)((0,o.jsx)("path",{d:"M7 9H2V7h5v2zm0 3H2v2h5v-2zm13.59 7-3.83-3.83c-.8.52-1.74.83-2.76.83-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5c0 1.02-.31 1.96-.83 2.75L22 17.59 20.59 19zM17 11c0-1.65-1.35-3-3-3s-3 1.35-3 3 1.35 3 3 3 3-1.35 3-3zM2 19h10v-2H2v2z"}),"ManageSearch");e.default=a},715:function(t,e,n){var r=n(790),i=n(838);t.exports=function(t,e,n,o){var a=!n;n||(n={});for(var u=-1,s=e.length;++u<s;){var c=e[u],f=o?o(n[c],t[c],c,n,t):void 0;void 0===f&&(f=t[c]),a?i(n,c,f):r(n,c,f)}return n}},725:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.TextureCompressionBC="texture-compression-bc"}(e.ExtensionName||(e.ExtensionName={})),function(t){t.ClampToEdge="clamp-to-edge",t.Repeat="repeat",t.MirrorRepeat="mirror-repeat"}(e.AddressMode||(e.AddressMode={})),function(t){t.UniformBuffer="uniform-buffer",t.StorageBuffer="storage-buffer",t.ReadonlyStorageBuffer="readonly-storage-buffer",t.Sampler="sampler",t.ComparisonSampler="comparison-sampler",t.SampledTexture="sampled-texture",t.ReadonlyStorageTexture="readonly-storage-texture",t.WriteonlyStorageTexture="writeonly-storage-texture"}(e.BindingType||(e.BindingType={})),function(t){t.Zero="zero",t.One="one",t.SrcColor="src-color",t.OneMinusSrcColor="one-minus-src-color",t.SrcAlpha="src-alpha",t.OneMinusSrcAlpha="one-minus-src-alpha",t.DstColor="dst-color",t.OneMinusDstColor="one-minus-dst-color",t.DstAlpha="dst-alpha",t.OneMinusDstAlpha="one-minus-dst-alpha",t.SrcAlphaSaturated="src-alpha-saturated",t.BlendColor="blend-color",t.OneMinusBlendColor="one-minus-blend-color"}(e.BlendFactor||(e.BlendFactor={})),function(t){t.Add="add",t.Subtract="subtract",t.ReverseSubtract="reverse-subtract",t.Min="min",t.Max="max"}(e.BlendOperation||(e.BlendOperation={})),function(t){t.Never="never",t.Less="less",t.Equal="equal",t.LessEqual="less-equal",t.Greater="greater",t.NotEqual="not-equal",t.GreaterEqual="greater-equal",t.Always="always"}(e.CompareFunction||(e.CompareFunction={})),function(t){t.None="none",t.Front="front",t.Back="back"}(e.CullMode||(e.CullMode={})),function(t){t.Nearest="nearest",t.Linear="linear"}(e.FilterMode||(e.FilterMode={})),function(t){t.CCW="ccw",t.CW="cw"}(e.FrontFace||(e.FrontFace={})),function(t){t.Uint16="uint16",t.Uint32="uint32"}(e.IndexFormat||(e.IndexFormat={})),function(t){t.Vertex="vertex",t.Instance="instance"}(e.InputStepMode||(e.InputStepMode={})),function(t){t.Load="load"}(e.LoadOp||(e.LoadOp={})),function(t){t.PointList="point-list",t.LineList="line-list",t.LineStrip="line-strip",t.TriangleList="triangle-list",t.TriangleStrip="triangle-strip"}(e.PrimitiveTopology||(e.PrimitiveTopology={})),function(t){t.Keep="keep",t.Zero="zero",t.Replace="replace",t.Invert="invert",t.IncrementClamp="increment-clamp",t.DecrementClamp="decrement-clamp",t.IncrementWrap="increment-wrap",t.DecrementWrap="decrement-wrap"}(e.StencilOperation||(e.StencilOperation={})),function(t){t.Store="store",t.Clear="clear"}(e.StoreOp||(e.StoreOp={})),function(t){t.E1d="1d",t.E2d="2d",t.E3d="3d"}(e.TextureDimension||(e.TextureDimension={})),function(t){t.R8Unorm="r8unorm",t.R8Snorm="r8snorm",t.R8Uint="r8uint",t.R8Sint="r8sint",t.R16Uint="r16uint",t.R16Sint="r16sint",t.R16Float="r16float",t.RG8Unorm="rg8unorm",t.RG8Snorm="rg8snorm",t.RG8Uint="rg8uint",t.RG8Sint="rg8sint",t.R32Uint="r32uint",t.R32Sint="r32sint",t.R32Float="r32float",t.RG16Uint="rg16uint",t.RG16Sint="rg16sint",t.RG16Float="rg16float",t.RGBA8Unorm="rgba8unorm",t.RGBA8UnormSRGB="rgba8unorm-srgb",t.RGBA8Snorm="rgba8snorm",t.RGBA8Uint="rgba8uint",t.RGBA8Sint="rgba8sint",t.BGRA8Unorm="bgra8unorm",t.BGRA8UnormSRGB="bgra8unorm-srgb",t.RGB10A2Unorm="rgb10a2unorm",t.RG11B10Float="rg11b10float",t.RG32Uint="rg32uint",t.RG32Sint="rg32sint",t.RG32Float="rg32float",t.RGBA16Uint="rgba16uint",t.RGBA16Sint="rgba16sint",t.RGBA16Float="rgba16float",t.RGBA32Uint="rgba32uint",t.RGBA32Sint="rgba32sint",t.RGBA32Float="rgba32float",t.Depth32Float="depth32float",t.Depth24Plus="depth24plus",t.Depth24PlusStencil8="depth24plus-stencil8"}(e.TextureFormat||(e.TextureFormat={})),function(t){t.Float="float",t.Sint="sint",t.Uint="uint"}(e.TextureComponentType||(e.TextureComponentType={})),function(t){t.E1d="1d",t.E2d="2d",t.E2dArray="2d-array",t.Cube="cube",t.CubeArray="cube-array",t.E3d="3d"}(e.TextureViewDimension||(e.TextureViewDimension={})),function(t){t.Uchar2="uchar2",t.Uchar4="uchar4",t.Char2="char2",t.Char4="char4",t.Uchar2Norm="uchar2norm",t.Uchar4Norm="uchar4norm",t.Char2Norm="char2norm",t.Char4Norm="char4norm",t.Ushort2="ushort2",t.Ushort4="ushort4",t.Short2="short2",t.Short4="short4",t.Ushort2Norm="ushort2norm",t.Ushort4Norm="ushort4norm",t.Short2Norm="short2norm",t.Short4Norm="short4norm",t.Half2="half2",t.Half4="half4",t.Float="float",t.Float2="float2",t.Float3="float3",t.Float4="float4",t.Uint="uint",t.Uint2="uint2",t.Uint3="uint3",t.Uint4="uint4",t.Int="int",t.Int2="int2",t.Int3="int3",t.Int4="int4"}(e.VertexFormat||(e.VertexFormat={})),function(t){t.All="all",t.StencilOnly="stencil-only",t.DepthOnly="depth-only"}(e.TextureAspect||(e.TextureAspect={})),function(t){t.Error="error",t.Warning="warning",t.Info="info"}(e.CompilationMessageType||(e.CompilationMessageType={})),function(t){t.Occlusion="occlusion"}(e.QueryType||(e.QueryType={})),function(t){t[t.MapRead=1]="MapRead",t[t.MapWrite=2]="MapWrite",t[t.CopySrc=4]="CopySrc",t[t.CopyDst=8]="CopyDst",t[t.Index=16]="Index",t[t.Vertex=32]="Vertex",t[t.Uniform=64]="Uniform",t[t.Storage=128]="Storage",t[t.Indirect=256]="Indirect",t[t.QueryResolve=512]="QueryResolve"}(e.BufferUsage||(e.BufferUsage={})),function(t){t[t.Red=1]="Red",t[t.Green=2]="Green",t[t.Blue=4]="Blue",t[t.Alpha=8]="Alpha",t[t.All=15]="All"}(e.ColorWrite||(e.ColorWrite={})),function(t){t[t.Vertex=1]="Vertex",t[t.Fragment=2]="Fragment",t[t.Compute=4]="Compute"}(e.ShaderStage||(e.ShaderStage={})),function(t){t[t.CopySrc=1]="CopySrc",t[t.CopyDst=2]="CopyDst",t[t.Sampled=4]="Sampled",t[t.Storage=8]="Storage",t[t.OutputAttachment=16]="OutputAttachment"}(e.TextureUsage||(e.TextureUsage={})),function(t){t[t.Read=1]="Read",t[t.Write=2]="Write"}(e.MapMode||(e.MapMode={}))},758:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TargetTypeEnum=e.BindingTypeEnum=e.BindingScopeEnum=void 0;e.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"};e.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};e.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},779:function(t,e,n){var r=n(1399),i=n(1400),o=n(1401),a=n(1402);t.exports=function(t){return r(t)||i(t)||o(t)||a()},t.exports.default=t.exports,t.exports.__esModule=!0},781:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.tagProperty=e.tagParameter=e.decorate=void 0;var r=n(652),i=n(601);function o(t,e,n,i,o){var a={},u="number"===typeof o,s=void 0!==o&&u?o.toString():n;if(u&&void 0!==n)throw new Error(r.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(t,e)&&(a=Reflect.getMetadata(t,e));var c=a[s];if(Array.isArray(c))for(var f=0,l=c;f<l.length;f++){var h=l[f];if(h.key===i.key)throw new Error(r.DUPLICATED_METADATA+" "+h.key.toString())}else c=[];c.push(i),a[s]=c,Reflect.defineMetadata(t,a,e)}function a(t,e){Reflect.decorate(t,e)}function u(t,e){return function(n,r){e(n,r,t)}}e.tagParameter=function(t,e,n,r){o(i.TAGGED,t,e,r,n)},e.tagProperty=function(t,e,n){o(i.TAGGED_PROP,t.constructor,e,n)},e.decorate=function(t,e,n){"number"===typeof n?a([u(n,t)],e):"string"===typeof n?Reflect.decorate([t],e,n):a([t],e)}},784:function(t,e,n){"use strict";var r=n(79);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(80)),o=n(0),a=(0,i.default)((0,o.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"}),"Article");e.default=a},790:function(t,e,n){var r=n(838),i=n(855),o=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var a=t[e];o.call(t,e)&&i(a,n)&&(void 0!==n||e in t)||r(t,e,n)}},823:function(t,e,n){var r=n(2e3)(Object.getPrototypeOf,Object);t.exports=r},824:function(t,e,n){var r=n(1424);t.exports=function(t){var e=new t.constructor(t.byteLength);return new r(e).set(new r(t)),e}},826:function(t,e,n){"use strict";n.d(e,"b",(function(){return o}));var r=n(69),i=n(78);function o(t){return Object(r.a)("MuiSwitch",t)}var a=Object(i.a)("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]);e.a=a},829:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.id=void 0;var r=0;e.id=function(){return r++}},841:function(t,e,n){"use strict";var r=n(79);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(80)),o=n(0),a=(0,i.default)((0,o.jsx)("path",{d:"M13 13v8h8v-8h-8zM3 21h8v-8H3v8zM3 3v8h8V3H3zm13.66-1.31L11 7.34 16.66 13l5.66-5.66-5.66-5.65z"}),"Widgets");e.default=a},860:function(t,e,n){"use strict";n.r(e),n.d(e,"create",(function(){return i})),n.d(e,"clone",(function(){return o})),n.d(e,"length",(function(){return a})),n.d(e,"fromValues",(function(){return u})),n.d(e,"copy",(function(){return s})),n.d(e,"set",(function(){return c})),n.d(e,"add",(function(){return f})),n.d(e,"subtract",(function(){return l})),n.d(e,"multiply",(function(){return h})),n.d(e,"divide",(function(){return d})),n.d(e,"ceil",(function(){return p})),n.d(e,"floor",(function(){return m})),n.d(e,"min",(function(){return v})),n.d(e,"max",(function(){return g})),n.d(e,"round",(function(){return y})),n.d(e,"scale",(function(){return b})),n.d(e,"scaleAndAdd",(function(){return E})),n.d(e,"distance",(function(){return _})),n.d(e,"squaredDistance",(function(){return w})),n.d(e,"squaredLength",(function(){return x})),n.d(e,"negate",(function(){return T})),n.d(e,"inverse",(function(){return S})),n.d(e,"normalize",(function(){return A})),n.d(e,"dot",(function(){return O})),n.d(e,"cross",(function(){return R})),n.d(e,"lerp",(function(){return C})),n.d(e,"hermite",(function(){return M})),n.d(e,"bezier",(function(){return I})),n.d(e,"random",(function(){return N})),n.d(e,"transformMat4",(function(){return k})),n.d(e,"transformMat3",(function(){return P})),n.d(e,"transformQuat",(function(){return j})),n.d(e,"rotateX",(function(){return D})),n.d(e,"rotateY",(function(){return L})),n.d(e,"rotateZ",(function(){return B})),n.d(e,"angle",(function(){return F})),n.d(e,"zero",(function(){return U})),n.d(e,"str",(function(){return G})),n.d(e,"exactEquals",(function(){return V})),n.d(e,"equals",(function(){return z})),n.d(e,"sub",(function(){return H})),n.d(e,"mul",(function(){return W})),n.d(e,"div",(function(){return q})),n.d(e,"dist",(function(){return X})),n.d(e,"sqrDist",(function(){return Y})),n.d(e,"len",(function(){return K})),n.d(e,"sqrLen",(function(){return Q})),n.d(e,"forEach",(function(){return Z}));var r=n(644);function i(){var t=new r.a(3);return r.a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function o(t){var e=new r.a(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function a(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function u(t,e,n){var i=new r.a(3);return i[0]=t,i[1]=e,i[2]=n,i}function s(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function c(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function f(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function l(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function h(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function d(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function p(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function m(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function v(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function g(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function y(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function b(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function E(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function _(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function w(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function x(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function T(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function S(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function A(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function O(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function R(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],u=n[1],s=n[2];return t[0]=i*s-o*u,t[1]=o*a-r*s,t[2]=r*u-i*a,t}function C(t,e,n,r){var i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t}function M(t,e,n,r,i,o){var a=o*o,u=a*(2*o-3)+1,s=a*(o-2)+o,c=a*(o-1),f=a*(3-2*o);return t[0]=e[0]*u+n[0]*s+r[0]*c+i[0]*f,t[1]=e[1]*u+n[1]*s+r[1]*c+i[1]*f,t[2]=e[2]*u+n[2]*s+r[2]*c+i[2]*f,t}function I(t,e,n,r,i,o){var a=1-o,u=a*a,s=o*o,c=u*a,f=3*o*u,l=3*s*a,h=s*o;return t[0]=e[0]*c+n[0]*f+r[0]*l+i[0]*h,t[1]=e[1]*c+n[1]*f+r[1]*l+i[1]*h,t[2]=e[2]*c+n[2]*f+r[2]*l+i[2]*h,t}function N(t,e){e=e||1;var n=2*r.c()*Math.PI,i=2*r.c()-1,o=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=i*e,t}function k(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}function P(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function j(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],u=e[0],s=e[1],c=e[2],f=i*c-o*s,l=o*u-r*c,h=r*s-i*u,d=i*h-o*l,p=o*f-r*h,m=r*l-i*f,v=2*a;return f*=v,l*=v,h*=v,d*=2,p*=2,m*=2,t[0]=u+f+d,t[1]=s+l+p,t[2]=c+h+m,t}function D(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function L(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function B(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function F(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],u=e[2],s=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+a*a+u*u),c=s&&O(t,e)/s;return Math.acos(Math.min(Math.max(c,-1),1))}function U(t){return t[0]=0,t[1]=0,t[2]=0,t}function G(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function V(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function z(t,e){var n=t[0],i=t[1],o=t[2],a=e[0],u=e[1],s=e[2];return Math.abs(n-a)<=r.b*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-u)<=r.b*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-s)<=r.b*Math.max(1,Math.abs(o),Math.abs(s))}var H=l,W=h,q=d,X=_,Y=w,K=a,Q=x,Z=function(){var t=i();return function(e,n,r,i,o,a){var u,s;for(n||(n=3),r||(r=0),s=i?Math.min(i*n+r,e.length):e.length,u=r;u<s;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],o(t,t,a),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}()},878:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.MAX_EXT=32776]="MAX_EXT",t[t.MIN_EXT=32775]="MIN_EXT",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.CULL_FACE=2884]="CULL_FACE",t[t.BLEND=3042]="BLEND",t[t.DITHER=3024]="DITHER",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.TEXTURE1=33985]="TEXTURE1",t[t.TEXTURE2=33986]="TEXTURE2",t[t.TEXTURE3=33987]="TEXTURE3",t[t.TEXTURE4=33988]="TEXTURE4",t[t.TEXTURE5=33989]="TEXTURE5",t[t.TEXTURE6=33990]="TEXTURE6",t[t.TEXTURE7=33991]="TEXTURE7",t[t.TEXTURE8=33992]="TEXTURE8",t[t.TEXTURE9=33993]="TEXTURE9",t[t.TEXTURE10=33994]="TEXTURE10",t[t.TEXTURE11=33995]="TEXTURE11",t[t.TEXTURE12=33996]="TEXTURE12",t[t.TEXTURE13=33997]="TEXTURE13",t[t.TEXTURE14=33998]="TEXTURE14",t[t.TEXTURE15=33999]="TEXTURE15",t[t.TEXTURE16=34e3]="TEXTURE16",t[t.TEXTURE17=34001]="TEXTURE17",t[t.TEXTURE18=34002]="TEXTURE18",t[t.TEXTURE19=34003]="TEXTURE19",t[t.TEXTURE20=34004]="TEXTURE20",t[t.TEXTURE21=34005]="TEXTURE21",t[t.TEXTURE22=34006]="TEXTURE22",t[t.TEXTURE23=34007]="TEXTURE23",t[t.TEXTURE24=34008]="TEXTURE24",t[t.TEXTURE25=34009]="TEXTURE25",t[t.TEXTURE26=34010]="TEXTURE26",t[t.TEXTURE27=34011]="TEXTURE27",t[t.TEXTURE28=34012]="TEXTURE28",t[t.TEXTURE29=34013]="TEXTURE29",t[t.TEXTURE30=34014]="TEXTURE30",t[t.TEXTURE31=34015]="TEXTURE31",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.COPY_SRC=1]="COPY_SRC",t[t.COPY_DST=2]="COPY_DST",t[t.SAMPLED=4]="SAMPLED",t[t.STORAGE=8]="STORAGE",t[t.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"}(r||(r={}))},948:function(t,e,n){var r=n(1586),i=n(1587),o=n(1401),a=n(1588);t.exports=function(t,e){return r(t)||i(t,e)||o(t,e)||a()},t.exports.default=t.exports,t.exports.__esModule=!0},955:function(t,e,n){"use strict";var r=n(3),i=n(13),o=n(2),a=n(1),u=(n(10),n(14)),s=n(134),c=n(56),f=n(227),l=n(17),h=n(8),d=n(15),p=n(69),m=n(78);function v(t){return Object(p.a)("MuiFormControlLabel",t)}var g=Object(m.a)("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error"]),y=n(71),b=n(0),E=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","value"],_=Object(h.a)("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:function(t,e){var n=t.ownerState;return[Object(r.a)({},"& .".concat(g.label),e.label),e.root,e["labelPlacement".concat(Object(l.a)(n.labelPlacement))]]}})((function(t){var e=t.theme,n=t.ownerState;return Object(o.a)(Object(r.a)({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16},"&.".concat(g.disabled),{cursor:"default"}),"start"===n.labelPlacement&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},"top"===n.labelPlacement&&{flexDirection:"column-reverse",marginLeft:16},"bottom"===n.labelPlacement&&{flexDirection:"column",marginLeft:16},Object(r.a)({},"& .".concat(g.label),Object(r.a)({},"&.".concat(g.disabled),{color:e.palette.text.disabled})))})),w=a.forwardRef((function(t,e){var n=Object(d.a)({props:t,name:"MuiFormControlLabel"}),r=n.className,h=n.componentsProps,p=void 0===h?{}:h,m=n.control,g=n.disabled,w=n.disableTypography,x=n.label,T=n.labelPlacement,S=void 0===T?"end":T,A=Object(i.a)(n,E),O=Object(c.a)(),R=g;"undefined"===typeof R&&"undefined"!==typeof m.props.disabled&&(R=m.props.disabled),"undefined"===typeof R&&O&&(R=O.disabled);var C={disabled:R};["checked","name","onChange","value","inputRef"].forEach((function(t){"undefined"===typeof m.props[t]&&"undefined"!==typeof n[t]&&(C[t]=n[t])}));var M=Object(y.a)({props:n,muiFormControl:O,states:["error"]}),I=Object(o.a)({},n,{disabled:R,label:x,labelPlacement:S,error:M.error}),N=function(t){var e=t.classes,n=t.disabled,r=t.labelPlacement,i=t.error,o={root:["root",n&&"disabled","labelPlacement".concat(Object(l.a)(r)),i&&"error"],label:["label",n&&"disabled"]};return Object(s.a)(o,v,e)}(I);return Object(b.jsxs)(_,Object(o.a)({className:Object(u.default)(N.root,r),ownerState:I,ref:e},A,{children:[a.cloneElement(m,C),x.type===f.a||w?x:Object(b.jsx)(f.a,Object(o.a)({component:"span",className:N.label},p.typography,{children:x}))]}))}));e.a=w},959:function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}},961:function(t,e,n){var r=n(1537),i=n(823),o=n(1334),a=n(2001),u=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)r(e,o(t)),t=i(t);return e}:a;t.exports=u},985:function(t,e,n){"use strict";var r=n(79);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(80)),o=n(0),a=(0,i.default)((0,o.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save");e.default=a},986:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.circularDependencyToException=e.listMetadataForTarget=e.listRegisteredBindingsForServiceIdentifier=e.getServiceIdentifierAsString=e.getFunctionName=void 0;var r=n(652);function i(t){return"function"===typeof t?t.name:"symbol"===typeof t?t.toString():t}function o(t,e){return null!==t.parentRequest&&(t.parentRequest.serviceIdentifier===e||o(t.parentRequest,e))}function a(t){if(t.name)return t.name;var e=t.toString(),n=e.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+e}e.getServiceIdentifierAsString=i,e.listRegisteredBindingsForServiceIdentifier=function(t,e,n){var r="",i=n(t,e);return 0!==i.length&&(r="\nRegistered bindings:",i.forEach((function(t){var e="Object";null!==t.implementationType&&(e=a(t.implementationType)),r=r+"\n "+e,t.constraint.metaData&&(r=r+" - "+t.constraint.metaData)}))),r},e.circularDependencyToException=function t(e){e.childRequests.forEach((function(e){if(o(e,e.serviceIdentifier)){var n=function(t){return function t(e,n){void 0===n&&(n=[]);var r=i(e.serviceIdentifier);return n.push(r),null!==e.parentRequest?t(e.parentRequest,n):n}(t).reverse().join(" --\x3e ")}(e);throw new Error(r.CIRCULAR_DEPENDENCY+" "+n)}t(e)}))},e.listMetadataForTarget=function(t,e){if(e.isTagged()||e.isNamed()){var n="",r=e.getNamedTag(),i=e.getCustomTags();return null!==r&&(n+=r.toString()+"\n"),null!==i&&i.forEach((function(t){n+=t.toString()+"\n"}))," "+t+"\n "+t+" - "+n}return" "+t},e.getFunctionName=a},998:function(t,e,n){"use strict";n.d(e,"a",(function(){return Q}));n(1911);var r,i,o,a,u,s=n(530),c=n(2674),f=n.n(c),l=n(651),h=n(562),d=n.n(h),p=n(244),m=n.n(p),v=n(245),g=n.n(v),y=n(563),b=n.n(y),E=(n(564),n(653)),_=n(878),w=(r=Object(s.injectable)(),i=Object(s.inject)(E.a.RenderEngine),r((a=function(){function t(){m()(this,t),d()(this,"engine",u,this),this.resourcePool={}}return g()(t,[{key:"getOrCreateResource",value:function(t){if(!this.resourcePool[t.name]){var e=t.descriptor,n=e.width,r=e.height,i=e.usage;this.resourcePool[t.name]=this.engine.createFramebuffer({color:this.engine.createTexture2D({width:n,height:r,wrapS:_.a.CLAMP_TO_EDGE,wrapT:_.a.CLAMP_TO_EDGE,usage:i})})}return this.resourcePool[t.name]}},{key:"clean",value:function(){this.resourcePool={}}}]),t}(),u=b()(a.prototype,"engine",[i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=a))||o),x=n(1523),T=n(1532),S=n(1449),A=n(1450),O=n(1451),R=n(1452),C=n(1453),M=n(1454),I=n(1918),N=n(1300),k=n(1301),P=n(1457),j=n(1458),D=n(616),L=n.n(D),B=n(617),F=n.n(B),U=n(618),G=n.n(U);function V(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=G()(t);if(e){var i=G()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return F()(this,n)}}var z=function(t){L()(n,t);var e=V(n);function n(t){var r;return m()(this,n),(r=e.call(this,t)).name=void 0,r.name=t.name||"",r}return n}(l.a),H=n(1459),W=n(1460),q=n(1461),X=n(1462),Y=n(1529),K=new s.Container;f()(K,!1);function Q(){var t=new s.Container;return t.parent=K,t.bind(E.a.Systems).to(H.a).inSingletonScope().whenTargetNamed(E.a.SceneGraphSystem),t.bind(E.a.Systems).to(x.a).inSingletonScope().whenTargetNamed(E.a.FrameGraphSystem),t.bind(E.a.Systems).to(M.a).inSingletonScope().whenTargetNamed(E.a.MeshSystem),t.bind(E.a.Systems).to(S.a).inSingletonScope().whenTargetNamed(E.a.GeometrySystem),t.bind(E.a.Systems).to(O.a).inSingletonScope().whenTargetNamed(E.a.MaterialSystem),t.bind(E.a.Systems).to(P.a).inSingletonScope().whenTargetNamed(E.a.RendererSystem),t.bind(E.a.ResourcePool).to(w).inSingletonScope(),t.bind(E.a.ConfigService).to(q.a).inSingletonScope(),t.bind(E.a.InteractorService).to(X.a).inSingletonScope(),t.bind(E.a.RenderPass).to(k.a).inSingletonScope().whenTargetNamed(k.a.IDENTIFIER),t.bind(E.a.RenderPass).to(I.a).inSingletonScope().whenTargetNamed(I.a.IDENTIFIER),t.bind(E.a.RenderPass).to(N.a).inSingletonScope().whenTargetNamed(N.a.IDENTIFIER),t.bind(E.a.RenderPassFactory).toFactory((function(t){return function(e){return t.container.getNamed(E.a.RenderPass,e)}})),t}K.bind(E.a.ShaderModuleService).to(Y.a).inSingletonScope(),K.bind(E.a.NameComponentManager).toConstantValue(new l.b(z)),K.bind(E.a.HierarchyComponentManager).toConstantValue(new l.b(j.a)),K.bind(E.a.TransformComponentManager).toConstantValue(new l.b(W.a)),K.bind(E.a.MeshComponentManager).toConstantValue(new l.b(C.a)),K.bind(E.a.CullableComponentManager).toConstantValue(new l.b(R.a)),K.bind(E.a.GeometryComponentManager).toConstantValue(new l.b(T.a)),K.bind(E.a.MaterialComponentManager).toConstantValue(new l.b(A.a))}}]);